'use strict';const a52_0x494a2d=a52_0x251d;(function(_0x262c49,_0x18eeed){const _0x401cdc=a52_0x251d,_0x163787=_0x262c49();while(!![]){try{const _0x5574d1=-parseInt(_0x401cdc(0x1ae))/0x1+-parseInt(_0x401cdc(0x1c8))/0x2+parseInt(_0x401cdc(0x1ff))/0x3*(-parseInt(_0x401cdc(0x1dd))/0x4)+-parseInt(_0x401cdc(0x1b4))/0x5*(parseInt(_0x401cdc(0x191))/0x6)+-parseInt(_0x401cdc(0x193))/0x7*(-parseInt(_0x401cdc(0x1bc))/0x8)+parseInt(_0x401cdc(0x1d7))/0x9+parseInt(_0x401cdc(0x1ce))/0xa*(parseInt(_0x401cdc(0x192))/0xb);if(_0x5574d1===_0x18eeed)break;else _0x163787['push'](_0x163787['shift']());}catch(_0x2159bd){_0x163787['push'](_0x163787['shift']());}}}(a52_0x5451,0x3b3db));var __awaiter=this&&this[a52_0x494a2d(0x1ab)]||function(_0x2e0de1,_0x311ced,_0x5e789f,_0x3b9d77){function _0xd2d61(_0x256687){return _0x256687 instanceof _0x5e789f?_0x256687:new _0x5e789f(function(_0x59561c){_0x59561c(_0x256687);});}return new(_0x5e789f||(_0x5e789f=Promise))(function(_0xa480f1,_0x298ef0){const _0x3582b8=a52_0x251d;function _0x57f95f(_0x146169){const _0x789106=a52_0x251d;try{_0x27c0fa(_0x3b9d77[_0x789106(0x1ef)](_0x146169));}catch(_0xff37e5){_0x298ef0(_0xff37e5);}}function _0x58e9f7(_0x25b997){const _0x3c4b93=a52_0x251d;try{_0x27c0fa(_0x3b9d77[_0x3c4b93(0x1fe)](_0x25b997));}catch(_0x324741){_0x298ef0(_0x324741);}}function _0x27c0fa(_0x5338ce){const _0x393675=a52_0x251d;_0x5338ce[_0x393675(0x1c2)]?_0xa480f1(_0x5338ce[_0x393675(0x1f4)]):_0xd2d61(_0x5338ce[_0x393675(0x1f4)])[_0x393675(0x1a5)](_0x57f95f,_0x58e9f7);}_0x27c0fa((_0x3b9d77=_0x3b9d77[_0x3582b8(0x1e8)](_0x2e0de1,_0x311ced||[]))['next']());});},__asyncValues=this&&this[a52_0x494a2d(0x196)+'ues']||function(_0x25097f){const _0x5e0355=a52_0x494a2d;if(!Symbol[_0x5e0355(0x1b8)+_0x5e0355(0x1a4)])throw new TypeError('Symbol.asy'+'ncIterator'+'\x20is\x20not\x20de'+'fined.');var _0x4fadce=_0x25097f[Symbol['asyncItera'+_0x5e0355(0x1a4)]],_0x1f09e1;return _0x4fadce?_0x4fadce[_0x5e0355(0x1df)](_0x25097f):(_0x25097f=typeof __values===_0x5e0355(0x1d3)?__values(_0x25097f):_0x25097f[Symbol[_0x5e0355(0x1e2)]](),_0x1f09e1={},_0x3aa269(_0x5e0355(0x1ef)),_0x3aa269(_0x5e0355(0x1fe)),_0x3aa269('return'),_0x1f09e1[Symbol['asyncItera'+_0x5e0355(0x1a4)]]=function(){return this;},_0x1f09e1);function _0x3aa269(_0x1fadfc){_0x1f09e1[_0x1fadfc]=_0x25097f[_0x1fadfc]&&function(_0x3847a9){return new Promise(function(_0x2f02a8,_0x3c3313){const _0x53e73c=a52_0x251d;_0x3847a9=_0x25097f[_0x1fadfc](_0x3847a9),_0x45d48c(_0x2f02a8,_0x3c3313,_0x3847a9[_0x53e73c(0x1c2)],_0x3847a9['value']);});};}function _0x45d48c(_0x170415,_0x2f72e7,_0x5795cf,_0x30f59e){Promise['resolve'](_0x30f59e)['then'](function(_0x338a04){const _0x19a5e5=a52_0x251d,_0x396099={};_0x396099[_0x19a5e5(0x1f4)]=_0x338a04,_0x396099[_0x19a5e5(0x1c2)]=_0x5795cf,_0x170415(_0x396099);},_0x2f72e7);}};const a52_0x3c995a={};a52_0x3c995a[a52_0x494a2d(0x1f4)]=!![],Object['defineProp'+a52_0x494a2d(0x1e3)](exports,'__esModule',a52_0x3c995a),exports['WAMonitori'+a52_0x494a2d(0x1b9)]=void 0x0;const fs_1=require('fs'),whatsapp_service_1=require('./whatsapp'+a52_0x494a2d(0x1fc)),path_config_1=require('../../conf'+a52_0x494a2d(0x1e4)+'nfig'),path_1=require('path'),logger_config_1=require(a52_0x494a2d(0x198)+a52_0x494a2d(0x1c5)+a52_0x494a2d(0x1f6)),repository_manager_1=require(a52_0x494a2d(0x1be)+'ory/reposi'+'tory.manag'+'er'),exceptions_1=require('../../exce'+'ptions');function a52_0x5451(){const _0x1612ce=['erty','ig/path.co','client','collection','Broker','apply','not\x20loaded','instance','entries','NotFoundEx','get','hatsapp','next','connectToW','ting\x20insta','isDirector','eFiles','value','nce\x20from\x20m','config','ENABLED','removeInst','SAVE_DATA','emory.','\x22\x20-\x20REMOVE','.service','length','throw','933KeWwyU','tance','name','opendirSyn','forEach','6TDGwdQ','33hxLjBM','21469mBEWgz','DATABASE','dbInstance','__asyncVal','ice','../../conf','WAStartupS','WAMonitori','open','dbServer','readdirSyn','tureUrl','DB_PREFIX_','Status','instanceNa','rmSync','noConnecti','tor','then','connection','$or','ance','repository','logout','__awaiter','configServ','\x22\x20not\x20foun','245096tADRar','$regex','Error\x20dele','profilePic','encoding','logger','2269810ZEcIGh','Logger','utf-8','waInstance','asyncItera','ngService','match','force','776TWdPdW','instanceIn','../reposit','localError','tion','return','done','_id','Repository','ig/logger.','ion','CONNECTION','614840hIoUMK','INSTANCE_D','dropCollec','state','number','Instance\x20\x22','3619150RardaH','no.connect','NAME','delInstanc','once','function','-instances','join','warn','466767FevJkB','eventEmitt','getProfile','INSTANCE','namespace','recursive','2392stJlVG','error','call','wuid','connect','iterator'];a52_0x5451=function(){return _0x1612ce;};return a52_0x5451();}class WAMonitoringService{constructor(_0x2de7d4,_0x58382f,_0x2e73f2){const _0x294bc5=a52_0x494a2d;this[_0x294bc5(0x1d8)+'er']=_0x2de7d4,this[_0x294bc5(0x1ac)+_0x294bc5(0x197)]=_0x58382f,this[_0x294bc5(0x1a9)]=_0x2e73f2,this['db']=this[_0x294bc5(0x1ac)+_0x294bc5(0x197)][_0x294bc5(0x1ed)](_0x294bc5(0x194)),this['dbInstance']=this['db'][_0x294bc5(0x1f7)]?repository_manager_1[_0x294bc5(0x1c4)+_0x294bc5(0x1e7)][_0x294bc5(0x19c)]['db'](this['db'][_0x294bc5(0x1c7)][_0x294bc5(0x19f)+_0x294bc5(0x1d0)]+_0x294bc5(0x1d4)):null,this[_0x294bc5(0x1b3)]=new logger_config_1[(_0x294bc5(0x1b5))](WAMonitoringService[_0x294bc5(0x201)]),this[_0x294bc5(0x1b7)+'s']={},this[_0x294bc5(0x1f8)+'ance'](),this[_0x294bc5(0x1a3)+'on'](),this[_0x294bc5(0x1d1)+_0x294bc5(0x1f3)]();}['delInstanc'+'eTime'](_0x1d94b2){const _0x463f05=a52_0x494a2d,_0x5b5e64=this[_0x463f05(0x1ac)+_0x463f05(0x197)][_0x463f05(0x1ed)]('DEL_INSTAN'+'CE');typeof _0x5b5e64===_0x463f05(0x1cc)&&_0x5b5e64>0x0&&setTimeout(()=>{const _0x2408d1=_0x463f05;var _0x987177,_0x292a78;((_0x292a78=(_0x987177=this[_0x2408d1(0x1b7)+'s'][_0x1d94b2])===null||_0x987177===void 0x0?void 0x0:_0x987177['connection'+_0x2408d1(0x1a0)])===null||_0x292a78===void 0x0?void 0x0:_0x292a78['state'])!==_0x2408d1(0x19b)&&delete this[_0x2408d1(0x1b7)+'s'][_0x1d94b2];},0x3e8*0x3c*_0x5b5e64);}[a52_0x494a2d(0x1bd)+'fo'](_0x20e544){var _0x2d1a72,_0x44ba54,_0x3f7b1a,_0x3ebafa,_0x5ad81d;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4e0723=a52_0x251d;if(_0x20e544&&!this[_0x4e0723(0x1b7)+'s'][_0x20e544])throw new exceptions_1[(_0x4e0723(0x1ec))+'ception'](_0x4e0723(0x1cd)+_0x20e544+(_0x4e0723(0x1ad)+'d'));const _0x2f1d8b=[];try{for(var _0x410668=!![],_0x14f61c=__asyncValues(Object[_0x4e0723(0x1eb)](this['waInstance'+'s'])),_0x57903a;_0x57903a=yield _0x14f61c['next'](),_0x2d1a72=_0x57903a[_0x4e0723(0x1c2)],!_0x2d1a72;){_0x3ebafa=_0x57903a['value'],_0x410668=![];try{const [_0x503f89,_0x57d353]=_0x3ebafa;_0x57d353&&_0x57d353[_0x4e0723(0x1a6)+_0x4e0723(0x1a0)][_0x4e0723(0x1cb)]===_0x4e0723(0x19b)&&_0x2f1d8b['push']({'instance':{'instanceName':_0x503f89,'owner':_0x57d353[_0x4e0723(0x1e0)],'profileName':(yield _0x57d353[_0x4e0723(0x1d9)+'Name']())||_0x4e0723(0x1e9),'profilePictureUrl':_0x57d353[_0x4e0723(0x1b1)+_0x4e0723(0x19e)]}});}finally{_0x410668=!![];}}}catch(_0x201475){const _0x9ce55f={};_0x9ce55f[_0x4e0723(0x1de)]=_0x201475,_0x44ba54=_0x9ce55f;}finally{try{if(!_0x410668&&!_0x2d1a72&&(_0x3f7b1a=_0x14f61c[_0x4e0723(0x1c1)]))yield _0x3f7b1a[_0x4e0723(0x1df)](_0x14f61c);}finally{if(_0x44ba54)throw _0x44ba54['error'];}}return(_0x5ad81d=_0x2f1d8b['find'](_0x1f2ea1=>_0x1f2ea1[_0x4e0723(0x1ea)][_0x4e0723(0x1a1)+'me']===_0x20e544))!==null&&_0x5ad81d!==void 0x0?_0x5ad81d:_0x2f1d8b;});}['delInstanc'+a52_0x494a2d(0x1f3)](){setInterval(()=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xd0f76f=a52_0x251d;var _0x2cc1e5,_0x21d97a,_0x5422ea,_0x1a3fdf;if(this['db'][_0xd0f76f(0x1f7)]){const _0xdbc5ee=yield this[_0xd0f76f(0x195)][_0xd0f76f(0x1e6)+'s']();_0xdbc5ee['forEach'](_0x4bc807=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x3ef65b=_0xd0f76f,_0xe522b2=_0x4bc807[_0x3ef65b(0x1db)]['replace'](/^[\w-]+./,''),_0x438351={};_0x438351[_0x3ef65b(0x1af)]=/^app.state.*/;const _0x3830ac={};_0x3830ac[_0x3ef65b(0x1c3)]=_0x438351;const _0x4380e3={};_0x4380e3['$regex']=/^session-.*/;const _0x18ea15={};_0x18ea15['_id']=_0x4380e3;const _0x3025c1={};_0x3025c1[_0x3ef65b(0x1a7)]=[_0x3830ac,_0x18ea15],yield this[_0x3ef65b(0x195)][_0x3ef65b(0x1e6)](_0xe522b2)['deleteMany'](_0x3025c1);}));}else{const _0x28b9b2={};_0x28b9b2['encoding']='utf-8';const _0x3ce5b8=(0x0,fs_1[_0xd0f76f(0x202)+'c'])(path_config_1[_0xd0f76f(0x1c9)+'IR'],_0x28b9b2);try{for(var _0x57ae7c=!![],_0x23f552=__asyncValues(_0x3ce5b8),_0x17223b;_0x17223b=yield _0x23f552[_0xd0f76f(0x1ef)](),_0x2cc1e5=_0x17223b[_0xd0f76f(0x1c2)],!_0x2cc1e5;){_0x1a3fdf=_0x17223b[_0xd0f76f(0x1f4)],_0x57ae7c=![];try{const _0x4b2ac3=_0x1a3fdf;if(_0x4b2ac3[_0xd0f76f(0x1f2)+'y']()){const _0xa222cd={};_0xa222cd[_0xd0f76f(0x1b2)]=_0xd0f76f(0x1b6);const _0x3a1bb7=(0x0,fs_1[_0xd0f76f(0x19d)+'c'])((0x0,path_1[_0xd0f76f(0x1d5)])(path_config_1[_0xd0f76f(0x1c9)+'IR'],_0x4b2ac3[_0xd0f76f(0x201)]),_0xa222cd);_0x3a1bb7[_0xd0f76f(0x190)](_0x51dfef=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x6cc69e=_0xd0f76f;if(_0x51dfef[_0x6cc69e(0x1ba)](/^app.state.*/)||_0x51dfef[_0x6cc69e(0x1ba)](/^session-.*/)){const _0x39f5d1={};_0x39f5d1[_0x6cc69e(0x1dc)]=!![],_0x39f5d1[_0x6cc69e(0x1bb)]=!![],(0x0,fs_1[_0x6cc69e(0x1a2)])((0x0,path_1[_0x6cc69e(0x1d5)])(path_config_1[_0x6cc69e(0x1c9)+'IR'],_0x4b2ac3[_0x6cc69e(0x201)],_0x51dfef),_0x39f5d1);}}));}}finally{_0x57ae7c=!![];}}}catch(_0x471874){const _0x2d2c1a={};_0x2d2c1a[_0xd0f76f(0x1de)]=_0x471874,_0x21d97a=_0x2d2c1a;}finally{try{if(!_0x57ae7c&&!_0x2cc1e5&&(_0x5422ea=_0x23f552[_0xd0f76f(0x1c1)]))yield _0x5422ea[_0xd0f76f(0x1df)](_0x23f552);}finally{if(_0x21d97a)throw _0x21d97a[_0xd0f76f(0x1de)];}}}}),0xe10*0x3e8*0x2);}['loadInstan'+'ce'](){var _0x48acaf,_0x29aeec,_0x2b7d92,_0x471e7d;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x535998=a52_0x251d,_0x14f858=_0x4afaf8=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x52e0ec=a52_0x251d,_0x1324a5=new whatsapp_service_1[(_0x52e0ec(0x199))+'ervice'](this['configServ'+_0x52e0ec(0x197)],this['eventEmitt'+'er'],this[_0x52e0ec(0x1a9)]);_0x1324a5['instanceNa'+'me']=_0x4afaf8,yield _0x1324a5[_0x52e0ec(0x1f0)+_0x52e0ec(0x1ee)](),this[_0x52e0ec(0x1b7)+'s'][_0x4afaf8]=_0x1324a5;});try{if(this['db'][_0x535998(0x1f7)]&&this['db'][_0x535998(0x1f9)][_0x535998(0x1da)]){yield repository_manager_1['Repository'+'Broker'][_0x535998(0x19c)][_0x535998(0x1e1)]();const _0x5b9b05=yield this[_0x535998(0x195)]['collection'+'s']();_0x5b9b05['length']>0x0&&_0x5b9b05[_0x535998(0x190)](_0x566c42=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x478072=_0x535998;return yield _0x14f858(_0x566c42[_0x478072(0x1db)]['replace'](/^[\w-]+\./,''));}));return;}const _0x255545={};_0x255545[_0x535998(0x1b2)]=_0x535998(0x1b6);const _0x128099=(0x0,fs_1['opendirSyn'+'c'])(path_config_1[_0x535998(0x1c9)+'IR'],_0x255545);try{for(var _0x38ccda=!![],_0x44d21f=__asyncValues(_0x128099),_0x1f2449;_0x1f2449=yield _0x44d21f[_0x535998(0x1ef)](),_0x48acaf=_0x1f2449['done'],!_0x48acaf;){_0x471e7d=_0x1f2449[_0x535998(0x1f4)],_0x38ccda=![];try{const _0x2134be=_0x471e7d;if(_0x2134be['isDirector'+'y']()){const _0x329bab={};_0x329bab[_0x535998(0x1b2)]='utf-8';const _0x43116a=(0x0,fs_1[_0x535998(0x19d)+'c'])((0x0,path_1[_0x535998(0x1d5)])(path_config_1[_0x535998(0x1c9)+'IR'],_0x2134be[_0x535998(0x201)]),_0x329bab);if(_0x43116a[_0x535998(0x1fd)]===0x0){const _0x1c9232={};_0x1c9232[_0x535998(0x1dc)]=!![],_0x1c9232['force']=!![],(0x0,fs_1[_0x535998(0x1a2)])((0x0,path_1['join'])(path_config_1[_0x535998(0x1c9)+'IR'],_0x2134be[_0x535998(0x201)]),_0x1c9232);break;}yield _0x14f858(_0x2134be[_0x535998(0x201)]);}}finally{_0x38ccda=!![];}}}catch(_0x315c94){const _0x1965d1={};_0x1965d1[_0x535998(0x1de)]=_0x315c94,_0x29aeec=_0x1965d1;}finally{try{if(!_0x38ccda&&!_0x48acaf&&(_0x2b7d92=_0x44d21f[_0x535998(0x1c1)]))yield _0x2b7d92[_0x535998(0x1df)](_0x44d21f);}finally{if(_0x29aeec)throw _0x29aeec[_0x535998(0x1de)];}}}catch(_0xf27b6a){}});}['removeInst'+a52_0x494a2d(0x1a8)](){const _0x50cd13=a52_0x494a2d;this[_0x50cd13(0x1d8)+'er']['on']('remove.ins'+_0x50cd13(0x200),_0x31f8f5=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xf17c74=_0x50cd13;var _0x26dc5f,_0x18e5de;try{yield(_0x18e5de=(_0x26dc5f=this['waInstance'+'s'][_0x31f8f5])===null||_0x26dc5f===void 0x0?void 0x0:_0x26dc5f[_0xf17c74(0x1e5)])===null||_0x18e5de===void 0x0?void 0x0:_0x18e5de[_0xf17c74(0x1aa)]();}catch(_0x43c2cb){}try{delete this[_0xf17c74(0x1b7)+'s'][_0x31f8f5];}catch(_0x49c482){}try{if(this['db'][_0xf17c74(0x1f7)]&&this['db'][_0xf17c74(0x1f9)][_0xf17c74(0x1da)])return yield repository_manager_1['Repository'+_0xf17c74(0x1e7)][_0xf17c74(0x19c)][_0xf17c74(0x1e1)](),yield this[_0xf17c74(0x195)][_0xf17c74(0x1ca)+'tion'](_0x31f8f5);const _0x424a67={};_0x424a67['recursive']=!![],_0x424a67[_0xf17c74(0x1bb)]=!![],(0x0,fs_1[_0xf17c74(0x1a2)])((0x0,path_1['join'])(path_config_1[_0xf17c74(0x1c9)+'IR'],_0x31f8f5),_0x424a67);}finally{this[_0xf17c74(0x1b3)][_0xf17c74(0x1d6)](_0xf17c74(0x1cd)+_0x31f8f5+(_0xf17c74(0x1fb)+'D'));}}));}['noConnecti'+'on'](){const _0x48b075=a52_0x494a2d;this[_0x48b075(0x1d8)+'er'][_0x48b075(0x1d2)](_0x48b075(0x1cf)+_0x48b075(0x1c6),_0x2a4c4d=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x106b7e=_0x48b075;try{delete this['waInstance'+'s'][_0x2a4c4d];if(this['db'][_0x106b7e(0x1f7)]&&this['db']['SAVE_DATA']['INSTANCE'])return yield repository_manager_1[_0x106b7e(0x1c4)+_0x106b7e(0x1e7)][_0x106b7e(0x19c)][_0x106b7e(0x1e1)](),yield this[_0x106b7e(0x195)]['dropCollec'+_0x106b7e(0x1c0)](_0x2a4c4d);const _0x196f5c={};_0x196f5c[_0x106b7e(0x1dc)]=!![],_0x196f5c[_0x106b7e(0x1bb)]=!![],(0x0,fs_1[_0x106b7e(0x1a2)])((0x0,path_1[_0x106b7e(0x1d5)])(path_config_1['INSTANCE_D'+'IR'],_0x2a4c4d),_0x196f5c);}catch(_0x515d07){const _0x29267d={};_0x29267d[_0x106b7e(0x1bf)]='noConnecti'+'on',_0x29267d[_0x106b7e(0x1d6)]=_0x106b7e(0x1b0)+_0x106b7e(0x1f1)+_0x106b7e(0x1f5)+_0x106b7e(0x1fa),_0x29267d[_0x106b7e(0x1de)]=_0x515d07,this['logger'][_0x106b7e(0x1de)](_0x29267d);}finally{this[_0x106b7e(0x1b3)]['warn'](_0x106b7e(0x1cd)+_0x2a4c4d+(_0x106b7e(0x1fb)+'D'));}}));}}function a52_0x251d(_0xa0ca07,_0x548e86){const _0x545108=a52_0x5451();return a52_0x251d=function(_0x251d0f,_0x5b746a){_0x251d0f=_0x251d0f-0x190;let _0x395bc1=_0x545108[_0x251d0f];return _0x395bc1;},a52_0x251d(_0xa0ca07,_0x548e86);}exports[a52_0x494a2d(0x19a)+'ngService']=WAMonitoringService;