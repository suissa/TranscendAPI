'use strict';const a52_0x15bf01=a52_0x16f1;(function(_0x43e45e,_0x10f290){const _0x3e2dbb=a52_0x16f1,_0x27000f=_0x43e45e();while(!![]){try{const _0x2943ef=parseInt(_0x3e2dbb(0x17b))/0x1*(-parseInt(_0x3e2dbb(0x18b))/0x2)+-parseInt(_0x3e2dbb(0x1a8))/0x3*(-parseInt(_0x3e2dbb(0x1bd))/0x4)+-parseInt(_0x3e2dbb(0x189))/0x5*(parseInt(_0x3e2dbb(0x1dd))/0x6)+-parseInt(_0x3e2dbb(0x1a9))/0x7+-parseInt(_0x3e2dbb(0x1d2))/0x8+parseInt(_0x3e2dbb(0x182))/0x9+parseInt(_0x3e2dbb(0x1cd))/0xa;if(_0x2943ef===_0x10f290)break;else _0x27000f['push'](_0x27000f['shift']());}catch(_0xeda428){_0x27000f['push'](_0x27000f['shift']());}}}(a52_0x1426,0xab01e));var __awaiter=this&&this[a52_0x15bf01(0x188)]||function(_0x48a0b1,_0x358c2b,_0xde0440,_0xa281fc){function _0x40c231(_0x1187df){return _0x1187df instanceof _0xde0440?_0x1187df:new _0xde0440(function(_0x6516bf){_0x6516bf(_0x1187df);});}return new(_0xde0440||(_0xde0440=Promise))(function(_0x2d9540,_0x32d5dc){const _0x5b1ce7=a52_0x16f1;function _0x29f46b(_0x5717d8){const _0x5a5965=a52_0x16f1;try{_0x3bd359(_0xa281fc[_0x5a5965(0x185)](_0x5717d8));}catch(_0x4edb4b){_0x32d5dc(_0x4edb4b);}}function _0x35678c(_0x5c9e40){try{_0x3bd359(_0xa281fc['throw'](_0x5c9e40));}catch(_0x57b4cd){_0x32d5dc(_0x57b4cd);}}function _0x3bd359(_0x2afc4e){const _0x590f77=a52_0x16f1;_0x2afc4e[_0x590f77(0x184)]?_0x2d9540(_0x2afc4e[_0x590f77(0x1b6)]):_0x40c231(_0x2afc4e[_0x590f77(0x1b6)])[_0x590f77(0x18f)](_0x29f46b,_0x35678c);}_0x3bd359((_0xa281fc=_0xa281fc['apply'](_0x48a0b1,_0x358c2b||[]))[_0x5b1ce7(0x185)]());});},__asyncValues=this&&this['__asyncVal'+a52_0x15bf01(0x1cb)]||function(_0x3f5b70){const _0x222d3f=a52_0x15bf01;if(!Symbol[_0x222d3f(0x1c1)+_0x222d3f(0x1c8)])throw new TypeError(_0x222d3f(0x172)+_0x222d3f(0x1af)+_0x222d3f(0x1db)+_0x222d3f(0x1b3));var _0xe2d704=_0x3f5b70[Symbol['asyncItera'+_0x222d3f(0x1c8)]],_0x3a4dde;return _0xe2d704?_0xe2d704[_0x222d3f(0x1b1)](_0x3f5b70):(_0x3f5b70=typeof __values===_0x222d3f(0x18e)?__values(_0x3f5b70):_0x3f5b70[Symbol[_0x222d3f(0x1d8)]](),_0x3a4dde={},_0x3b35e6(_0x222d3f(0x185)),_0x3b35e6(_0x222d3f(0x1b8)),_0x3b35e6('return'),_0x3a4dde[Symbol[_0x222d3f(0x1c1)+'tor']]=function(){return this;},_0x3a4dde);function _0x3b35e6(_0x3b9a3c){_0x3a4dde[_0x3b9a3c]=_0x3f5b70[_0x3b9a3c]&&function(_0x2806ce){return new Promise(function(_0x1c6f64,_0x1f7ebb){const _0x5f1dea=a52_0x16f1;_0x2806ce=_0x3f5b70[_0x3b9a3c](_0x2806ce),_0x58415e(_0x1c6f64,_0x1f7ebb,_0x2806ce[_0x5f1dea(0x184)],_0x2806ce[_0x5f1dea(0x1b6)]);});};}function _0x58415e(_0x4955f7,_0x3104bc,_0x3592ba,_0xeeea49){const _0x17f117=_0x222d3f;Promise[_0x17f117(0x1a2)](_0xeeea49)[_0x17f117(0x18f)](function(_0x275aaf){const _0x4d9fc2=_0x17f117,_0x9cb0b9={};_0x9cb0b9[_0x4d9fc2(0x1b6)]=_0x275aaf,_0x9cb0b9[_0x4d9fc2(0x184)]=_0x3592ba,_0x4955f7(_0x9cb0b9);},_0x3104bc);}};const a52_0xe5ea6e={};a52_0xe5ea6e[a52_0x15bf01(0x1b6)]=!![],Object['defineProp'+a52_0x15bf01(0x1cc)](exports,a52_0x15bf01(0x17f),a52_0xe5ea6e),exports[a52_0x15bf01(0x1de)+'ngService']=void 0x0;function a52_0x16f1(_0x1b0e0a,_0x44426b){const _0x1426c2=a52_0x1426();return a52_0x16f1=function(_0x16f163,_0x18b67e){_0x16f163=_0x16f163-0x16a;let _0x4dbb46=_0x1426c2[_0x16f163];return _0x4dbb46;},a52_0x16f1(_0x1b0e0a,_0x44426b);}const fs_1=require('fs'),whatsapp_service_1=require('./whatsapp'+'.service'),path_config_1=require('../../conf'+a52_0x15bf01(0x19b)+a52_0x15bf01(0x1aa)),path_1=require('path'),logger_config_1=require('../../conf'+'ig/logger.'+a52_0x15bf01(0x1ac)),repository_manager_1=require('../reposit'+'ory/reposi'+a52_0x15bf01(0x192)+'er'),exceptions_1=require('../../exce'+a52_0x15bf01(0x1dc));class WAMonitoringService{constructor(_0x1dc3d0,_0x2ac1d4,_0xe5b966){const _0x1ca809=a52_0x15bf01;this[_0x1ca809(0x196)+'er']=_0x1dc3d0,this['configServ'+_0x1ca809(0x1bf)]=_0x2ac1d4,this['repository']=_0xe5b966,this['db']=this[_0x1ca809(0x1ae)+_0x1ca809(0x1bf)][_0x1ca809(0x186)](_0x1ca809(0x17d)),this[_0x1ca809(0x16e)]=this['db'][_0x1ca809(0x1d5)]?repository_manager_1[_0x1ca809(0x16c)+_0x1ca809(0x176)][_0x1ca809(0x180)]['db'](this['db'][_0x1ca809(0x1d0)]['DB_PREFIX_'+_0x1ca809(0x18a)]+_0x1ca809(0x173)):null,this['logger']=new logger_config_1[(_0x1ca809(0x1b9))](WAMonitoringService[_0x1ca809(0x19e)]),this[_0x1ca809(0x1c9)+'s']={},this['removeInst'+_0x1ca809(0x1d1)](),this['noConnecti'+'on'](),this['delInstanc'+_0x1ca809(0x1a3)]();}[a52_0x15bf01(0x17e)+a52_0x15bf01(0x198)](_0x3c2b30){const _0x1d5381=a52_0x15bf01,_0x3e8cc8=this[_0x1d5381(0x1ae)+_0x1d5381(0x1bf)][_0x1d5381(0x186)](_0x1d5381(0x19c)+'CE');typeof _0x3e8cc8===_0x1d5381(0x19d)&&_0x3e8cc8>0x0&&setTimeout(()=>{const _0x47b22d=_0x1d5381;var _0x57924e,_0x177abd;((_0x177abd=(_0x57924e=this['waInstance'+'s'][_0x3c2b30])===null||_0x57924e===void 0x0?void 0x0:_0x57924e[_0x47b22d(0x16f)+'Status'])===null||_0x177abd===void 0x0?void 0x0:_0x177abd[_0x47b22d(0x1a4)])!==_0x47b22d(0x193)&&delete this[_0x47b22d(0x1c9)+'s'][_0x3c2b30];},0x3e8*0x3c*_0x3e8cc8);}[a52_0x15bf01(0x199)+'fo'](_0x123d1a){var _0x11bc2a,_0x7d8eb0,_0x3a38a0,_0x23f2a9,_0x566e07;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x953131=a52_0x16f1;if(_0x123d1a&&!this[_0x953131(0x1c9)+'s'][_0x123d1a])throw new exceptions_1['NotFoundEx'+(_0x953131(0x1df))](_0x953131(0x16d)+_0x123d1a+(_0x953131(0x1d7)+'d'));const _0x4a7b80=[];try{for(var _0x3266da=!![],_0x110908=__asyncValues(Object[_0x953131(0x1a7)](this[_0x953131(0x1c9)+'s'])),_0x262c97;_0x262c97=yield _0x110908['next'](),_0x11bc2a=_0x262c97['done'],!_0x11bc2a;){_0x23f2a9=_0x262c97[_0x953131(0x1b6)],_0x3266da=![];try{const [_0x5a66ac,_0x2fef7]=_0x23f2a9;_0x2fef7&&_0x2fef7['connection'+_0x953131(0x1be)][_0x953131(0x1a4)]===_0x953131(0x193)&&_0x4a7b80[_0x953131(0x183)]({'instance':{'instanceName':_0x5a66ac,'owner':_0x2fef7[_0x953131(0x1bc)],'profileName':(yield _0x2fef7[_0x953131(0x1a0)+_0x953131(0x1d3)]())||_0x953131(0x175),'profilePictureUrl':_0x2fef7[_0x953131(0x1b5)+'tureUrl']}});}finally{_0x3266da=!![];}}}catch(_0x2ea8ee){const _0x1b5880={};_0x1b5880[_0x953131(0x181)]=_0x2ea8ee,_0x7d8eb0=_0x1b5880;}finally{try{if(!_0x3266da&&!_0x11bc2a&&(_0x3a38a0=_0x110908[_0x953131(0x16a)]))yield _0x3a38a0['call'](_0x110908);}finally{if(_0x7d8eb0)throw _0x7d8eb0[_0x953131(0x181)];}}return(_0x566e07=_0x4a7b80[_0x953131(0x1ab)](_0x56d1a5=>_0x56d1a5['instance']['instanceNa'+'me']===_0x123d1a))!==null&&_0x566e07!==void 0x0?_0x566e07:_0x4a7b80;});}[a52_0x15bf01(0x17e)+a52_0x15bf01(0x1a3)](){setInterval(()=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x4538e4=a52_0x16f1;var _0x2788e0,_0x2c3965,_0x1e0a08,_0x4761fb;if(this['db'][_0x4538e4(0x1d5)]&&this['db'][_0x4538e4(0x1ba)][_0x4538e4(0x1d4)]){const _0x4e3caa=yield this[_0x4538e4(0x16e)][_0x4538e4(0x19f)+'s']();_0x4e3caa[_0x4538e4(0x187)](_0x2d28d3=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x577ff6=_0x4538e4,_0x249514=_0x2d28d3[_0x577ff6(0x178)]['replace'](/^[\w-]+./,''),_0x3b30c7={};_0x3b30c7[_0x577ff6(0x1b4)]=/^app.state.*/;const _0x23cd77={};_0x23cd77[_0x577ff6(0x1bb)]=_0x3b30c7;const _0x3d7dcd={};_0x3d7dcd['$regex']=/^session-.*/;const _0x14d8fa={};_0x14d8fa['_id']=_0x3d7dcd;const _0x383737={};_0x383737['$or']=[_0x23cd77,_0x14d8fa],yield this[_0x577ff6(0x16e)]['collection'](_0x249514)[_0x577ff6(0x1d9)](_0x383737);}));}else{const _0x248e52={};_0x248e52[_0x4538e4(0x1c2)]='utf-8';const _0xf9047b=(0x0,fs_1['opendirSyn'+'c'])(path_config_1[_0x4538e4(0x171)+'IR'],_0x248e52);try{for(var _0x382985=!![],_0x57843e=__asyncValues(_0xf9047b),_0x50fc1f;_0x50fc1f=yield _0x57843e['next'](),_0x2788e0=_0x50fc1f[_0x4538e4(0x184)],!_0x2788e0;){_0x4761fb=_0x50fc1f[_0x4538e4(0x1b6)],_0x382985=![];try{const _0x30ca52=_0x4761fb;if(_0x30ca52[_0x4538e4(0x1c7)+'y']()){const _0x7a46c4={};_0x7a46c4[_0x4538e4(0x1c2)]=_0x4538e4(0x1d6);const _0x5920e2=(0x0,fs_1[_0x4538e4(0x17c)+'c'])((0x0,path_1[_0x4538e4(0x1a1)])(path_config_1['INSTANCE_D'+'IR'],_0x30ca52[_0x4538e4(0x19e)]),_0x7a46c4);_0x5920e2[_0x4538e4(0x187)](_0xaaa376=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xc088e3=_0x4538e4;if(_0xaaa376['match'](/^app.state.*/)||_0xaaa376[_0xc088e3(0x1c4)](/^session-.*/)){const _0x235154={};_0x235154[_0xc088e3(0x1ca)]=!![],_0x235154[_0xc088e3(0x174)]=!![],(0x0,fs_1[_0xc088e3(0x190)])((0x0,path_1[_0xc088e3(0x1a1)])(path_config_1['INSTANCE_D'+'IR'],_0x30ca52[_0xc088e3(0x19e)],_0xaaa376),_0x235154);}}));}}finally{_0x382985=!![];}}}catch(_0x2772c9){const _0x2a025e={};_0x2a025e[_0x4538e4(0x181)]=_0x2772c9,_0x2c3965=_0x2a025e;}finally{try{if(!_0x382985&&!_0x2788e0&&(_0x1e0a08=_0x57843e[_0x4538e4(0x16a)]))yield _0x1e0a08[_0x4538e4(0x1b1)](_0x57843e);}finally{if(_0x2c3965)throw _0x2c3965[_0x4538e4(0x181)];}}}}),0xe10*0x3e8*0x2);}[a52_0x15bf01(0x1c6)+'ce'](){var _0x4d9656,_0x300cbe,_0x1a8908,_0x995022;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x540083=a52_0x16f1,_0x58c2f3=_0x2b9b05=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x260416=a52_0x16f1,_0x54bddf=new whatsapp_service_1['WAStartupS'+'ervice'](this[_0x260416(0x1ae)+'ice'],this[_0x260416(0x196)+'er'],this[_0x260416(0x1ce)]);_0x54bddf[_0x260416(0x16b)+'me']=_0x2b9b05,yield _0x54bddf[_0x260416(0x18c)+_0x260416(0x1cf)](),this[_0x260416(0x1c9)+'s'][_0x2b9b05]=_0x54bddf;});try{if(this['db'][_0x540083(0x1d5)]&&this['db'][_0x540083(0x1ba)][_0x540083(0x1d4)]){yield repository_manager_1[_0x540083(0x16c)+_0x540083(0x176)]['dbServer'][_0x540083(0x1da)]();const _0x1f4358=yield this[_0x540083(0x16e)][_0x540083(0x19f)+'s']();_0x1f4358[_0x540083(0x177)]>0x0&&_0x1f4358[_0x540083(0x187)](_0x4dfbac=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x1cfb30=_0x540083;return yield _0x58c2f3(_0x4dfbac[_0x1cfb30(0x178)][_0x1cfb30(0x1c0)](/^[\w-]+\./,''));}));return;}const _0x5c6aeb={};_0x5c6aeb['encoding']='utf-8';const _0x2a810c=(0x0,fs_1[_0x540083(0x1b2)+'c'])(path_config_1['INSTANCE_D'+'IR'],_0x5c6aeb);try{for(var _0x15728e=!![],_0x426893=__asyncValues(_0x2a810c),_0x38046f;_0x38046f=yield _0x426893[_0x540083(0x185)](),_0x4d9656=_0x38046f['done'],!_0x4d9656;){_0x995022=_0x38046f[_0x540083(0x1b6)],_0x15728e=![];try{const _0x3aad56=_0x995022;if(_0x3aad56[_0x540083(0x1c7)+'y']()){const _0x5f416f={};_0x5f416f['encoding']=_0x540083(0x1d6);const _0x291057=(0x0,fs_1[_0x540083(0x17c)+'c'])((0x0,path_1[_0x540083(0x1a1)])(path_config_1[_0x540083(0x171)+'IR'],_0x3aad56[_0x540083(0x19e)]),_0x5f416f);if(_0x291057[_0x540083(0x177)]===0x0){const _0x492dca={};_0x492dca[_0x540083(0x1ca)]=!![],_0x492dca[_0x540083(0x174)]=!![],(0x0,fs_1[_0x540083(0x190)])((0x0,path_1[_0x540083(0x1a1)])(path_config_1[_0x540083(0x171)+'IR'],_0x3aad56[_0x540083(0x19e)]),_0x492dca);break;}yield _0x58c2f3(_0x3aad56[_0x540083(0x19e)]);}}finally{_0x15728e=!![];}}}catch(_0x4bcd93){const _0x5a380c={};_0x5a380c[_0x540083(0x181)]=_0x4bcd93,_0x300cbe=_0x5a380c;}finally{try{if(!_0x15728e&&!_0x4d9656&&(_0x1a8908=_0x426893[_0x540083(0x16a)]))yield _0x1a8908[_0x540083(0x1b1)](_0x426893);}finally{if(_0x300cbe)throw _0x300cbe[_0x540083(0x181)];}}}catch(_0x279cfd){}});}['removeInst'+a52_0x15bf01(0x1d1)](){const _0x46ae28=a52_0x15bf01;this['eventEmitt'+'er']['on']('remove.ins'+_0x46ae28(0x1c3),_0x54d1e7=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x10abc0=_0x46ae28;var _0x2d1318,_0x405e94;try{yield(_0x405e94=(_0x2d1318=this[_0x10abc0(0x1c9)+'s'][_0x54d1e7])===null||_0x2d1318===void 0x0?void 0x0:_0x2d1318[_0x10abc0(0x18d)])===null||_0x405e94===void 0x0?void 0x0:_0x405e94['logout']();}catch(_0x5c8a18){}try{delete this[_0x10abc0(0x1c9)+'s'][_0x54d1e7];}catch(_0x24a635){}try{if(this['db'][_0x10abc0(0x1d5)]&&this['db'][_0x10abc0(0x1ba)][_0x10abc0(0x1d4)])return yield repository_manager_1['Repository'+_0x10abc0(0x176)]['dbServer'][_0x10abc0(0x1da)](),yield this[_0x10abc0(0x16e)][_0x10abc0(0x170)+'tion'](_0x54d1e7);const _0xe95165={};_0xe95165['recursive']=!![],_0xe95165[_0x10abc0(0x174)]=!![],(0x0,fs_1[_0x10abc0(0x190)])((0x0,path_1[_0x10abc0(0x1a1)])(path_config_1[_0x10abc0(0x171)+'IR'],_0x54d1e7),_0xe95165);}finally{this[_0x10abc0(0x17a)][_0x10abc0(0x195)]('Instance\x20\x22'+_0x54d1e7+(_0x10abc0(0x197)+'D'));}}));}[a52_0x15bf01(0x1c5)+'on'](){const _0x31ab5f=a52_0x15bf01;this[_0x31ab5f(0x196)+'er'][_0x31ab5f(0x1ad)](_0x31ab5f(0x1b7)+_0x31ab5f(0x194),_0x19db4a=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x2acf7e=_0x31ab5f;try{delete this[_0x2acf7e(0x1c9)+'s'][_0x19db4a];if(this['db'][_0x2acf7e(0x1d5)]&&this['db'][_0x2acf7e(0x1ba)][_0x2acf7e(0x1d4)])return yield repository_manager_1['Repository'+'Broker'][_0x2acf7e(0x180)][_0x2acf7e(0x1da)](),yield this[_0x2acf7e(0x16e)][_0x2acf7e(0x170)+_0x2acf7e(0x1b0)](_0x19db4a);const _0xd821f6={};_0xd821f6[_0x2acf7e(0x1ca)]=!![],_0xd821f6[_0x2acf7e(0x174)]=!![],(0x0,fs_1['rmSync'])((0x0,path_1['join'])(path_config_1[_0x2acf7e(0x171)+'IR'],_0x19db4a),_0xd821f6);}catch(_0x6f129f){const _0x1135a9={};_0x1135a9[_0x2acf7e(0x19a)]=_0x2acf7e(0x1c5)+'on',_0x1135a9[_0x2acf7e(0x195)]='Error\x20dele'+_0x2acf7e(0x191)+_0x2acf7e(0x179)+_0x2acf7e(0x1a5),_0x1135a9[_0x2acf7e(0x181)]=_0x6f129f,this[_0x2acf7e(0x17a)][_0x2acf7e(0x181)](_0x1135a9);}finally{this[_0x2acf7e(0x17a)][_0x2acf7e(0x195)](_0x2acf7e(0x16d)+_0x19db4a+(_0x2acf7e(0x197)+'D'));}}));}}exports[a52_0x15bf01(0x1de)+a52_0x15bf01(0x1a6)]=WAMonitoringService;function a52_0x1426(){const _0x389085=['Broker','length','namespace','nce\x20from\x20m','logger','5740xjvHVQ','readdirSyn','DATABASE','delInstanc','__esModule','dbServer','error','7486866fPUscw','push','done','next','get','forEach','__awaiter','5ySOgkS','NAME','342wvyttm','connectToW','client','function','then','rmSync','ting\x20insta','tory.manag','open','ion','warn','eventEmitt','\x22\x20-\x20REMOVE','eTime','instanceIn','localError','ig/path.co','DEL_INSTAN','number','name','collection','getProfile','join','resolve','eFiles','state','emory.','ngService','entries','48amZWUS','6836347NaUdCx','nfig','find','config','once','configServ','ncIterator','tion','call','opendirSyn','fined.','$regex','profilePic','value','no.connect','throw','Logger','SAVE_DATA','_id','wuid','190148zGUnzC','Status','ice','replace','asyncItera','encoding','tance','match','noConnecti','loadInstan','isDirector','tor','waInstance','recursive','ues','erty','23789030zhNMly','repository','hatsapp','CONNECTION','ance','4972952tZkaEs','Name','INSTANCE','ENABLED','utf-8','\x22\x20not\x20foun','iterator','deleteMany','connect','\x20is\x20not\x20de','ptions','4146858GtmzfV','WAMonitori','ception','return','instanceNa','Repository','Instance\x20\x22','dbInstance','connection','dropCollec','INSTANCE_D','Symbol.asy','-instances','force','not\x20loaded'];a52_0x1426=function(){return _0x389085;};return a52_0x1426();}