'use strict';const a51_0x305f9f=a51_0x40ca;(function(_0x5c4eb1,_0x5cab49){const _0x17ec3a=a51_0x40ca,_0x3ca67d=_0x5c4eb1();while(!![]){try{const _0x22854c=parseInt(_0x17ec3a(0x1c1))/0x1+parseInt(_0x17ec3a(0x1d0))/0x2+-parseInt(_0x17ec3a(0x1e3))/0x3*(-parseInt(_0x17ec3a(0x1c9))/0x4)+-parseInt(_0x17ec3a(0x1a3))/0x5*(-parseInt(_0x17ec3a(0x1c5))/0x6)+parseInt(_0x17ec3a(0x1c0))/0x7*(-parseInt(_0x17ec3a(0x1df))/0x8)+-parseInt(_0x17ec3a(0x1c8))/0x9+-parseInt(_0x17ec3a(0x1d1))/0xa;if(_0x22854c===_0x5cab49)break;else _0x3ca67d['push'](_0x3ca67d['shift']());}catch(_0x3f0441){_0x3ca67d['push'](_0x3ca67d['shift']());}}}(a51_0x2a69,0x2b7a3));function a51_0x2a69(){const _0x233b3f=['Authentica','TION','ldToken\x22','instanceNa','new.jwt','SECRET','AuthServic','ig/logger.','repository','config','14XMUZAA','49959YHGtiI','KEN','erty','done','363336JqCUrG','throw','fault','162378gQOrWV','481444aeuSbA','find','tion\x20error','class-vali','jsonwebtok','url','webhook','689154ExaAfe','1125340bOYPkV','BadRequest','../../exce','instance','waMonitor','name','event','configServ','__esModule','ptions','../../conf','JWT','apikey','__importDe','1309400BRUSEO','g-t','tokenId','verify','3MXOxVt','sign','value','WEBHOOK','ration','data','defineProp','generateHa','dator','post','toUpperCas','waInstance','isJWT','logger','params','enabled','localError','AUTHENTICA','baseURL','10eHsOIE','toString','then','.jwt','ice','error','Exception','../../../p','Invalid\x20\x22o','ignoreExpi','utf8','__awaiter','get','next','auth','create','jwt','Logger','axios'];a51_0x2a69=function(){return _0x233b3f;};return a51_0x2a69();}var __awaiter=this&&this[a51_0x305f9f(0x1ae)]||function(_0xb3fe80,_0x3c4f04,_0x36a979,_0x3d0b70){function _0x3527c9(_0xf23725){return _0xf23725 instanceof _0x36a979?_0xf23725:new _0x36a979(function(_0x1244ca){_0x1244ca(_0xf23725);});}return new(_0x36a979||(_0x36a979=Promise))(function(_0x218332,_0x4d7f71){const _0x3fc3aa=a51_0x40ca;function _0x25c68c(_0x6799c8){const _0x6072e8=a51_0x40ca;try{_0x367098(_0x3d0b70[_0x6072e8(0x1b0)](_0x6799c8));}catch(_0x48c85e){_0x4d7f71(_0x48c85e);}}function _0x1315d2(_0x39d70){const _0x1789b5=a51_0x40ca;try{_0x367098(_0x3d0b70[_0x1789b5(0x1c6)](_0x39d70));}catch(_0xce3b2d){_0x4d7f71(_0xce3b2d);}}function _0x367098(_0x471dee){const _0x356ff4=a51_0x40ca;_0x471dee[_0x356ff4(0x1c4)]?_0x218332(_0x471dee[_0x356ff4(0x1e5)]):_0x3527c9(_0x471dee[_0x356ff4(0x1e5)])[_0x356ff4(0x1a5)](_0x25c68c,_0x1315d2);}_0x367098((_0x3d0b70=_0x3d0b70['apply'](_0xb3fe80,_0x3c4f04||[]))[_0x3fc3aa(0x1b0)]());});},__importDefault=this&&this[a51_0x305f9f(0x1de)+a51_0x305f9f(0x1c7)]||function(_0x44cab8){const _0x4b5d05=a51_0x305f9f;return _0x44cab8&&_0x44cab8[_0x4b5d05(0x1d9)]?_0x44cab8:{'default':_0x44cab8};};const a51_0xef939={};a51_0xef939['value']=!![],Object[a51_0x305f9f(0x1e9)+a51_0x305f9f(0x1c3)](exports,a51_0x305f9f(0x1d9),a51_0xef939),exports[a51_0x305f9f(0x1bc)+'e']=exports['OldToken']=void 0x0;const package_json_1=require(a51_0x305f9f(0x1aa)+'ackage.jso'+'n'),jsonwebtoken_1=require(a51_0x305f9f(0x1cd)+'en'),logger_config_1=require(a51_0x305f9f(0x1db)+a51_0x305f9f(0x1bd)+a51_0x305f9f(0x1bf)),uuid_1=require('uuid'),class_validator_1=require(a51_0x305f9f(0x1cc)+a51_0x305f9f(0x1eb)),exceptions_1=require(a51_0x305f9f(0x1d3)+a51_0x305f9f(0x1da)),axios_1=__importDefault(require(a51_0x305f9f(0x1b5)));function a51_0x40ca(_0xd5847e,_0x3eb118){const _0x2a6915=a51_0x2a69();return a51_0x40ca=function(_0x40ca82,_0x2211c2){_0x40ca82=_0x40ca82-0x19a;let _0x4c143e=_0x2a6915[_0x40ca82];return _0x4c143e;},a51_0x40ca(_0xd5847e,_0x3eb118);}class OldToken{}exports['OldToken']=OldToken;class AuthService{constructor(_0x11a275,_0x3b241f,_0x461bfc){const _0x453b83=a51_0x305f9f;this[_0x453b83(0x1d8)+_0x453b83(0x1a7)]=_0x11a275,this[_0x453b83(0x1d5)]=_0x3b241f,this[_0x453b83(0x1be)]=_0x461bfc,this[_0x453b83(0x19d)]=new logger_config_1[(_0x453b83(0x1b4))](AuthService[_0x453b83(0x1d6)]);}['jwt'](_0x396ed7){var _0x47ffaa;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x279530=a51_0x40ca,_0x1ab05d=this[_0x279530(0x1d8)+_0x279530(0x1a7)][_0x279530(0x1af)](_0x279530(0x1a1)+_0x279530(0x1b7))[_0x279530(0x1dc)],_0x279b34=(0x0,jsonwebtoken_1[_0x279530(0x1e4)])({'instanceName':_0x396ed7[_0x279530(0x1b9)+'me'],'apiName':package_json_1[_0x279530(0x1d6)],'tokenId':(0x0,uuid_1['v4'])()},_0x1ab05d[_0x279530(0x1bb)],{'expiresIn':_0x1ab05d['EXPIRIN_IN'],'encoding':_0x279530(0x1ad),'subject':_0x279530(0x1e0)}),_0x4a313a={};_0x4a313a['jwt']=_0x279b34;const _0x50a453=yield this[_0x279530(0x1be)][_0x279530(0x1b1)]['create'](_0x4a313a,_0x396ed7[_0x279530(0x1b9)+'me']);if(_0x50a453[_0x279530(0x1a8)]){const _0x3765f0={};_0x3765f0[_0x279530(0x1a0)]=AuthService[_0x279530(0x1d6)]+_0x279530(0x1a6),_0x3765f0[_0x279530(0x1a8)]=_0x50a453['error'],this[_0x279530(0x19d)][_0x279530(0x1a8)](_0x3765f0);throw new exceptions_1[(_0x279530(0x1d2))+'Exception'](_0x279530(0x1b6)+_0x279530(0x1cb),(_0x47ffaa=_0x50a453[_0x279530(0x1a8)])===null||_0x47ffaa===void 0x0?void 0x0:_0x47ffaa[_0x279530(0x1a4)]());}const _0x386cbc={};return _0x386cbc[_0x279530(0x1b3)]=_0x279b34,_0x386cbc;});}[a51_0x305f9f(0x1dd)](_0x5003a9){var _0x5b3024;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1df7ab=a51_0x40ca,_0x3d78e9=(0x0,uuid_1['v4'])()[_0x1df7ab(0x19a)+'e'](),_0x35b0e9={};_0x35b0e9['apikey']=_0x3d78e9;const _0x4ef78a=yield this[_0x1df7ab(0x1be)]['auth'][_0x1df7ab(0x1b2)](_0x35b0e9,_0x5003a9[_0x1df7ab(0x1b9)+'me']);if(_0x4ef78a['error']){const _0x255eca={};_0x255eca[_0x1df7ab(0x1a0)]=AuthService['name']+'.jwt',_0x255eca[_0x1df7ab(0x1a8)]=_0x4ef78a[_0x1df7ab(0x1a8)],this[_0x1df7ab(0x19d)]['error'](_0x255eca);throw new exceptions_1['BadRequest'+(_0x1df7ab(0x1a9))]('Authentica'+_0x1df7ab(0x1cb),(_0x5b3024=_0x4ef78a[_0x1df7ab(0x1a8)])===null||_0x5b3024===void 0x0?void 0x0:_0x5b3024[_0x1df7ab(0x1a4)]());}const _0x45bdbb={};return _0x45bdbb[_0x1df7ab(0x1dd)]=_0x3d78e9,_0x45bdbb;});}[a51_0x305f9f(0x1ea)+'sh'](_0x511397){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x40bbf0=a51_0x40ca,_0x369af5=this[_0x40bbf0(0x1d8)+_0x40bbf0(0x1a7)][_0x40bbf0(0x1af)](_0x40bbf0(0x1a1)+_0x40bbf0(0x1b7));return yield this[_0x369af5['TYPE']](_0x511397);});}['refreshTok'+'en']({oldToken:_0x9ebc7e}){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3f8170=a51_0x40ca;if(!(0x0,class_validator_1[_0x3f8170(0x19c)])(_0x9ebc7e))throw new exceptions_1[(_0x3f8170(0x1d2))+'Exception'](_0x3f8170(0x1ab)+_0x3f8170(0x1b8));try{const _0x1aec9d=this[_0x3f8170(0x1d8)+_0x3f8170(0x1a7)][_0x3f8170(0x1af)](_0x3f8170(0x1a1)+'TION')[_0x3f8170(0x1dc)],_0x439d92={};_0x439d92[_0x3f8170(0x1ac)+_0x3f8170(0x1e7)]=!![];const _0x280ffd=(0x0,jsonwebtoken_1['verify'])(_0x9ebc7e,_0x1aec9d['SECRET'],_0x439d92),_0x55e60b=yield this[_0x3f8170(0x1be)][_0x3f8170(0x1b1)][_0x3f8170(0x1ca)](_0x280ffd[_0x3f8170(0x1b9)+'me']),_0x2be9c0={};_0x2be9c0[_0x3f8170(0x1ac)+_0x3f8170(0x1e7)]=!![];const _0x1a5d68=(0x0,jsonwebtoken_1[_0x3f8170(0x1e2)])(_0x55e60b[_0x3f8170(0x1b3)],_0x1aec9d['SECRET'],_0x2be9c0);if(_0x280ffd[_0x3f8170(0x1e1)]!==_0x1a5d68['tokenId'])throw new exceptions_1[(_0x3f8170(0x1d2))+(_0x3f8170(0x1a9))](_0x3f8170(0x1ab)+'ldToken\x22');const _0x2b2457={};_0x2b2457['instanceNa'+'me']=_0x280ffd[_0x3f8170(0x1b9)+'me'];const _0x173787={'jwt':(yield this[_0x3f8170(0x1b3)](_0x2b2457))[_0x3f8170(0x1b3)],'instanceName':_0x280ffd[_0x3f8170(0x1b9)+'me']};try{const _0x4d9cce=yield this['repository'][_0x3f8170(0x1cf)][_0x3f8170(0x1ca)](_0x280ffd[_0x3f8170(0x1b9)+'me']);if(_0x4d9cce[_0x3f8170(0x19f)]&&this[_0x3f8170(0x1d8)+_0x3f8170(0x1a7)][_0x3f8170(0x1af)](_0x3f8170(0x1e6))['EVENTS']['NEW_JWT_TO'+_0x3f8170(0x1c2)]){const _0x78788b={};_0x78788b[_0x3f8170(0x1a2)]=_0x4d9cce[_0x3f8170(0x1ce)];const _0x3f275f=axios_1['default'][_0x3f8170(0x1b2)](_0x78788b),_0x230e28={};_0x230e28[_0x3f8170(0x1d7)]=_0x3f8170(0x1ba),_0x230e28[_0x3f8170(0x1d4)]=_0x280ffd[_0x3f8170(0x1b9)+'me'],_0x230e28[_0x3f8170(0x1e8)]=_0x173787;const _0x445d62={};_0x445d62['ownre']=this[_0x3f8170(0x1d5)][_0x3f8170(0x19b)+'s'][_0x280ffd[_0x3f8170(0x1b9)+'me']]['wuid'];const _0x5e7b0a={};_0x5e7b0a[_0x3f8170(0x19e)]=_0x445d62,yield _0x3f275f[_0x3f8170(0x1ec)]('',_0x230e28,_0x5e7b0a);}}catch(_0xe5a0b4){this[_0x3f8170(0x19d)][_0x3f8170(0x1a8)](_0xe5a0b4);}return _0x173787;}catch(_0x5a7a72){const _0x22add0={};_0x22add0[_0x3f8170(0x1a0)]=AuthService[_0x3f8170(0x1d6)]+('.refreshTo'+'ken'),_0x22add0[_0x3f8170(0x1a8)]=_0x5a7a72,this[_0x3f8170(0x19d)][_0x3f8170(0x1a8)](_0x22add0);throw new exceptions_1['BadRequest'+(_0x3f8170(0x1a9))](_0x3f8170(0x1ab)+'ldToken\x22');}});}}exports['AuthServic'+'e']=AuthService;