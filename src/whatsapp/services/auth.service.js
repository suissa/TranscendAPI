'use strict';const a51_0x2a36b3=a51_0x122b;(function(_0x2af878,_0x27d1a3){const _0x26eeb4=a51_0x122b,_0xc24ce6=_0x2af878();while(!![]){try{const _0x120e50=-parseInt(_0x26eeb4(0x201))/(-0x1321+0xef5+0x42d*0x1)*(parseInt(_0x26eeb4(0x231))/(0xe*-0x7+0x1eaa+-0x1e46))+parseInt(_0x26eeb4(0x221))/(-0x8d3*-0x1+0xc*-0x33+-0x66c)*(parseInt(_0x26eeb4(0x1ec))/(-0x93+0x1*0x671+-0x5da*0x1))+-parseInt(_0x26eeb4(0x233))/(0x69*-0x5f+0x1a81+0x9*0x163)*(-parseInt(_0x26eeb4(0x220))/(0xdf6+-0x1f3*0x11+0x1333))+parseInt(_0x26eeb4(0x1ff))/(-0x20d6+0x1*-0xd44+-0x2e21*-0x1)+-parseInt(_0x26eeb4(0x20d))/(0x1c1*-0x3+-0x110e+0x1659)*(parseInt(_0x26eeb4(0x236))/(-0x2f5+-0x5b5+0x8b3))+-parseInt(_0x26eeb4(0x1fe))/(-0xf2*-0x8+0x1*0x1b25+-0x22ab)+parseInt(_0x26eeb4(0x1f0))/(-0x17a6*0x1+0x21c5+-0xa14);if(_0x120e50===_0x27d1a3)break;else _0xc24ce6['push'](_0xc24ce6['shift']());}catch(_0x4c7876){_0xc24ce6['push'](_0xc24ce6['shift']());}}}(a51_0x40f8,0x11*-0xe35+-0x9e6b9*-0x1+-0x3d55*0xd));var __awaiter=this&&this['__awaiter']||function(_0x44484c,_0x447b78,_0x2ea11c,_0x5be473){function _0x37a838(_0x41e3d5){return _0x41e3d5 instanceof _0x2ea11c?_0x41e3d5:new _0x2ea11c(function(_0x4c37a8){_0x4c37a8(_0x41e3d5);});}return new(_0x2ea11c||(_0x2ea11c=Promise))(function(_0x11f70f,_0x3287d1){const _0x4dbda8=a51_0x122b;function _0xca5f70(_0x550d82){const _0x1fe191=a51_0x122b;try{_0x3565f8(_0x5be473[_0x1fe191(0x230)](_0x550d82));}catch(_0x30cdf5){_0x3287d1(_0x30cdf5);}}function _0x59ea95(_0x7251d6){const _0x45afaf=a51_0x122b;try{_0x3565f8(_0x5be473[_0x45afaf(0x214)](_0x7251d6));}catch(_0x2dc9db){_0x3287d1(_0x2dc9db);}}function _0x3565f8(_0x3ab5b2){const _0x4fe063=a51_0x122b;_0x3ab5b2[_0x4fe063(0x1f3)]?_0x11f70f(_0x3ab5b2[_0x4fe063(0x225)]):_0x37a838(_0x3ab5b2[_0x4fe063(0x225)])[_0x4fe063(0x205)](_0xca5f70,_0x59ea95);}_0x3565f8((_0x5be473=_0x5be473[_0x4dbda8(0x23b)](_0x44484c,_0x447b78||[]))[_0x4dbda8(0x230)]());});},__importDefault=this&&this[a51_0x2a36b3(0x1ed)+a51_0x2a36b3(0x1fd)]||function(_0xd7885f){const _0x35f9b1=a51_0x2a36b3;return _0xd7885f&&_0xd7885f[_0x35f9b1(0x21d)]?_0xd7885f:{'default':_0xd7885f};};const a51_0x78fa36={};a51_0x78fa36[a51_0x2a36b3(0x225)]=!![],Object[a51_0x2a36b3(0x1eb)+'erty'](exports,a51_0x2a36b3(0x21d),a51_0x78fa36),exports[a51_0x2a36b3(0x208)+'e']=exports[a51_0x2a36b3(0x237)]=void(0x219b+-0x10*0x24e+-0x117*-0x3);function a51_0x40f8(){const _0x5ce291=['AuthServic','Exception','tokenId','ig/logger.','tion\x20error','2789240oDeqKB','JWT','Invalid\x20\x22o','.jwt','toUpperCas','config','verify','throw','BadRequest','WEBHOOK','apikey','repository','sign','ldToken\x22','auth','ackage.jso','__esModule','SECRET','instance','17898cfqabv','5472XwtBme','Authentica','NEW_JWT_TO','data','value','error','ignoreExpi','Logger','class-vali','waMonitor','../../exce','baseURL','jsonwebtok','TION','instanceNa','next','99254XTeGyM','find','10llvArr','isJWT','ownre','9sxYlkn','OldToken','post','ration','enabled','apply','logger','new.jwt','waInstance','toString','AUTHENTICA','EVENTS','webhook','TYPE','defineProp','12KmWIey','__importDe','params','g-t','17601155cQDUQe','dator','utf8','done','generateHa','get','name','url','create','axios','ptions','KEN','default','fault','5749930gmQodE','1686643xLUEtg','EXPIRIN_IN','11zXFUYk','localError','uuid','ice','then','configServ','jwt'];a51_0x40f8=function(){return _0x5ce291;};return a51_0x40f8();}function a51_0x122b(_0x38c283,_0x5cee67){const _0xde349c=a51_0x40f8();return a51_0x122b=function(_0x78fa36,_0x58b42a){_0x78fa36=_0x78fa36-(-0x115*-0x16+-0x1828+-0x241*-0x1);let _0x2aef52=_0xde349c[_0x78fa36];return _0x2aef52;},a51_0x122b(_0x38c283,_0x5cee67);}const package_json_1=require('../../../p'+a51_0x2a36b3(0x21c)+'n'),jsonwebtoken_1=require(a51_0x2a36b3(0x22d)+'en'),logger_config_1=require('../../conf'+a51_0x2a36b3(0x20b)+a51_0x2a36b3(0x212)),uuid_1=require(a51_0x2a36b3(0x203)),class_validator_1=require(a51_0x2a36b3(0x229)+a51_0x2a36b3(0x1f1)),exceptions_1=require(a51_0x2a36b3(0x22b)+a51_0x2a36b3(0x1fa)),axios_1=__importDefault(require(a51_0x2a36b3(0x1f9)));class OldToken{}exports[a51_0x2a36b3(0x237)]=OldToken;class AuthService{constructor(_0x4fd25e,_0x432c67,_0xbc9b11){const _0x512799=a51_0x2a36b3;this[_0x512799(0x206)+'ice']=_0x4fd25e,this[_0x512799(0x22a)]=_0x432c67,this['repository']=_0xbc9b11,this[_0x512799(0x23c)]=new logger_config_1[(_0x512799(0x228))](AuthService[_0x512799(0x1f6)]);}[a51_0x2a36b3(0x207)](_0x5d20f7){var _0x3ab082;return __awaiter(this,void(-0x6*-0x282+0x1*0x1783+-0x268f),void(-0xa7*-0x4+0x1dcf*0x1+-0x206b),function*(){const _0x3fc36b=a51_0x122b,_0x3179bc=this[_0x3fc36b(0x206)+'ice'][_0x3fc36b(0x1f5)]('AUTHENTICA'+'TION')['JWT'],_0x474e29=(0x2710+-0xe5*-0x25+0xcb*-0x5b,jsonwebtoken_1[_0x3fc36b(0x219)])({'instanceName':_0x5d20f7['instanceNa'+'me'],'apiName':package_json_1['name'],'tokenId':(-0x249f+-0x15f*-0x1b+-0x66,uuid_1['v4'])()},_0x3179bc[_0x3fc36b(0x21e)],{'expiresIn':_0x3179bc[_0x3fc36b(0x200)],'encoding':_0x3fc36b(0x1f2),'subject':_0x3fc36b(0x1ef)}),_0x59a8b3={};_0x59a8b3['jwt']=_0x474e29;const _0x111277=yield this['repository'][_0x3fc36b(0x21b)][_0x3fc36b(0x1f8)](_0x59a8b3,_0x5d20f7[_0x3fc36b(0x22f)+'me']);if(_0x111277[_0x3fc36b(0x226)]){const _0x104c8b={};_0x104c8b[_0x3fc36b(0x202)]=AuthService[_0x3fc36b(0x1f6)]+_0x3fc36b(0x210),_0x104c8b[_0x3fc36b(0x226)]=_0x111277[_0x3fc36b(0x226)],this[_0x3fc36b(0x23c)][_0x3fc36b(0x226)](_0x104c8b);throw new exceptions_1[(_0x3fc36b(0x215))+'Exception'](_0x3fc36b(0x222)+_0x3fc36b(0x20c),(_0x3ab082=_0x111277[_0x3fc36b(0x226)])===null||_0x3ab082===void(0x161*0x9+0x1*0x1afc+0x5*-0x7e1)?void(0x2*0x1340+-0x10ad+0x1*-0x15d3):_0x3ab082[_0x3fc36b(0x23f)]());}const _0x3b7ec7={};return _0x3b7ec7[_0x3fc36b(0x207)]=_0x474e29,_0x3b7ec7;});}[a51_0x2a36b3(0x217)](_0x55f377){var _0x294c1c;return __awaiter(this,void(-0xab1*0x2+-0x1*0xd84+0x22e6),void(-0x12*0x1a6+-0x24f8+0x1*0x42a4),function*(){const _0x59697b=a51_0x122b,_0x2a37c4=(-0x5*0x2a5+0x163b+-0x902,uuid_1['v4'])()[_0x59697b(0x211)+'e'](),_0x1596c8={};_0x1596c8['apikey']=_0x2a37c4;const _0x26983b=yield this['repository'][_0x59697b(0x21b)][_0x59697b(0x1f8)](_0x1596c8,_0x55f377[_0x59697b(0x22f)+'me']);if(_0x26983b[_0x59697b(0x226)]){const _0x49efd0={};_0x49efd0[_0x59697b(0x202)]=AuthService['name']+_0x59697b(0x210),_0x49efd0[_0x59697b(0x226)]=_0x26983b[_0x59697b(0x226)],this['logger'][_0x59697b(0x226)](_0x49efd0);throw new exceptions_1[(_0x59697b(0x215))+(_0x59697b(0x209))](_0x59697b(0x222)+_0x59697b(0x20c),(_0x294c1c=_0x26983b['error'])===null||_0x294c1c===void(-0x12fd*-0x2+0x188b+-0x3e85)?void(0x2*0xa33+0x1*-0x3b3+0x5*-0x357):_0x294c1c['toString']());}const _0x56c468={};return _0x56c468[_0x59697b(0x217)]=_0x2a37c4,_0x56c468;});}[a51_0x2a36b3(0x1f4)+'sh'](_0xc8f11f){return __awaiter(this,void(-0x23c1+-0x2701*-0x1+-0x1a0*0x2),void(-0x2*-0x12a1+0x491+-0x29d3),function*(){const _0x260a12=a51_0x122b,_0x39b167=this[_0x260a12(0x206)+_0x260a12(0x204)][_0x260a12(0x1f5)](_0x260a12(0x1e7)+'TION');return yield this[_0x39b167[_0x260a12(0x1ea)]](_0xc8f11f);});}['refreshTok'+'en']({oldToken:_0x2066ad}){return __awaiter(this,void(0x1952*-0x1+-0xd46+0xf7*0x28),void(-0xe34*0x1+-0x8b5*0x3+0x2853),function*(){const _0x893c1a=a51_0x122b;if(!(0x14f*-0xb+-0x642*0x6+0x33f1,class_validator_1[_0x893c1a(0x234)])(_0x2066ad))throw new exceptions_1['BadRequest'+(_0x893c1a(0x209))](_0x893c1a(0x20f)+_0x893c1a(0x21a));try{const _0x5cd1e0=this[_0x893c1a(0x206)+_0x893c1a(0x204)][_0x893c1a(0x1f5)](_0x893c1a(0x1e7)+_0x893c1a(0x22e))[_0x893c1a(0x20e)],_0x8cf0b0={};_0x8cf0b0['ignoreExpi'+_0x893c1a(0x239)]=!![];const _0x4ce5b9=(-0x2b*0x69+-0x4*0x5bf+0x289f,jsonwebtoken_1[_0x893c1a(0x213)])(_0x2066ad,_0x5cd1e0[_0x893c1a(0x21e)],_0x8cf0b0),_0x2999d1=yield this[_0x893c1a(0x218)][_0x893c1a(0x21b)][_0x893c1a(0x232)](_0x4ce5b9[_0x893c1a(0x22f)+'me']),_0x3190b1={};_0x3190b1[_0x893c1a(0x227)+'ration']=!![];const _0x37409d=(-0x1*0x196a+-0x21*-0xe3+-0x5*0xc5,jsonwebtoken_1[_0x893c1a(0x213)])(_0x2999d1[_0x893c1a(0x207)],_0x5cd1e0['SECRET'],_0x3190b1);if(_0x4ce5b9[_0x893c1a(0x20a)]!==_0x37409d['tokenId'])throw new exceptions_1[(_0x893c1a(0x215))+(_0x893c1a(0x209))](_0x893c1a(0x20f)+'ldToken\x22');const _0x56b090={};_0x56b090[_0x893c1a(0x22f)+'me']=_0x4ce5b9[_0x893c1a(0x22f)+'me'];const _0x3ccb2b={'jwt':(yield this[_0x893c1a(0x207)](_0x56b090))[_0x893c1a(0x207)],'instanceName':_0x4ce5b9[_0x893c1a(0x22f)+'me']};try{const _0x535ea9=yield this[_0x893c1a(0x218)][_0x893c1a(0x1e9)][_0x893c1a(0x232)](_0x4ce5b9[_0x893c1a(0x22f)+'me']);if(_0x535ea9[_0x893c1a(0x23a)]&&this[_0x893c1a(0x206)+'ice'][_0x893c1a(0x1f5)](_0x893c1a(0x216))[_0x893c1a(0x1e8)][_0x893c1a(0x223)+_0x893c1a(0x1fb)]){const _0x9badc7={};_0x9badc7[_0x893c1a(0x22c)]=_0x535ea9[_0x893c1a(0x1f7)];const _0x5cfd77=axios_1[_0x893c1a(0x1fc)][_0x893c1a(0x1f8)](_0x9badc7),_0x12aae2={};_0x12aae2['event']=_0x893c1a(0x23d),_0x12aae2[_0x893c1a(0x21f)]=_0x4ce5b9[_0x893c1a(0x22f)+'me'],_0x12aae2[_0x893c1a(0x224)]=_0x3ccb2b;const _0x1532dd={};_0x1532dd[_0x893c1a(0x235)]=this[_0x893c1a(0x22a)][_0x893c1a(0x23e)+'s'][_0x4ce5b9['instanceNa'+'me']]['wuid'];const _0x2e7eca={};_0x2e7eca[_0x893c1a(0x1ee)]=_0x1532dd,yield _0x5cfd77[_0x893c1a(0x238)]('',_0x12aae2,_0x2e7eca);}}catch(_0x483998){this[_0x893c1a(0x23c)][_0x893c1a(0x226)](_0x483998);}return _0x3ccb2b;}catch(_0x5f2719){const _0x549860={};_0x549860[_0x893c1a(0x202)]=AuthService[_0x893c1a(0x1f6)]+('.refreshTo'+'ken'),_0x549860['error']=_0x5f2719,this[_0x893c1a(0x23c)][_0x893c1a(0x226)](_0x549860);throw new exceptions_1[(_0x893c1a(0x215))+(_0x893c1a(0x209))](_0x893c1a(0x20f)+_0x893c1a(0x21a));}});}}exports[a51_0x2a36b3(0x208)+'e']=AuthService;