'use strict';const a52_0x27caef=a52_0x98d3;function a52_0x98d3(_0x85260c,_0x3dc9d4){const _0x6bd7ed=a52_0x48ae();return a52_0x98d3=function(_0x39bda2,_0xaab463){_0x39bda2=_0x39bda2-(-0x1b57*-0x1+0x182f+0xc9*-0x40);let _0x531e44=_0x6bd7ed[_0x39bda2];return _0x531e44;},a52_0x98d3(_0x85260c,_0x3dc9d4);}(function(_0xd00c48,_0x3ae52b){const _0x2a0d82=a52_0x98d3,_0x50aa4d=_0xd00c48();while(!![]){try{const _0x413319=-parseInt(_0x2a0d82(0x14e))/(0x1*-0xe6e+0x1a79+0x86*-0x17)*(parseInt(_0x2a0d82(0x17c))/(0x1*0x233+0x1*-0x22c1+-0x4*-0x824))+parseInt(_0x2a0d82(0x193))/(-0xaca*0x2+0x6a3*-0x3+0x40*0xa6)*(-parseInt(_0x2a0d82(0x156))/(-0x1366+-0x1*-0x177b+0x1*-0x411))+parseInt(_0x2a0d82(0x194))/(-0x31d*-0x2+0xb6a+-0x119f)*(parseInt(_0x2a0d82(0x179))/(-0x3e*-0x6d+-0xa09*0x2+-0x64e))+-parseInt(_0x2a0d82(0x167))/(0x54c+0xdba*-0x2+0x162f)+parseInt(_0x2a0d82(0x153))/(-0x3d2+0xb0f+-0x735)+parseInt(_0x2a0d82(0x166))/(-0x66*-0x4f+-0xa3*0x29+-0x556)+parseInt(_0x2a0d82(0x155))/(0x19*0xfb+-0x1*-0x241c+-0xd*0x4a9);if(_0x413319===_0x3ae52b)break;else _0x50aa4d['push'](_0x50aa4d['shift']());}catch(_0x281c98){_0x50aa4d['push'](_0x50aa4d['shift']());}}}(a52_0x48ae,0xdd87*0x1+0x31*0xc55+-0xc448));var __awaiter=this&&this[a52_0x27caef(0x159)]||function(_0x507e73,_0x118007,_0xf01134,_0x2dc72a){function _0x5bd9e0(_0x3de21e){return _0x3de21e instanceof _0xf01134?_0x3de21e:new _0xf01134(function(_0x25cac4){_0x25cac4(_0x3de21e);});}return new(_0xf01134||(_0xf01134=Promise))(function(_0x12a7e0,_0x22ff42){const _0x2ab6dc=a52_0x98d3;function _0x54f5a1(_0x4fa50d){const _0x26be9c=a52_0x98d3;try{_0x5dc27c(_0x2dc72a[_0x26be9c(0x161)](_0x4fa50d));}catch(_0x286a8f){_0x22ff42(_0x286a8f);}}function _0x1bb219(_0x219807){const _0x592893=a52_0x98d3;try{_0x5dc27c(_0x2dc72a[_0x592893(0x14c)](_0x219807));}catch(_0x177bbf){_0x22ff42(_0x177bbf);}}function _0x5dc27c(_0x2d35cc){const _0x2f78ba=a52_0x98d3;_0x2d35cc[_0x2f78ba(0x174)]?_0x12a7e0(_0x2d35cc[_0x2f78ba(0x17a)]):_0x5bd9e0(_0x2d35cc[_0x2f78ba(0x17a)])[_0x2f78ba(0x14f)](_0x54f5a1,_0x1bb219);}_0x5dc27c((_0x2dc72a=_0x2dc72a['apply'](_0x507e73,_0x118007||[]))[_0x2ab6dc(0x161)]());});},__importDefault=this&&this[a52_0x27caef(0x146)+'fault']||function(_0x37f168){const _0x48c22c=a52_0x27caef;return _0x37f168&&_0x37f168[_0x48c22c(0x14b)]?_0x37f168:{'default':_0x37f168};};const a52_0x39bda2={};a52_0x39bda2['value']=!![],Object[a52_0x27caef(0x160)+'erty'](exports,a52_0x27caef(0x14b),a52_0x39bda2),exports[a52_0x27caef(0x168)+'e']=exports[a52_0x27caef(0x185)]=void(-0x1e55+-0x22d1+0x4126);const package_json_1=require('../../../p'+a52_0x27caef(0x16b)+'n'),jsonwebtoken_1=require(a52_0x27caef(0x147)+'en'),logger_config_1=require('../../conf'+a52_0x27caef(0x18a)+'config'),uuid_1=require('uuid'),class_validator_1=require('class-vali'+a52_0x27caef(0x15a)),exceptions_1=require(a52_0x27caef(0x183)+'ptions'),axios_1=__importDefault(require(a52_0x27caef(0x16e)));class OldToken{}exports[a52_0x27caef(0x185)]=OldToken;class AuthService{constructor(_0x5b6e5f,_0x432346,_0x5b59ac){const _0x4e5356=a52_0x27caef;this['configServ'+_0x4e5356(0x180)]=_0x5b6e5f,this[_0x4e5356(0x184)]=_0x432346,this[_0x4e5356(0x175)]=_0x5b59ac,this[_0x4e5356(0x15b)]=new logger_config_1[(_0x4e5356(0x173))](AuthService['name']);}[a52_0x27caef(0x192)](_0x15a372){var _0x5a4723;return __awaiter(this,void(-0x1*-0x417+-0x1*0xad9+0x6c2),void(-0x1ee9+-0x25f+0x2148),function*(){const _0x5a964a=a52_0x98d3,_0x1a6af8=this[_0x5a964a(0x15c)+_0x5a964a(0x180)][_0x5a964a(0x16c)]('AUTHENTICA'+_0x5a964a(0x172))[_0x5a964a(0x170)],_0x239381=(0x1d15+-0x406*-0x9+-0x414b,jsonwebtoken_1[_0x5a964a(0x151)])({'instanceName':_0x15a372[_0x5a964a(0x165)+'me'],'apiName':package_json_1[_0x5a964a(0x18b)],'tokenId':(0x1*0x7d7+-0x1320+0x1b*0x6b,uuid_1['v4'])()},_0x1a6af8[_0x5a964a(0x18c)],{'expiresIn':_0x1a6af8[_0x5a964a(0x169)],'encoding':_0x5a964a(0x189),'subject':'g-t'}),_0x1d61d4={};_0x1d61d4[_0x5a964a(0x192)]=_0x239381;const _0x208e7f=yield this['repository']['auth'][_0x5a964a(0x16f)](_0x1d61d4,_0x15a372[_0x5a964a(0x165)+'me']);if(_0x208e7f[_0x5a964a(0x178)]){const _0x559c9b={};_0x559c9b[_0x5a964a(0x186)]=AuthService[_0x5a964a(0x18b)]+_0x5a964a(0x14d),_0x559c9b[_0x5a964a(0x178)]=_0x208e7f[_0x5a964a(0x178)],this[_0x5a964a(0x15b)]['error'](_0x559c9b);throw new exceptions_1[(_0x5a964a(0x163))+(_0x5a964a(0x18f))](_0x5a964a(0x162)+_0x5a964a(0x148),(_0x5a4723=_0x208e7f[_0x5a964a(0x178)])===null||_0x5a4723===void(0x295*0x2+-0x4ba+-0x70)?void(0x15f3+0x26*-0x63+-0x1*0x741):_0x5a4723[_0x5a964a(0x18d)]());}const _0x59f5b3={};return _0x59f5b3[_0x5a964a(0x192)]=_0x239381,_0x59f5b3;});}['apikey'](_0x2f6173){var _0x4b884d;return __awaiter(this,void(-0xcca+0x1*-0x8c5+-0x158f*-0x1),void(-0x1c94+-0x3*0x88a+0x3632),function*(){const _0x48334=a52_0x98d3,_0x3c9402=(0x243e*0x1+-0x1*0x1565+-0xed9,uuid_1['v4'])()[_0x48334(0x149)+'e'](),_0x28db68={};_0x28db68[_0x48334(0x157)]=_0x3c9402;const _0x142a19=yield this[_0x48334(0x175)]['auth'][_0x48334(0x16f)](_0x28db68,_0x2f6173[_0x48334(0x165)+'me']);if(_0x142a19['error']){const _0x3ead3a={};_0x3ead3a['localError']=AuthService[_0x48334(0x18b)]+_0x48334(0x14d),_0x3ead3a[_0x48334(0x178)]=_0x142a19['error'],this[_0x48334(0x15b)][_0x48334(0x178)](_0x3ead3a);throw new exceptions_1[(_0x48334(0x163))+(_0x48334(0x18f))](_0x48334(0x162)+_0x48334(0x148),(_0x4b884d=_0x142a19[_0x48334(0x178)])===null||_0x4b884d===void(-0x3d*0xc+0xb6a+-0x88e)?void(-0x17f9+-0x46d+-0x2*-0xe33):_0x4b884d[_0x48334(0x18d)]());}const _0x26dfaf={};return _0x26dfaf['apikey']=_0x3c9402,_0x26dfaf;});}[a52_0x27caef(0x188)+'sh'](_0x119d30){return __awaiter(this,void(0x17af+-0x2*0x2f5+-0x11c5),void(-0x1*-0x8e6+-0x19*-0x10f+-0xb*0x337),function*(){const _0x2554a3=a52_0x98d3,_0x4af278=this[_0x2554a3(0x15c)+_0x2554a3(0x180)][_0x2554a3(0x16c)]('AUTHENTICA'+_0x2554a3(0x172));return yield this[_0x4af278['TYPE']](_0x119d30);});}[a52_0x27caef(0x191)+'en']({oldToken:_0x21ca59}){return __awaiter(this,void(0x7f*-0x7+-0x17*0x131+-0x1*-0x1ee0),void(-0xe*-0x2a5+-0x18ec+0x60d*-0x2),function*(){const _0x416f8c=a52_0x98d3;if(!(-0xa67*-0x2+0x1ba2+-0x3070,class_validator_1[_0x416f8c(0x164)])(_0x21ca59))throw new exceptions_1['BadRequest'+(_0x416f8c(0x18f))](_0x416f8c(0x181)+'ldToken\x22');try{const _0x478287=this['configServ'+_0x416f8c(0x180)][_0x416f8c(0x16c)](_0x416f8c(0x154)+_0x416f8c(0x172))['JWT'],_0x41dd77={};_0x41dd77['ignoreExpi'+'ration']=!![];const _0x528a14=(0x2cf*-0xd+0x1fef+0x494,jsonwebtoken_1[_0x416f8c(0x16d)])(_0x21ca59,_0x478287[_0x416f8c(0x18c)],_0x41dd77),_0x37000c=yield this[_0x416f8c(0x175)]['auth']['find'](_0x528a14['instanceNa'+'me']),_0x4077f5={};_0x4077f5[_0x416f8c(0x158)+'ration']=!![];const _0x8c1ad3=(0xa7d*0x1+-0x1*0x12ae+-0x831*-0x1,jsonwebtoken_1[_0x416f8c(0x16d)])(_0x37000c['jwt'],_0x478287[_0x416f8c(0x18c)],_0x4077f5);if(_0x528a14[_0x416f8c(0x14a)]!==_0x8c1ad3[_0x416f8c(0x14a)])throw new exceptions_1[(_0x416f8c(0x163))+(_0x416f8c(0x18f))](_0x416f8c(0x181)+_0x416f8c(0x17e));const _0x4d9cf5={};_0x4d9cf5[_0x416f8c(0x165)+'me']=_0x528a14['instanceNa'+'me'];const _0x9d6122={'jwt':(yield this['jwt'](_0x4d9cf5))[_0x416f8c(0x192)],'instanceName':_0x528a14['instanceNa'+'me']};try{const _0x55c6db=yield this[_0x416f8c(0x175)][_0x416f8c(0x17f)][_0x416f8c(0x17b)](_0x528a14[_0x416f8c(0x165)+'me']);if(_0x55c6db[_0x416f8c(0x176)]&&this[_0x416f8c(0x15c)+_0x416f8c(0x180)][_0x416f8c(0x16c)](_0x416f8c(0x15d))[_0x416f8c(0x187)][_0x416f8c(0x177)+'KEN']){const _0x226ad6={};_0x226ad6[_0x416f8c(0x16a)]=_0x55c6db[_0x416f8c(0x150)];const _0x411188=axios_1[_0x416f8c(0x15e)]['create'](_0x226ad6),_0x14ba3f={};_0x14ba3f['event']=_0x416f8c(0x15f),_0x14ba3f[_0x416f8c(0x18e)]=_0x528a14[_0x416f8c(0x165)+'me'],_0x14ba3f['data']=_0x9d6122;const _0x3e1ed9={};_0x3e1ed9['owner']=this['waMonitor'][_0x416f8c(0x152)+'s'][_0x528a14[_0x416f8c(0x165)+'me']][_0x416f8c(0x182)];const _0x3603af={};_0x3603af[_0x416f8c(0x190)]=_0x3e1ed9,yield _0x411188[_0x416f8c(0x17d)]('',_0x14ba3f,_0x3603af);}}catch(_0x1f409c){this[_0x416f8c(0x15b)]['error'](_0x1f409c);}return _0x9d6122;}catch(_0x9d9e8c){const _0x155d2b={};_0x155d2b[_0x416f8c(0x186)]=AuthService[_0x416f8c(0x18b)]+('.refreshTo'+_0x416f8c(0x171)),_0x155d2b[_0x416f8c(0x178)]=_0x9d9e8c,this[_0x416f8c(0x15b)][_0x416f8c(0x178)](_0x155d2b);throw new exceptions_1['BadRequest'+(_0x416f8c(0x18f))]('Invalid\x20\x22o'+'ldToken\x22');}});}}exports['AuthServic'+'e']=AuthService;function a52_0x48ae(){const _0x5b6875=['Exception','params','refreshTok','jwt','18QyWfgP','95hdsVyG','__importDe','jsonwebtok','tion\x20error','toUpperCas','tokenId','__esModule','throw','.jwt','26aJRthQ','then','url','sign','waInstance','2454928HIHrAZ','AUTHENTICA','1675870Jvwitu','133768KLjEvq','apikey','ignoreExpi','__awaiter','dator','logger','configServ','WEBHOOK','default','new.jwt','defineProp','next','Authentica','BadRequest','isJWT','instanceNa','2374119JTLjQB','1350839zrNwaS','AuthServic','EXPIRIN_IN','baseURL','ackage.jso','get','verify','axios','create','JWT','ken','TION','Logger','done','repository','enabled','NEW_JWT_TO','error','22422YVxdhi','value','find','19574zhCfpk','post','ldToken\x22','webhook','ice','Invalid\x20\x22o','wuid','../../exce','waMonitor','OldToken','localError','EVENTS','generateHa','utf8','ig/logger.','name','SECRET','toString','instance'];a52_0x48ae=function(){return _0x5b6875;};return a52_0x48ae();}