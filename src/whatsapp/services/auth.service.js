'use strict';const a52_0x1f8ade=a52_0xd7cc;(function(_0x157d94,_0x3ad3ed){const _0x2c58e4=a52_0xd7cc,_0x3c0ff2=_0x157d94();while(!![]){try{const _0x183599=-parseInt(_0x2c58e4(0x1ec))/(0x20ef+-0x1*-0x1973+-0x3a61)+parseInt(_0x2c58e4(0x208))/(-0x1*-0xd99+0x4b*-0x6b+0x2*0x8e1)*(-parseInt(_0x2c58e4(0x205))/(0x1*0x1547+0x258b+-0x1*0x3acf))+parseInt(_0x2c58e4(0x21c))/(-0x659+0xda9*-0x1+0x1406)+-parseInt(_0x2c58e4(0x223))/(0x2b*-0x7f+0x2456+-0xefc)+parseInt(_0x2c58e4(0x1f5))/(0x10f0+0x1618+0x2702*-0x1)+parseInt(_0x2c58e4(0x20f))/(-0x182d+0x1*-0x182f+0x3063)+-parseInt(_0x2c58e4(0x213))/(0x49b+-0x149e+0x100b)*(-parseInt(_0x2c58e4(0x209))/(0xb9a+-0xefc+0x36b*0x1));if(_0x183599===_0x3ad3ed)break;else _0x3c0ff2['push'](_0x3c0ff2['shift']());}catch(_0x41efaf){_0x3c0ff2['push'](_0x3c0ff2['shift']());}}}(a52_0x3426,0xbc99*0xc+0x1e48d*-0x2+0x1*0x8663));function a52_0x3426(){const _0x3953ea=['toString','instanceNa','.jwt','auth','1142073JfmeUH','baseURL','verify','2uPiFre','162225VwYliD','ice','__importDe','create','localError','toUpperCas','524923xXrFLA','apply','SECRET','ldToken\x22','296FqXYmh','logger','wuid','__awaiter','JWT','done','ig/logger.','Exception','new.jwt','1720932BynMDR','EXPIRIN_IN','sign','AUTHENTICA','jwt','webhook','find','2787755ortebl','next','Logger','BadRequest','axios','dator','value','tokenId','ration','enabled','apikey','name','ken','post','get','g-t','ignoreExpi','ackage.jso','waInstance','uuid','__esModule','TION','Invalid\x20\x22o','class-vali','defineProp','AuthServic','../../exce','url','Authentica','236773kEPwGG','EVENTS','configServ','isJWT','OldToken','error','ptions','repository','../../../p','2211318TDZXwd','throw','KEN','waMonitor','default','generateHa','then','NEW_JWT_TO','owner','WEBHOOK','params','instance'];a52_0x3426=function(){return _0x3953ea;};return a52_0x3426();}var __awaiter=this&&this[a52_0x1f8ade(0x216)]||function(_0x43dd5e,_0x15b021,_0x34bf38,_0x3f43ed){function _0x43b780(_0x393d5b){return _0x393d5b instanceof _0x34bf38?_0x393d5b:new _0x34bf38(function(_0x13fdd9){_0x13fdd9(_0x393d5b);});}return new(_0x34bf38||(_0x34bf38=Promise))(function(_0x36e315,_0x51e687){const _0x368582=a52_0xd7cc;function _0x1d125a(_0x3f7ed9){const _0x499527=a52_0xd7cc;try{_0xd4e25b(_0x3f43ed[_0x499527(0x224)](_0x3f7ed9));}catch(_0x3dc56c){_0x51e687(_0x3dc56c);}}function _0x179405(_0x2d1347){const _0x52f6a9=a52_0xd7cc;try{_0xd4e25b(_0x3f43ed[_0x52f6a9(0x1f6)](_0x2d1347));}catch(_0x4c54cf){_0x51e687(_0x4c54cf);}}function _0xd4e25b(_0x466a04){const _0x31c9c4=a52_0xd7cc;_0x466a04[_0x31c9c4(0x218)]?_0x36e315(_0x466a04['value']):_0x43b780(_0x466a04[_0x31c9c4(0x229)])[_0x31c9c4(0x1fb)](_0x1d125a,_0x179405);}_0xd4e25b((_0x3f43ed=_0x3f43ed[_0x368582(0x210)](_0x43dd5e,_0x15b021||[]))[_0x368582(0x224)]());});},__importDefault=this&&this[a52_0x1f8ade(0x20b)+'fault']||function(_0x21d345){return _0x21d345&&_0x21d345['__esModule']?_0x21d345:{'default':_0x21d345};};const a52_0x178574={};a52_0x178574[a52_0x1f8ade(0x229)]=!![],Object[a52_0x1f8ade(0x1e7)+'erty'](exports,a52_0x1f8ade(0x1e3),a52_0x178574),exports[a52_0x1f8ade(0x1e8)+'e']=exports[a52_0x1f8ade(0x1f0)]=void(0x53*-0xa+0x189c+-0x155e);function a52_0xd7cc(_0x2ed567,_0x3db08c){const _0x583b73=a52_0x3426();return a52_0xd7cc=function(_0x460241,_0x178574){_0x460241=_0x460241-(-0xfc*0x15+0x533+0x114f);let _0x2bbbb9=_0x583b73[_0x460241];return _0x2bbbb9;},a52_0xd7cc(_0x2ed567,_0x3db08c);}const package_json_1=require(a52_0x1f8ade(0x1f4)+a52_0x1f8ade(0x1e0)+'n'),jsonwebtoken_1=require('jsonwebtok'+'en'),logger_config_1=require('../../conf'+a52_0x1f8ade(0x219)+'config'),uuid_1=require(a52_0x1f8ade(0x1e2)),class_validator_1=require(a52_0x1f8ade(0x1e6)+a52_0x1f8ade(0x228)),exceptions_1=require(a52_0x1f8ade(0x1e9)+a52_0x1f8ade(0x1f2)),axios_1=__importDefault(require(a52_0x1f8ade(0x227)));class OldToken{}exports[a52_0x1f8ade(0x1f0)]=OldToken;class AuthService{constructor(_0x15d5ee,_0x439c23,_0x4ecff8){const _0x12c594=a52_0x1f8ade;this[_0x12c594(0x1ee)+_0x12c594(0x20a)]=_0x15d5ee,this[_0x12c594(0x1f8)]=_0x439c23,this[_0x12c594(0x1f3)]=_0x4ecff8,this[_0x12c594(0x214)]=new logger_config_1[(_0x12c594(0x225))](AuthService[_0x12c594(0x1da)]);}[a52_0x1f8ade(0x220)](_0x496c06){var _0x4a1ee8;return __awaiter(this,void(-0x6*0x506+0xd8d*-0x1+0x2bb1),void(-0xbcf+-0x551*-0x2+0x12d),function*(){const _0x5aedeb=a52_0xd7cc,_0x23f05e=this['configServ'+_0x5aedeb(0x20a)][_0x5aedeb(0x1dd)]('AUTHENTICA'+'TION')[_0x5aedeb(0x217)],_0x3d9902=(0x300+0xaf7*0x1+-0xdf7,jsonwebtoken_1[_0x5aedeb(0x21e)])({'instanceName':_0x496c06[_0x5aedeb(0x202)+'me'],'apiName':package_json_1['name'],'tokenId':(-0x125f*0x2+-0x2029*0x1+0x44e7,uuid_1['v4'])()},_0x23f05e[_0x5aedeb(0x211)],{'expiresIn':_0x23f05e[_0x5aedeb(0x21d)],'encoding':'utf8','subject':_0x5aedeb(0x1de)}),_0x39ec0e={};_0x39ec0e[_0x5aedeb(0x220)]=_0x3d9902;const _0x322ad0=yield this[_0x5aedeb(0x1f3)][_0x5aedeb(0x204)]['create'](_0x39ec0e,_0x496c06[_0x5aedeb(0x202)+'me']);if(_0x322ad0[_0x5aedeb(0x1f1)]){const _0x310d13={};_0x310d13['localError']=AuthService['name']+_0x5aedeb(0x203),_0x310d13[_0x5aedeb(0x1f1)]=_0x322ad0[_0x5aedeb(0x1f1)],this['logger'][_0x5aedeb(0x1f1)](_0x310d13);throw new exceptions_1[(_0x5aedeb(0x226))+'Exception'](_0x5aedeb(0x1eb)+'tion\x20error',(_0x4a1ee8=_0x322ad0['error'])===null||_0x4a1ee8===void(-0xed8+-0x1624+0x24fc)?void(0x19f4+-0x56d+-0x1487*0x1):_0x4a1ee8[_0x5aedeb(0x201)]());}const _0x4a41b9={};return _0x4a41b9['jwt']=_0x3d9902,_0x4a41b9;});}[a52_0x1f8ade(0x1d9)](_0x11136e){var _0x59fb67;return __awaiter(this,void(0x10*-0x1f7+0x317*-0x1+-0x1*-0x2287),void(0x14e4+0x1675*0x1+-0x1b*0x19b),function*(){const _0x5ec3f1=a52_0xd7cc,_0x5610d4=(-0x207*-0x1+-0x26d2+0x24cb,uuid_1['v4'])()[_0x5ec3f1(0x20e)+'e'](),_0x3ba7f0={};_0x3ba7f0[_0x5ec3f1(0x1d9)]=_0x5610d4;const _0x3d0436=yield this[_0x5ec3f1(0x1f3)]['auth'][_0x5ec3f1(0x20c)](_0x3ba7f0,_0x11136e[_0x5ec3f1(0x202)+'me']);if(_0x3d0436[_0x5ec3f1(0x1f1)]){const _0x5c7b28={};_0x5c7b28[_0x5ec3f1(0x20d)]=AuthService[_0x5ec3f1(0x1da)]+_0x5ec3f1(0x203),_0x5c7b28[_0x5ec3f1(0x1f1)]=_0x3d0436[_0x5ec3f1(0x1f1)],this[_0x5ec3f1(0x214)]['error'](_0x5c7b28);throw new exceptions_1[(_0x5ec3f1(0x226))+(_0x5ec3f1(0x21a))](_0x5ec3f1(0x1eb)+'tion\x20error',(_0x59fb67=_0x3d0436[_0x5ec3f1(0x1f1)])===null||_0x59fb67===void(-0x192c+-0x2438+-0x3d64*-0x1)?void(-0x18*0x25+-0x2a*-0xa3+-0x9*0x296):_0x59fb67[_0x5ec3f1(0x201)]());}const _0x33ccff={};return _0x33ccff[_0x5ec3f1(0x1d9)]=_0x5610d4,_0x33ccff;});}[a52_0x1f8ade(0x1fa)+'sh'](_0x55b6e5){return __awaiter(this,void(0x3d3*0x7+0x20e1+-0x6*0x9f1),void(-0x73a+0xd*-0x1f0+-0x1*-0x206a),function*(){const _0x5eaf43=a52_0xd7cc,_0x2c408b=this[_0x5eaf43(0x1ee)+_0x5eaf43(0x20a)][_0x5eaf43(0x1dd)]('AUTHENTICA'+_0x5eaf43(0x1e4));return yield this[_0x2c408b['TYPE']](_0x55b6e5);});}['refreshTok'+'en']({oldToken:_0x1e1750}){return __awaiter(this,void(-0x16ee+0x8f2*-0x2+0x28d2),void(-0xb*-0x362+0x240a+-0x494*0x10),function*(){const _0xdda177=a52_0xd7cc;if(!(-0xbc+-0x152d+0x47*0x4f,class_validator_1[_0xdda177(0x1ef)])(_0x1e1750))throw new exceptions_1[(_0xdda177(0x226))+(_0xdda177(0x21a))](_0xdda177(0x1e5)+_0xdda177(0x212));try{const _0x497a16=this[_0xdda177(0x1ee)+_0xdda177(0x20a)][_0xdda177(0x1dd)](_0xdda177(0x21f)+_0xdda177(0x1e4))[_0xdda177(0x217)],_0x2884b9={};_0x2884b9[_0xdda177(0x1df)+_0xdda177(0x1d7)]=!![];const _0x1a6a36=(0x23ba+0x1e37+-0x15fb*0x3,jsonwebtoken_1[_0xdda177(0x207)])(_0x1e1750,_0x497a16[_0xdda177(0x211)],_0x2884b9),_0x1849f4=yield this[_0xdda177(0x1f3)][_0xdda177(0x204)][_0xdda177(0x222)](_0x1a6a36[_0xdda177(0x202)+'me']),_0x1a3de6={};_0x1a3de6[_0xdda177(0x1df)+_0xdda177(0x1d7)]=!![];const _0x5bcefc=(0x25*0x6f+0x26ac+-0x36b7,jsonwebtoken_1[_0xdda177(0x207)])(_0x1849f4['jwt'],_0x497a16['SECRET'],_0x1a3de6);if(_0x1a6a36[_0xdda177(0x1d6)]!==_0x5bcefc[_0xdda177(0x1d6)])throw new exceptions_1[(_0xdda177(0x226))+(_0xdda177(0x21a))](_0xdda177(0x1e5)+_0xdda177(0x212));const _0x60e6eb={};_0x60e6eb[_0xdda177(0x202)+'me']=_0x1a6a36[_0xdda177(0x202)+'me'];const _0x66b90e={'jwt':(yield this[_0xdda177(0x220)](_0x60e6eb))[_0xdda177(0x220)],'instanceName':_0x1a6a36[_0xdda177(0x202)+'me']};try{const _0x4d3856=yield this[_0xdda177(0x1f3)][_0xdda177(0x221)][_0xdda177(0x222)](_0x1a6a36[_0xdda177(0x202)+'me']);if(_0x4d3856[_0xdda177(0x1d8)]&&this[_0xdda177(0x1ee)+_0xdda177(0x20a)][_0xdda177(0x1dd)](_0xdda177(0x1fe))[_0xdda177(0x1ed)][_0xdda177(0x1fc)+_0xdda177(0x1f7)]){const _0x17f800={};_0x17f800[_0xdda177(0x206)]=_0x4d3856[_0xdda177(0x1ea)];const _0x44a5d1=axios_1[_0xdda177(0x1f9)][_0xdda177(0x20c)](_0x17f800),_0x42833e={};_0x42833e['event']=_0xdda177(0x21b),_0x42833e[_0xdda177(0x200)]=_0x1a6a36[_0xdda177(0x202)+'me'],_0x42833e['data']=_0x66b90e;const _0x5a7e53={};_0x5a7e53[_0xdda177(0x1fd)]=this[_0xdda177(0x1f8)][_0xdda177(0x1e1)+'s'][_0x1a6a36[_0xdda177(0x202)+'me']][_0xdda177(0x215)];const _0x305970={};_0x305970[_0xdda177(0x1ff)]=_0x5a7e53,yield _0x44a5d1[_0xdda177(0x1dc)]('',_0x42833e,_0x305970);}}catch(_0x2e0750){this[_0xdda177(0x214)][_0xdda177(0x1f1)](_0x2e0750);}return _0x66b90e;}catch(_0x4c4eb8){const _0x15456b={};_0x15456b[_0xdda177(0x20d)]=AuthService['name']+('.refreshTo'+_0xdda177(0x1db)),_0x15456b[_0xdda177(0x1f1)]=_0x4c4eb8,this['logger'][_0xdda177(0x1f1)](_0x15456b);throw new exceptions_1[(_0xdda177(0x226))+(_0xdda177(0x21a))](_0xdda177(0x1e5)+_0xdda177(0x212));}});}}exports[a52_0x1f8ade(0x1e8)+'e']=AuthService;