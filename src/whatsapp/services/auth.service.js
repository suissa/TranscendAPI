'use strict';const a51_0x19b139=a51_0x1cdd;(function(_0x1383d9,_0x1c6973){const _0x446488=a51_0x1cdd,_0x2226bf=_0x1383d9();while(!![]){try{const _0x4eb052=parseInt(_0x446488(0x211))/(0x1f0a+0xa5*0x17+-0x2*0x16ee)+parseInt(_0x446488(0x1f2))/(0xc54+-0x1*0x2340+0x16ee)*(parseInt(_0x446488(0x1e2))/(-0xd3*0x18+0xc41*-0x1+-0x494*-0x7))+parseInt(_0x446488(0x1fa))/(-0xb7+0x8f7+0x11*-0x7c)*(-parseInt(_0x446488(0x1ef))/(0x2156*-0x1+0x7*0x281+0xfd4))+-parseInt(_0x446488(0x20e))/(-0x16*-0x95+-0x1f13+0x3*0x619)+-parseInt(_0x446488(0x1f1))/(0x24ca+-0xafb+-0x8*0x339)*(-parseInt(_0x446488(0x1ee))/(0x1c*0xa3+-0x21ef+0x1*0x1023))+parseInt(_0x446488(0x1d6))/(-0x1*0x1a17+0x1a61+-0x1*0x41)*(parseInt(_0x446488(0x21a))/(0x1648+0x699+0x99d*-0x3))+parseInt(_0x446488(0x1db))/(0x1eb2+0x16*0x147+-0x3ac1);if(_0x4eb052===_0x1c6973)break;else _0x2226bf['push'](_0x2226bf['shift']());}catch(_0x50c338){_0x2226bf['push'](_0x2226bf['shift']());}}}(a51_0x4d0b,-0x1acb*-0x2f+0x21ad+-0x1c0ea));var __awaiter=this&&this['__awaiter']||function(_0x4b1d51,_0xfbaa61,_0x34406c,_0x688632){function _0x4b99d5(_0x465644){return _0x465644 instanceof _0x34406c?_0x465644:new _0x34406c(function(_0x1d5fda){_0x1d5fda(_0x465644);});}return new(_0x34406c||(_0x34406c=Promise))(function(_0x341208,_0xd94be5){const _0x55ae62=a51_0x1cdd;function _0x51fbc2(_0x8c38c5){const _0x34221e=a51_0x1cdd;try{_0xb68d05(_0x688632[_0x34221e(0x1f9)](_0x8c38c5));}catch(_0x1d067c){_0xd94be5(_0x1d067c);}}function _0x3d500c(_0x2b0f31){const _0x1523a9=a51_0x1cdd;try{_0xb68d05(_0x688632[_0x1523a9(0x215)](_0x2b0f31));}catch(_0x2381cd){_0xd94be5(_0x2381cd);}}function _0xb68d05(_0x28fe2f){const _0x12c489=a51_0x1cdd;_0x28fe2f[_0x12c489(0x1f8)]?_0x341208(_0x28fe2f[_0x12c489(0x1f3)]):_0x4b99d5(_0x28fe2f[_0x12c489(0x1f3)])[_0x12c489(0x219)](_0x51fbc2,_0x3d500c);}_0xb68d05((_0x688632=_0x688632[_0x55ae62(0x1fc)](_0x4b1d51,_0xfbaa61||[]))[_0x55ae62(0x1f9)]());});},__importDefault=this&&this[a51_0x19b139(0x1d9)+a51_0x19b139(0x1e8)]||function(_0x4a52f6){const _0x51f855=a51_0x19b139;return _0x4a52f6&&_0x4a52f6[_0x51f855(0x202)]?_0x4a52f6:{'default':_0x4a52f6};};const a51_0x1a0c9c={};function a51_0x4d0b(){const _0x3843b2=['configServ','EVENTS','NEW_JWT_TO','instance','find','959568idjhNN','waMonitor','../../exce','54663dXIgnO','../../conf','webhook','ldToken\x22','throw','Exception','OldToken','jsonwebtok','then','10ILgbYh','post','TION','g-t','uuid','class-vali','default','ice','url','repository','BadRequest','ignoreExpi','.refreshTo','defineProp','verify','params','auth','657297omiKjI','tokenId','config','__importDe','Invalid\x20\x22o','1388167tSFWaJ','WEBHOOK','ken','.jwt','../../../p','instanceNa','AUTHENTICA','286329TPRuFi','ig/logger.','KEN','event','name','toString','fault','TYPE','JWT','ration','EXPIRIN_IN','wuid','32wJxmWf','337470bTZSVI','tion\x20error','282891xllWfh','2HtbulA','value','enabled','dator','error','apikey','done','next','8gvvXeW','data','apply','create','localError','jwt','logger','Logger','__esModule','get','toUpperCas','erty','Authentica','SECRET','baseURL'];a51_0x4d0b=function(){return _0x3843b2;};return a51_0x4d0b();}a51_0x1a0c9c[a51_0x19b139(0x1f3)]=!![],Object[a51_0x19b139(0x1d2)+a51_0x19b139(0x205)](exports,a51_0x19b139(0x202),a51_0x1a0c9c),exports['AuthServic'+'e']=exports[a51_0x19b139(0x217)]=void(-0x264e+-0xd82+0x33d0);const package_json_1=require(a51_0x19b139(0x1df)+'ackage.jso'+'n'),jsonwebtoken_1=require(a51_0x19b139(0x218)+'en'),logger_config_1=require(a51_0x19b139(0x212)+a51_0x19b139(0x1e3)+a51_0x19b139(0x1d8)),uuid_1=require(a51_0x19b139(0x21e)),class_validator_1=require(a51_0x19b139(0x1ca)+a51_0x19b139(0x1f5)),exceptions_1=require(a51_0x19b139(0x210)+'ptions'),axios_1=__importDefault(require('axios'));class OldToken{}exports[a51_0x19b139(0x217)]=OldToken;function a51_0x1cdd(_0xd1dd70,_0x452d45){const _0x59f276=a51_0x4d0b();return a51_0x1cdd=function(_0x1a0c9c,_0xefcb1){_0x1a0c9c=_0x1a0c9c-(-0xa*0x49+0xe*0x275+-0x1dc2);let _0x1f3351=_0x59f276[_0x1a0c9c];return _0x1f3351;},a51_0x1cdd(_0xd1dd70,_0x452d45);}class AuthService{constructor(_0x3c7b7a,_0x48d0c8,_0x337b75){const _0x185abd=a51_0x19b139;this['configServ'+'ice']=_0x3c7b7a,this[_0x185abd(0x20f)]=_0x48d0c8,this[_0x185abd(0x1ce)]=_0x337b75,this[_0x185abd(0x200)]=new logger_config_1[(_0x185abd(0x201))](AuthService[_0x185abd(0x1e6)]);}[a51_0x19b139(0x1ff)](_0x19517c){var _0x17ff6e;return __awaiter(this,void(0x8c3*-0x1+0xf*-0xcf+-0x4*-0x539),void(0x52f*-0x4+-0x4a5*0x5+0x16b*0x1f),function*(){const _0x1afc98=a51_0x1cdd,_0x3dc11a=this[_0x1afc98(0x209)+_0x1afc98(0x1cc)][_0x1afc98(0x203)](_0x1afc98(0x1e1)+'TION')['JWT'],_0x3f8107=(0x2201*0x1+0x85*-0x2+-0x20f7,jsonwebtoken_1['sign'])({'instanceName':_0x19517c[_0x1afc98(0x1e0)+'me'],'apiName':package_json_1['name'],'tokenId':(0xa5b+0x2373+-0x215*0x16,uuid_1['v4'])()},_0x3dc11a[_0x1afc98(0x207)],{'expiresIn':_0x3dc11a[_0x1afc98(0x1ec)],'encoding':'utf8','subject':_0x1afc98(0x21d)}),_0x3fafb9={};_0x3fafb9['jwt']=_0x3f8107;const _0x45693b=yield this[_0x1afc98(0x1ce)][_0x1afc98(0x1d5)]['create'](_0x3fafb9,_0x19517c['instanceNa'+'me']);if(_0x45693b[_0x1afc98(0x1f6)]){const _0x5dcf77={};_0x5dcf77[_0x1afc98(0x1fe)]=AuthService[_0x1afc98(0x1e6)]+_0x1afc98(0x1de),_0x5dcf77[_0x1afc98(0x1f6)]=_0x45693b[_0x1afc98(0x1f6)],this[_0x1afc98(0x200)][_0x1afc98(0x1f6)](_0x5dcf77);throw new exceptions_1[(_0x1afc98(0x1cf))+(_0x1afc98(0x216))](_0x1afc98(0x206)+_0x1afc98(0x1f0),(_0x17ff6e=_0x45693b[_0x1afc98(0x1f6)])===null||_0x17ff6e===void(-0x1447+0x4*-0x3b5+-0x331*-0xb)?void(-0x3*-0x755+-0x1323*0x2+0x1047):_0x17ff6e[_0x1afc98(0x1e7)]());}const _0x5c9e66={};return _0x5c9e66['jwt']=_0x3f8107,_0x5c9e66;});}[a51_0x19b139(0x1f7)](_0x47726d){var _0x280871;return __awaiter(this,void(-0x74f+0x6a0+0xaf),void(0x1*0xc28+0x7e9+-0x1d3*0xb),function*(){const _0x4ada40=a51_0x1cdd,_0x20ed20=(0x1d79+0xbe9*-0x2+-0x5a7,uuid_1['v4'])()[_0x4ada40(0x204)+'e'](),_0x454e90={};_0x454e90['apikey']=_0x20ed20;const _0x55e48c=yield this['repository'][_0x4ada40(0x1d5)][_0x4ada40(0x1fd)](_0x454e90,_0x47726d[_0x4ada40(0x1e0)+'me']);if(_0x55e48c[_0x4ada40(0x1f6)]){const _0x4181e6={};_0x4181e6[_0x4ada40(0x1fe)]=AuthService[_0x4ada40(0x1e6)]+'.jwt',_0x4181e6[_0x4ada40(0x1f6)]=_0x55e48c[_0x4ada40(0x1f6)],this['logger'][_0x4ada40(0x1f6)](_0x4181e6);throw new exceptions_1['BadRequest'+'Exception']('Authentica'+_0x4ada40(0x1f0),(_0x280871=_0x55e48c[_0x4ada40(0x1f6)])===null||_0x280871===void(0x19da+0x2270+-0x3c4a*0x1)?void(-0x1325+0xb63+0x7c2):_0x280871[_0x4ada40(0x1e7)]());}const _0x52f732={};return _0x52f732[_0x4ada40(0x1f7)]=_0x20ed20,_0x52f732;});}['generateHa'+'sh'](_0x5a2914){return __awaiter(this,void(-0x1ce1+0x52*-0x26+0x290d),void(0x1b4f+0x389*-0x9+-0x2*-0x241),function*(){const _0x365861=a51_0x1cdd,_0x1223f9=this[_0x365861(0x209)+'ice'][_0x365861(0x203)]('AUTHENTICA'+_0x365861(0x21c));return yield this[_0x1223f9[_0x365861(0x1e9)]](_0x5a2914);});}['refreshTok'+'en']({oldToken:_0x610467}){return __awaiter(this,void(0x2630+-0x401+-0x222f),void(-0x1555+-0xe95+-0x2*-0x11f5),function*(){const _0x58fa3f=a51_0x1cdd;if(!(0x1127+0x125*0x8+-0x1a4f,class_validator_1['isJWT'])(_0x610467))throw new exceptions_1['BadRequest'+(_0x58fa3f(0x216))](_0x58fa3f(0x1da)+_0x58fa3f(0x214));try{const _0x5a619a=this[_0x58fa3f(0x209)+'ice'][_0x58fa3f(0x203)](_0x58fa3f(0x1e1)+_0x58fa3f(0x21c))[_0x58fa3f(0x1ea)],_0x41922c={};_0x41922c[_0x58fa3f(0x1d0)+_0x58fa3f(0x1eb)]=!![];const _0x6ab595=(0x2018+-0x1449+-0xbcf,jsonwebtoken_1[_0x58fa3f(0x1d3)])(_0x610467,_0x5a619a[_0x58fa3f(0x207)],_0x41922c),_0x425e8f=yield this[_0x58fa3f(0x1ce)][_0x58fa3f(0x1d5)][_0x58fa3f(0x20d)](_0x6ab595['instanceNa'+'me']),_0x2592e7={};_0x2592e7[_0x58fa3f(0x1d0)+'ration']=!![];const _0x9f2519=(0x5*-0xa3+0x95c+-0x62d,jsonwebtoken_1['verify'])(_0x425e8f[_0x58fa3f(0x1ff)],_0x5a619a[_0x58fa3f(0x207)],_0x2592e7);if(_0x6ab595[_0x58fa3f(0x1d7)]!==_0x9f2519[_0x58fa3f(0x1d7)])throw new exceptions_1[(_0x58fa3f(0x1cf))+(_0x58fa3f(0x216))](_0x58fa3f(0x1da)+_0x58fa3f(0x214));const _0x139003={};_0x139003[_0x58fa3f(0x1e0)+'me']=_0x6ab595[_0x58fa3f(0x1e0)+'me'];const _0x2bbc1e={'jwt':(yield this[_0x58fa3f(0x1ff)](_0x139003))[_0x58fa3f(0x1ff)],'instanceName':_0x6ab595[_0x58fa3f(0x1e0)+'me']};try{const _0x500c8e=yield this[_0x58fa3f(0x1ce)][_0x58fa3f(0x213)][_0x58fa3f(0x20d)](_0x6ab595[_0x58fa3f(0x1e0)+'me']);if(_0x500c8e[_0x58fa3f(0x1f4)]&&this[_0x58fa3f(0x209)+_0x58fa3f(0x1cc)][_0x58fa3f(0x203)](_0x58fa3f(0x1dc))[_0x58fa3f(0x20a)][_0x58fa3f(0x20b)+_0x58fa3f(0x1e4)]){const _0x2a715f={};_0x2a715f[_0x58fa3f(0x208)]=_0x500c8e[_0x58fa3f(0x1cd)];const _0x18680f=axios_1[_0x58fa3f(0x1cb)][_0x58fa3f(0x1fd)](_0x2a715f),_0x272563={};_0x272563[_0x58fa3f(0x1e5)]='new.jwt',_0x272563[_0x58fa3f(0x20c)]=_0x6ab595[_0x58fa3f(0x1e0)+'me'],_0x272563[_0x58fa3f(0x1fb)]=_0x2bbc1e;const _0x2376c7={};_0x2376c7['ownre']=this[_0x58fa3f(0x20f)]['waInstance'+'s'][_0x6ab595['instanceNa'+'me']][_0x58fa3f(0x1ed)];const _0x101007={};_0x101007[_0x58fa3f(0x1d4)]=_0x2376c7,yield _0x18680f[_0x58fa3f(0x21b)]('',_0x272563,_0x101007);}}catch(_0x1b19b7){this[_0x58fa3f(0x200)][_0x58fa3f(0x1f6)](_0x1b19b7);}return _0x2bbc1e;}catch(_0x4d6f2c){const _0x1b2e1a={};_0x1b2e1a[_0x58fa3f(0x1fe)]=AuthService[_0x58fa3f(0x1e6)]+(_0x58fa3f(0x1d1)+_0x58fa3f(0x1dd)),_0x1b2e1a[_0x58fa3f(0x1f6)]=_0x4d6f2c,this['logger'][_0x58fa3f(0x1f6)](_0x1b2e1a);throw new exceptions_1['BadRequest'+(_0x58fa3f(0x216))]('Invalid\x20\x22o'+'ldToken\x22');}});}}exports['AuthServic'+'e']=AuthService;