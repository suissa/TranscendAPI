'use strict';const a51_0x356f62=a51_0x3d7b;(function(_0x35a556,_0x4d998b){const _0x2a9781=a51_0x3d7b,_0x244546=_0x35a556();while(!![]){try{const _0x4561d5=-parseInt(_0x2a9781(0xf8))/(-0xa9b+0x25*-0x9d+0x214d*0x1)+parseInt(_0x2a9781(0x114))/(0xb*0x25+-0x1e85*-0x1+0x1*-0x201a)*(-parseInt(_0x2a9781(0x131))/(-0x6e5+0x11b4+-0xacc))+-parseInt(_0x2a9781(0x10c))/(0x19d*-0x1+0x2*-0xe6a+0x1*0x1e75)+parseInt(_0x2a9781(0x13c))/(-0x25cd*-0x1+-0x4e*0x69+-0xd*0x72)*(-parseInt(_0x2a9781(0x12b))/(0xa*0x27a+-0x9*0x173+-0xbb3))+-parseInt(_0x2a9781(0x105))/(0x1a25+-0x244+-0x17da)*(parseInt(_0x2a9781(0x136))/(0x7*-0x575+0xb*-0x32f+0x928*0x8))+-parseInt(_0x2a9781(0x110))/(-0x7f*0x41+0x451+0x1bf7)+parseInt(_0x2a9781(0x102))/(-0x968+0x24a8+0xa2*-0x2b);if(_0x4561d5===_0x4d998b)break;else _0x244546['push'](_0x244546['shift']());}catch(_0x48add1){_0x244546['push'](_0x244546['shift']());}}}(a51_0x2f87,0x2cdc1+-0x18a2+0x1*0x169fd));var __awaiter=this&&this[a51_0x356f62(0xf5)]||function(_0x3b0f92,_0x183fe6,_0x2a569,_0x2806a0){function _0x4f36c4(_0x4d43e2){return _0x4d43e2 instanceof _0x2a569?_0x4d43e2:new _0x2a569(function(_0x49202e){_0x49202e(_0x4d43e2);});}return new(_0x2a569||(_0x2a569=Promise))(function(_0x360765,_0x10ddc1){const _0x22b6f5=a51_0x3d7b;function _0x3c222d(_0x4c0ca8){const _0x3976db=a51_0x3d7b;try{_0x1f994b(_0x2806a0[_0x3976db(0x12f)](_0x4c0ca8));}catch(_0x15ec01){_0x10ddc1(_0x15ec01);}}function _0x4465dd(_0xf74bf0){const _0x34ed10=a51_0x3d7b;try{_0x1f994b(_0x2806a0[_0x34ed10(0x126)](_0xf74bf0));}catch(_0x226325){_0x10ddc1(_0x226325);}}function _0x1f994b(_0x273eaa){const _0x18d344=a51_0x3d7b;_0x273eaa['done']?_0x360765(_0x273eaa[_0x18d344(0x148)]):_0x4f36c4(_0x273eaa[_0x18d344(0x148)])[_0x18d344(0x12c)](_0x3c222d,_0x4465dd);}_0x1f994b((_0x2806a0=_0x2806a0[_0x22b6f5(0x123)](_0x3b0f92,_0x183fe6||[]))[_0x22b6f5(0x12f)]());});},__importDefault=this&&this[a51_0x356f62(0x10e)+a51_0x356f62(0x11b)]||function(_0x53c145){const _0x3f6713=a51_0x356f62;return _0x53c145&&_0x53c145[_0x3f6713(0x135)]?_0x53c145:{'default':_0x53c145};};const a51_0x501a24={};function a51_0x2f87(){const _0x128e70=['error','refreshTok','post','url','auth','create','uuid','jsonwebtok','EVENTS','.jwt','webhook','value','ice','Authentica','instance','__awaiter','WEBHOOK','.refreshTo','241623VsHPUc','ownre','instanceNa','../../exce','config','Exception','EXPIRIN_IN','JWT','get','name','21654450BtqvNZ','KEN','enabled','21532hmWUHN','BadRequest','dator','repository','g-t','class-vali','waInstance','389140STkqMO','AuthServic','__importDe','erty','4044438amLrLH','Invalid\x20\x22o','TYPE','ig/logger.','2VMWLjU','../../../p','ackage.jso','ration','ldToken\x22','toString','Logger','fault','SECRET','localError','tokenId','TION','apikey','../../conf','jwt','apply','verify','baseURL','throw','AUTHENTICA','logger','wuid','ignoreExpi','372fZbmGi','then','tion\x20error','new.jwt','next','OldToken','1424679LIYsFc','find','NEW_JWT_TO','isJWT','__esModule','888uWCYtD','configServ','data','params','sign','event','23445rnpTRR'];a51_0x2f87=function(){return _0x128e70;};return a51_0x2f87();}function a51_0x3d7b(_0x505366,_0x14fef4){const _0x5ca9a2=a51_0x2f87();return a51_0x3d7b=function(_0x164833,_0x501a24){_0x164833=_0x164833-(-0x27c+0x3*-0x3f1+0xf42);let _0x4e4e11=_0x5ca9a2[_0x164833];return _0x4e4e11;},a51_0x3d7b(_0x505366,_0x14fef4);}a51_0x501a24[a51_0x356f62(0x148)]=!![],Object['defineProp'+a51_0x356f62(0x10f)](exports,a51_0x356f62(0x135),a51_0x501a24),exports[a51_0x356f62(0x10d)+'e']=exports['OldToken']=void(0x1916+-0x8f*0x34+0x3f6);const package_json_1=require(a51_0x356f62(0x115)+a51_0x356f62(0x116)+'n'),jsonwebtoken_1=require(a51_0x356f62(0x144)+'en'),logger_config_1=require(a51_0x356f62(0x121)+a51_0x356f62(0x113)+a51_0x356f62(0xfc)),uuid_1=require(a51_0x356f62(0x143)),class_validator_1=require(a51_0x356f62(0x10a)+a51_0x356f62(0x107)),exceptions_1=require(a51_0x356f62(0xfb)+'ptions'),axios_1=__importDefault(require('axios'));class OldToken{}exports[a51_0x356f62(0x130)]=OldToken;class AuthService{constructor(_0x5bcb6b,_0x4e76be,_0x4bf511){const _0x45c567=a51_0x356f62;this[_0x45c567(0x137)+_0x45c567(0x149)]=_0x5bcb6b,this['waMonitor']=_0x4e76be,this[_0x45c567(0x108)]=_0x4bf511,this['logger']=new logger_config_1[(_0x45c567(0x11a))](AuthService[_0x45c567(0x101)]);}[a51_0x356f62(0x122)](_0x55b16a){var _0x396b27;return __awaiter(this,void(0x5a1+-0x18f4+0x1*0x1353),void(-0x3*0x87a+0x1ca0+-0x332),function*(){const _0x996208=a51_0x3d7b,_0x1ae1ea=this[_0x996208(0x137)+_0x996208(0x149)][_0x996208(0x100)](_0x996208(0x127)+_0x996208(0x11f))['JWT'],_0x178f4e=(0x7da+-0xf07*0x2+0xc4*0x1d,jsonwebtoken_1[_0x996208(0x13a)])({'instanceName':_0x55b16a[_0x996208(0xfa)+'me'],'apiName':package_json_1[_0x996208(0x101)],'tokenId':(-0x1dba+0x33e+0x1a7c,uuid_1['v4'])()},_0x1ae1ea[_0x996208(0x11c)],{'expiresIn':_0x1ae1ea[_0x996208(0xfe)],'encoding':'utf8','subject':_0x996208(0x109)}),_0x10c62f={};_0x10c62f[_0x996208(0x122)]=_0x178f4e;const _0x585a6d=yield this['repository'][_0x996208(0x141)][_0x996208(0x142)](_0x10c62f,_0x55b16a[_0x996208(0xfa)+'me']);if(_0x585a6d['error']){const _0x431bc8={};_0x431bc8[_0x996208(0x11d)]=AuthService[_0x996208(0x101)]+'.jwt',_0x431bc8[_0x996208(0x13d)]=_0x585a6d[_0x996208(0x13d)],this[_0x996208(0x128)][_0x996208(0x13d)](_0x431bc8);throw new exceptions_1[(_0x996208(0x106))+(_0x996208(0xfd))]('Authentica'+'tion\x20error',(_0x396b27=_0x585a6d['error'])===null||_0x396b27===void(-0x2*-0x8a5+0x15a7+-0x26f1)?void(-0xd*0x119+0x218c+-0x1347):_0x396b27['toString']());}const _0x44b96a={};return _0x44b96a[_0x996208(0x122)]=_0x178f4e,_0x44b96a;});}[a51_0x356f62(0x120)](_0x3b2388){var _0x168adf;return __awaiter(this,void(-0xef*-0x1a+0x1*-0x1bd2+0x38c),void(0x46b+0x325+-0x790),function*(){const _0x5266a2=a51_0x3d7b,_0x3001fd=(0xe15*-0x1+-0x3*0x65b+-0x1*-0x2126,uuid_1['v4'])()['toUpperCas'+'e'](),_0x1f7c39={};_0x1f7c39['apikey']=_0x3001fd;const _0x30e95b=yield this[_0x5266a2(0x108)][_0x5266a2(0x141)][_0x5266a2(0x142)](_0x1f7c39,_0x3b2388['instanceNa'+'me']);if(_0x30e95b[_0x5266a2(0x13d)]){const _0x3ecbdf={};_0x3ecbdf[_0x5266a2(0x11d)]=AuthService[_0x5266a2(0x101)]+_0x5266a2(0x146),_0x3ecbdf['error']=_0x30e95b[_0x5266a2(0x13d)],this['logger'][_0x5266a2(0x13d)](_0x3ecbdf);throw new exceptions_1['BadRequest'+(_0x5266a2(0xfd))](_0x5266a2(0xf3)+_0x5266a2(0x12d),(_0x168adf=_0x30e95b[_0x5266a2(0x13d)])===null||_0x168adf===void(-0x903+-0x9a3*-0x1+-0x2*0x50)?void(-0x1c1f+0x921+0xbb*0x1a):_0x168adf[_0x5266a2(0x119)]());}const _0x4063bd={};return _0x4063bd['apikey']=_0x3001fd,_0x4063bd;});}['generateHa'+'sh'](_0xccfa9a){return __awaiter(this,void(-0xd02+-0x133*0xb+0x1a33),void(0x1*0x606+-0x57*0x25+0x68d),function*(){const _0x5220eb=a51_0x3d7b,_0x1edbb3=this[_0x5220eb(0x137)+_0x5220eb(0x149)][_0x5220eb(0x100)]('AUTHENTICA'+'TION');return yield this[_0x1edbb3[_0x5220eb(0x112)]](_0xccfa9a);});}[a51_0x356f62(0x13e)+'en']({oldToken:_0xbd08ad}){return __awaiter(this,void(0x25f*-0x1+-0x1fc9+-0x445*-0x8),void(-0x7*0xce+-0xfd4+0x1576),function*(){const _0x4ac1ae=a51_0x3d7b;if(!(0x1149+0x133e+-0x2487,class_validator_1[_0x4ac1ae(0x134)])(_0xbd08ad))throw new exceptions_1[(_0x4ac1ae(0x106))+(_0x4ac1ae(0xfd))](_0x4ac1ae(0x111)+_0x4ac1ae(0x118));try{const _0x135c46=this['configServ'+_0x4ac1ae(0x149)]['get']('AUTHENTICA'+_0x4ac1ae(0x11f))[_0x4ac1ae(0xff)],_0x4f3a2c={};_0x4f3a2c[_0x4ac1ae(0x12a)+_0x4ac1ae(0x117)]=!![];const _0x5ef14e=(0x3f8+0x1*-0xd8+0x64*-0x8,jsonwebtoken_1[_0x4ac1ae(0x124)])(_0xbd08ad,_0x135c46[_0x4ac1ae(0x11c)],_0x4f3a2c),_0x263c68=yield this[_0x4ac1ae(0x108)]['auth'][_0x4ac1ae(0x132)](_0x5ef14e[_0x4ac1ae(0xfa)+'me']),_0x409a13={};_0x409a13['ignoreExpi'+_0x4ac1ae(0x117)]=!![];const _0x4d6068=(0x260d+-0x6ab+-0x27*0xce,jsonwebtoken_1[_0x4ac1ae(0x124)])(_0x263c68[_0x4ac1ae(0x122)],_0x135c46[_0x4ac1ae(0x11c)],_0x409a13);if(_0x5ef14e[_0x4ac1ae(0x11e)]!==_0x4d6068[_0x4ac1ae(0x11e)])throw new exceptions_1['BadRequest'+(_0x4ac1ae(0xfd))](_0x4ac1ae(0x111)+_0x4ac1ae(0x118));const _0x518a90={};_0x518a90[_0x4ac1ae(0xfa)+'me']=_0x5ef14e[_0x4ac1ae(0xfa)+'me'];const _0x152e87={'jwt':(yield this[_0x4ac1ae(0x122)](_0x518a90))[_0x4ac1ae(0x122)],'instanceName':_0x5ef14e[_0x4ac1ae(0xfa)+'me']};try{const _0x557f73=yield this[_0x4ac1ae(0x108)][_0x4ac1ae(0x147)][_0x4ac1ae(0x132)](_0x5ef14e[_0x4ac1ae(0xfa)+'me']);if(_0x557f73[_0x4ac1ae(0x104)]&&this[_0x4ac1ae(0x137)+'ice'][_0x4ac1ae(0x100)](_0x4ac1ae(0xf6))[_0x4ac1ae(0x145)][_0x4ac1ae(0x133)+_0x4ac1ae(0x103)]){const _0x323a16={};_0x323a16[_0x4ac1ae(0x125)]=_0x557f73[_0x4ac1ae(0x140)];const _0x568e82=axios_1['default'][_0x4ac1ae(0x142)](_0x323a16),_0xdc910d={};_0xdc910d[_0x4ac1ae(0x13b)]=_0x4ac1ae(0x12e),_0xdc910d[_0x4ac1ae(0xf4)]=_0x5ef14e['instanceNa'+'me'],_0xdc910d[_0x4ac1ae(0x138)]=_0x152e87;const _0x531e08={};_0x531e08[_0x4ac1ae(0xf9)]=this['waMonitor'][_0x4ac1ae(0x10b)+'s'][_0x5ef14e[_0x4ac1ae(0xfa)+'me']][_0x4ac1ae(0x129)];const _0x1f9549={};_0x1f9549[_0x4ac1ae(0x139)]=_0x531e08,yield _0x568e82[_0x4ac1ae(0x13f)]('',_0xdc910d,_0x1f9549);}}catch(_0x923a99){this[_0x4ac1ae(0x128)][_0x4ac1ae(0x13d)](_0x923a99);}return _0x152e87;}catch(_0x52fba2){const _0x1c9cfd={};_0x1c9cfd[_0x4ac1ae(0x11d)]=AuthService[_0x4ac1ae(0x101)]+(_0x4ac1ae(0xf7)+'ken'),_0x1c9cfd[_0x4ac1ae(0x13d)]=_0x52fba2,this[_0x4ac1ae(0x128)][_0x4ac1ae(0x13d)](_0x1c9cfd);throw new exceptions_1[(_0x4ac1ae(0x106))+(_0x4ac1ae(0xfd))](_0x4ac1ae(0x111)+'ldToken\x22');}});}}exports[a51_0x356f62(0x10d)+'e']=AuthService;