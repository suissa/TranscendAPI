'use strict';const a52_0x15453f=a52_0x598b;(function(_0xa66689,_0xf4b808){const _0x21271e=a52_0x598b,_0xbdf5c9=_0xa66689();while(!![]){try{const _0x354667=parseInt(_0x21271e(0x11e))/(-0x1*0x1b61+-0x250b+-0x406d*-0x1)*(-parseInt(_0x21271e(0x130))/(0x6*-0x3f7+0x749*-0x3+0x2da7))+parseInt(_0x21271e(0x107))/(-0x125*0x1+0x201+0xd9*-0x1)+-parseInt(_0x21271e(0x146))/(-0x4*0x211+0x2592+-0x1d4a)*(-parseInt(_0x21271e(0x110))/(0x153b*0x1+0x109d*-0x2+-0x602*-0x2))+-parseInt(_0x21271e(0x143))/(0x1*-0x1b65+-0x9ad*0x1+-0x128c*-0x2)*(-parseInt(_0x21271e(0x11d))/(-0x8b*0x13+-0x926+0x137e))+-parseInt(_0x21271e(0x140))/(-0x4*0x695+-0x10*-0x8+0x19dc)*(parseInt(_0x21271e(0x11f))/(-0xc11*-0x1+-0x6d*-0x4f+-0x2dab))+-parseInt(_0x21271e(0x11a))/(-0x1237+-0x1a36+-0x1*-0x2c77)+-parseInt(_0x21271e(0x149))/(0x2a*-0xe3+0x16de+0xe6b);if(_0x354667===_0xf4b808)break;else _0xbdf5c9['push'](_0xbdf5c9['shift']());}catch(_0x2a3ddb){_0xbdf5c9['push'](_0xbdf5c9['shift']());}}}(a52_0x1b9e,-0x3*-0x2178f+-0x5db4e+0x3bf3b));function a52_0x1b9e(){const _0xa2657e=['ignoreExpi','SECRET','fault','BadRequest','toString','10LshYSo','utf8','EVENTS','TYPE','auth','wuid','name','Exception','throw','generateHa','1642770OCvbXb','tokenId','config','7JWDSjx','14334tIBxLJ','45aauySj','jsonwebtok','repository','get','.refreshTo','AuthServic','../../exce','configServ','find','EXPIRIN_IN','create','post','class-vali','ration','baseURL','waMonitor','tion\x20error','14qOLUrU','next','ice','NEW_JWT_TO','__esModule','params','ig/logger.','jwt','defineProp','event','../../../p','WEBHOOK','g-t','value','OldToken','ken','238776QOsFOI','AUTHENTICA','apikey','2216010CAbfjb','instanceNa','error','922648ufnUUa','erty','isJWT','5350213vmZoNC','sign','JWT','verify','logger','TION','.jwt','ldToken\x22','../../conf','ackage.jso','Authentica','dator','enabled','1027872AHRLPJ','url','webhook','waInstance'];a52_0x1b9e=function(){return _0xa2657e;};return a52_0x1b9e();}var __awaiter=this&&this['__awaiter']||function(_0x1eb2a0,_0x239cf9,_0x30cceb,_0x3be344){function _0x237007(_0x3abd56){return _0x3abd56 instanceof _0x30cceb?_0x3abd56:new _0x30cceb(function(_0x5daf7b){_0x5daf7b(_0x3abd56);});}return new(_0x30cceb||(_0x30cceb=Promise))(function(_0x4ac7c9,_0x6d963d){const _0x447c5b=a52_0x598b;function _0x4c926e(_0x3e7b78){const _0x2c4b60=a52_0x598b;try{_0x57c401(_0x3be344[_0x2c4b60(0x131)](_0x3e7b78));}catch(_0x327c56){_0x6d963d(_0x327c56);}}function _0x35a95d(_0xce89ba){const _0x161c2b=a52_0x598b;try{_0x57c401(_0x3be344[_0x161c2b(0x118)](_0xce89ba));}catch(_0x564b32){_0x6d963d(_0x564b32);}}function _0x57c401(_0x5801e3){const _0x452318=a52_0x598b;_0x5801e3['done']?_0x4ac7c9(_0x5801e3[_0x452318(0x13d)]):_0x237007(_0x5801e3[_0x452318(0x13d)])['then'](_0x4c926e,_0x35a95d);}_0x57c401((_0x3be344=_0x3be344['apply'](_0x1eb2a0,_0x239cf9||[]))[_0x447c5b(0x131)]());});},__importDefault=this&&this['__importDe'+a52_0x15453f(0x10d)]||function(_0x58f283){const _0x3476c8=a52_0x15453f;return _0x58f283&&_0x58f283[_0x3476c8(0x134)]?_0x58f283:{'default':_0x58f283};};const a52_0xc9a6c9={};a52_0xc9a6c9[a52_0x15453f(0x13d)]=!![],Object[a52_0x15453f(0x138)+a52_0x15453f(0x147)](exports,a52_0x15453f(0x134),a52_0xc9a6c9),exports['AuthServic'+'e']=exports['OldToken']=void(-0x1*0x54e+-0xa92+0xfe0);const package_json_1=require(a52_0x15453f(0x13a)+a52_0x15453f(0x103)+'n'),jsonwebtoken_1=require(a52_0x15453f(0x120)+'en'),logger_config_1=require(a52_0x15453f(0x102)+a52_0x15453f(0x136)+a52_0x15453f(0x11c)),uuid_1=require('uuid'),class_validator_1=require(a52_0x15453f(0x12b)+a52_0x15453f(0x105)),exceptions_1=require(a52_0x15453f(0x125)+'ptions'),axios_1=__importDefault(require('axios'));function a52_0x598b(_0x5c644e,_0xfb2956){const _0x40c1ec=a52_0x1b9e();return a52_0x598b=function(_0x31157e,_0xc9a6c9){_0x31157e=_0x31157e-(-0x1b1d+-0xb61*0x3+0x3e3e);let _0x29374d=_0x40c1ec[_0x31157e];return _0x29374d;},a52_0x598b(_0x5c644e,_0xfb2956);}class OldToken{}exports[a52_0x15453f(0x13e)]=OldToken;class AuthService{constructor(_0x4a111e,_0x60f989,_0x310b00){const _0x5aa1f0=a52_0x15453f;this[_0x5aa1f0(0x126)+'ice']=_0x4a111e,this[_0x5aa1f0(0x12e)]=_0x60f989,this[_0x5aa1f0(0x121)]=_0x310b00,this[_0x5aa1f0(0xfe)]=new logger_config_1['Logger'](AuthService[_0x5aa1f0(0x116)]);}[a52_0x15453f(0x137)](_0x94ee03){var _0x416fa1;return __awaiter(this,void(0x1*-0xd3+0xd8f+-0xcbc),void(-0x3ae*0x3+0x16bd+-0xbb3),function*(){const _0xf9d83=a52_0x598b,_0x555a1d=this[_0xf9d83(0x126)+'ice']['get']('AUTHENTICA'+_0xf9d83(0xff))['JWT'],_0x2ee0bd=(0x22d7+0xa15+-0x2cec,jsonwebtoken_1[_0xf9d83(0x14a)])({'instanceName':_0x94ee03[_0xf9d83(0x144)+'me'],'apiName':package_json_1[_0xf9d83(0x116)],'tokenId':(0x1*0x657+0x1a94+-0x35*0x9f,uuid_1['v4'])()},_0x555a1d[_0xf9d83(0x10c)],{'expiresIn':_0x555a1d[_0xf9d83(0x128)],'encoding':_0xf9d83(0x111),'subject':_0xf9d83(0x13c)}),_0x3b7ebc={};_0x3b7ebc[_0xf9d83(0x137)]=_0x2ee0bd;const _0x315ed6=yield this[_0xf9d83(0x121)][_0xf9d83(0x114)][_0xf9d83(0x129)](_0x3b7ebc,_0x94ee03[_0xf9d83(0x144)+'me']);if(_0x315ed6[_0xf9d83(0x145)]){const _0x58aae5={};_0x58aae5['localError']=AuthService['name']+_0xf9d83(0x100),_0x58aae5[_0xf9d83(0x145)]=_0x315ed6['error'],this[_0xf9d83(0xfe)][_0xf9d83(0x145)](_0x58aae5);throw new exceptions_1['BadRequest'+(_0xf9d83(0x117))](_0xf9d83(0x104)+_0xf9d83(0x12f),(_0x416fa1=_0x315ed6['error'])===null||_0x416fa1===void(0x18bf+0x23a0+-0x3c5f)?void(-0x2172+0x4*0x355+0x141e):_0x416fa1[_0xf9d83(0x10f)]());}const _0x5eb2af={};return _0x5eb2af['jwt']=_0x2ee0bd,_0x5eb2af;});}[a52_0x15453f(0x142)](_0x597c99){var _0x25033b;return __awaiter(this,void(0x13*0x1f+-0x12*-0x123+0x16c3*-0x1),void(0x4a7+-0x1f85*-0x1+0x90b*-0x4),function*(){const _0x13eca2=a52_0x598b,_0x2f7e60=(0x1b54+0x1*-0x1ee3+0x38f,uuid_1['v4'])()['toUpperCas'+'e'](),_0x425a4b={};_0x425a4b[_0x13eca2(0x142)]=_0x2f7e60;const _0x2990d5=yield this[_0x13eca2(0x121)][_0x13eca2(0x114)][_0x13eca2(0x129)](_0x425a4b,_0x597c99[_0x13eca2(0x144)+'me']);if(_0x2990d5[_0x13eca2(0x145)]){const _0x423c03={};_0x423c03['localError']=AuthService[_0x13eca2(0x116)]+'.jwt',_0x423c03[_0x13eca2(0x145)]=_0x2990d5[_0x13eca2(0x145)],this['logger'][_0x13eca2(0x145)](_0x423c03);throw new exceptions_1[(_0x13eca2(0x10e))+(_0x13eca2(0x117))]('Authentica'+'tion\x20error',(_0x25033b=_0x2990d5[_0x13eca2(0x145)])===null||_0x25033b===void(-0x1c3+0x206e+-0x1eab*0x1)?void(0x1fdc+-0x934+0xc8*-0x1d):_0x25033b[_0x13eca2(0x10f)]());}const _0x6d8de6={};return _0x6d8de6[_0x13eca2(0x142)]=_0x2f7e60,_0x6d8de6;});}[a52_0x15453f(0x119)+'sh'](_0x24d57f){return __awaiter(this,void(-0x1600+-0x9f+0x169f),void(-0x17a6*-0x1+0x358+-0x1afe),function*(){const _0xfd2197=a52_0x598b,_0x58d0be=this[_0xfd2197(0x126)+_0xfd2197(0x132)][_0xfd2197(0x122)](_0xfd2197(0x141)+_0xfd2197(0xff));return yield this[_0x58d0be[_0xfd2197(0x113)]](_0x24d57f);});}['refreshTok'+'en']({oldToken:_0x547389}){return __awaiter(this,void(0x13ac+0x1ca6+-0x9aa*0x5),void(-0x7*-0x205+0x1*0x180f+-0x1*0x2632),function*(){const _0x205295=a52_0x598b;if(!(0x20bc+-0x3*0x529+0x1*-0x1141,class_validator_1[_0x205295(0x148)])(_0x547389))throw new exceptions_1[(_0x205295(0x10e))+(_0x205295(0x117))]('Invalid\x20\x22o'+'ldToken\x22');try{const _0x65dc4c=this[_0x205295(0x126)+_0x205295(0x132)][_0x205295(0x122)](_0x205295(0x141)+_0x205295(0xff))[_0x205295(0x14b)],_0x224027={};_0x224027[_0x205295(0x10b)+_0x205295(0x12c)]=!![];const _0x1602d8=(-0x199*0x3+0x9a7+-0x4dc,jsonwebtoken_1[_0x205295(0x14c)])(_0x547389,_0x65dc4c['SECRET'],_0x224027),_0x2a3ba9=yield this[_0x205295(0x121)]['auth'][_0x205295(0x127)](_0x1602d8[_0x205295(0x144)+'me']),_0x5e6f08={};_0x5e6f08[_0x205295(0x10b)+'ration']=!![];const _0x307621=(-0x2ee+0xafb*0x2+0xa8*-0x1d,jsonwebtoken_1[_0x205295(0x14c)])(_0x2a3ba9[_0x205295(0x137)],_0x65dc4c[_0x205295(0x10c)],_0x5e6f08);if(_0x1602d8[_0x205295(0x11b)]!==_0x307621[_0x205295(0x11b)])throw new exceptions_1[(_0x205295(0x10e))+(_0x205295(0x117))]('Invalid\x20\x22o'+_0x205295(0x101));const _0x44cf38={};_0x44cf38[_0x205295(0x144)+'me']=_0x1602d8[_0x205295(0x144)+'me'];const _0x9e4cd4={'jwt':(yield this[_0x205295(0x137)](_0x44cf38))[_0x205295(0x137)],'instanceName':_0x1602d8[_0x205295(0x144)+'me']};try{const _0x326747=yield this[_0x205295(0x121)][_0x205295(0x109)][_0x205295(0x127)](_0x1602d8[_0x205295(0x144)+'me']);if(_0x326747[_0x205295(0x106)]&&this[_0x205295(0x126)+_0x205295(0x132)][_0x205295(0x122)](_0x205295(0x13b))[_0x205295(0x112)][_0x205295(0x133)+'KEN']){const _0x2bce20={};_0x2bce20[_0x205295(0x12d)]=_0x326747[_0x205295(0x108)];const _0x59dc73=axios_1['default']['create'](_0x2bce20),_0x48a919={};_0x48a919[_0x205295(0x139)]='new.jwt',_0x48a919['instance']=_0x1602d8[_0x205295(0x144)+'me'],_0x48a919['data']=_0x9e4cd4;const _0x1c49e9={};_0x1c49e9['owner']=this[_0x205295(0x12e)][_0x205295(0x10a)+'s'][_0x1602d8['instanceNa'+'me']][_0x205295(0x115)];const _0x2c5477={};_0x2c5477[_0x205295(0x135)]=_0x1c49e9,yield _0x59dc73[_0x205295(0x12a)]('',_0x48a919,_0x2c5477);}}catch(_0x52d0d9){this[_0x205295(0xfe)][_0x205295(0x145)](_0x52d0d9);}return _0x9e4cd4;}catch(_0x1417d2){const _0x5dd3cf={};_0x5dd3cf['localError']=AuthService[_0x205295(0x116)]+(_0x205295(0x123)+_0x205295(0x13f)),_0x5dd3cf['error']=_0x1417d2,this[_0x205295(0xfe)][_0x205295(0x145)](_0x5dd3cf);throw new exceptions_1[(_0x205295(0x10e))+(_0x205295(0x117))]('Invalid\x20\x22o'+_0x205295(0x101));}});}}exports[a52_0x15453f(0x124)+'e']=AuthService;