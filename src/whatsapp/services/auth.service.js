'use strict';function a52_0x5e35(){const _0x1e3d13=['AuthServic','localError','sign','get','4280erSKqk','enabled','ration','12327jPjeWq','waInstance','baseURL','Logger','__esModule','JWT','6207575sOPhLc','name','value','toString','params','EXPIRIN_IN','KEN','owner','done','../../exce','instanceNa','auth','6hupQIP','wuid','ken','create','default','20pPAXFI','repository','error','waMonitor','webhook','axios','__importDe','ice','7393788KSudZX','fault','OldToken','url','325574IkrRUR','ignoreExpi','logger','1739032spJyHS','../../../p','then','.jwt','tion\x20error','jsonwebtok','Authentica','BadRequest','ldToken\x22','36Yhwmgp','class-vali','tokenId','WEBHOOK','post','jwt','3442977fAIXfN','next','config','AUTHENTICA','TION','utf8','apikey','SECRET','configServ','.refreshTo','apply','Invalid\x20\x22o','EVENTS','dator','event','instance','uuid','ackage.jso','877325PlckVq','verify','Exception','toUpperCas','5kdUQBI'];a52_0x5e35=function(){return _0x1e3d13;};return a52_0x5e35();}const a52_0x4b56e1=a52_0x27ae;(function(_0x36083c,_0x8f0182){const _0x11834f=a52_0x27ae,_0x39fba6=_0x36083c();while(!![]){try{const _0x239201=parseInt(_0x11834f(0x1c1))/(-0x26c1+0xfdf*-0x2+0x4680)+parseInt(_0x11834f(0x1f0))/(-0xabe+0x6*0x32a+-0x83c)*(-parseInt(_0x11834f(0x1df))/(-0x19*0x17b+0xe06+0x20*0xb8))+parseInt(_0x11834f(0x1f3))/(-0xe6d*0x1+-0x5c9*0x1+-0x6*-0x35f)+parseInt(_0x11834f(0x1c5))/(-0x270a*0x1+-0x1*0x2479+0x4b88)*(parseInt(_0x11834f(0x1ec))/(0x1eae+-0x9c5+-0x1*0x14e3))+parseInt(_0x11834f(0x1cd))/(-0x2582*-0x1+0x24d*0x4+-0x275*0x13)*(parseInt(_0x11834f(0x1ca))/(0x24*-0x17+-0x1*0xa93+0xdd7))+-parseInt(_0x11834f(0x1af))/(-0x22*-0x8f+-0xf8+0x133*-0xf)*(parseInt(_0x11834f(0x1e4))/(-0x1273+-0x1e7e+0x30fb))+-parseInt(_0x11834f(0x1d3))/(-0x12aa+0x1*-0x39f+0x1654)*(parseInt(_0x11834f(0x1fc))/(0x7dc+0xcbb*-0x3+0x1e61));if(_0x239201===_0x8f0182)break;else _0x39fba6['push'](_0x39fba6['shift']());}catch(_0x37e257){_0x39fba6['push'](_0x39fba6['shift']());}}}(a52_0x5e35,-0xb9a2+0x61*0x22a+0xaa145));function a52_0x27ae(_0x338aaf,_0x2dbde7){const _0x5acb64=a52_0x5e35();return a52_0x27ae=function(_0x5bc5e0,_0x37eaa6){_0x5bc5e0=_0x5bc5e0-(-0x1*-0x251d+-0x35*-0x48+0x5*-0xa12);let _0x102980=_0x5acb64[_0x5bc5e0];return _0x102980;},a52_0x27ae(_0x338aaf,_0x2dbde7);}var __awaiter=this&&this['__awaiter']||function(_0x3fdf71,_0x29f2c9,_0x3f47d6,_0x4a6e1f){function _0x31fd45(_0x5680ee){return _0x5680ee instanceof _0x3f47d6?_0x5680ee:new _0x3f47d6(function(_0x44a150){_0x44a150(_0x5680ee);});}return new(_0x3f47d6||(_0x3f47d6=Promise))(function(_0x189117,_0x4c0896){const _0x1360b2=a52_0x27ae;function _0x3a84c7(_0x41c9c8){const _0x469445=a52_0x27ae;try{_0x2ddc73(_0x4a6e1f[_0x469445(0x1b0)](_0x41c9c8));}catch(_0x5f2c40){_0x4c0896(_0x5f2c40);}}function _0x56dba0(_0x43aa75){try{_0x2ddc73(_0x4a6e1f['throw'](_0x43aa75));}catch(_0x1df5a3){_0x4c0896(_0x1df5a3);}}function _0x2ddc73(_0x297087){const _0x1f0a2e=a52_0x27ae;_0x297087[_0x1f0a2e(0x1db)]?_0x189117(_0x297087['value']):_0x31fd45(_0x297087[_0x1f0a2e(0x1d5)])[_0x1f0a2e(0x1f5)](_0x3a84c7,_0x56dba0);}_0x2ddc73((_0x4a6e1f=_0x4a6e1f[_0x1360b2(0x1b9)](_0x3fdf71,_0x29f2c9||[]))[_0x1360b2(0x1b0)]());});},__importDefault=this&&this[a52_0x4b56e1(0x1ea)+a52_0x4b56e1(0x1ed)]||function(_0x228ae0){const _0x316f1a=a52_0x4b56e1;return _0x228ae0&&_0x228ae0[_0x316f1a(0x1d1)]?_0x228ae0:{'default':_0x228ae0};};const a52_0x5acb64={};a52_0x5acb64[a52_0x4b56e1(0x1d5)]=!![],Object['defineProp'+'erty'](exports,a52_0x4b56e1(0x1d1),a52_0x5acb64),exports[a52_0x4b56e1(0x1c6)+'e']=exports[a52_0x4b56e1(0x1ee)]=void(0x241f+-0x12b*0x1f+0x16);const package_json_1=require(a52_0x4b56e1(0x1f4)+a52_0x4b56e1(0x1c0)+'n'),jsonwebtoken_1=require(a52_0x4b56e1(0x1f8)+'en'),logger_config_1=require('../../conf'+'ig/logger.'+a52_0x4b56e1(0x1b1)),uuid_1=require(a52_0x4b56e1(0x1bf)),class_validator_1=require(a52_0x4b56e1(0x1fd)+a52_0x4b56e1(0x1bc)),exceptions_1=require(a52_0x4b56e1(0x1dc)+'ptions'),axios_1=__importDefault(require(a52_0x4b56e1(0x1e9)));class OldToken{}exports['OldToken']=OldToken;class AuthService{constructor(_0x453225,_0x4537ce,_0x3a69ae){const _0x5ef313=a52_0x4b56e1;this[_0x5ef313(0x1b7)+_0x5ef313(0x1eb)]=_0x453225,this['waMonitor']=_0x4537ce,this['repository']=_0x3a69ae,this[_0x5ef313(0x1f2)]=new logger_config_1[(_0x5ef313(0x1d0))](AuthService[_0x5ef313(0x1d4)]);}['jwt'](_0x10f086){var _0x9f9cbe;return __awaiter(this,void(0x1*-0x1421+-0x2b4*-0x8+-0x17f),void(0x5d*0x5+-0x2177+-0x2*-0xfd3),function*(){const _0x157944=a52_0x27ae,_0x45d4f0=this[_0x157944(0x1b7)+'ice'][_0x157944(0x1c9)](_0x157944(0x1b2)+_0x157944(0x1b3))[_0x157944(0x1d2)],_0x3858d2=(0x124f+0x12e1*0x1+-0x253*0x10,jsonwebtoken_1[_0x157944(0x1c8)])({'instanceName':_0x10f086[_0x157944(0x1dd)+'me'],'apiName':package_json_1[_0x157944(0x1d4)],'tokenId':(-0x2bf*-0x5+-0x9*-0x327+-0x22*0x13d,uuid_1['v4'])()},_0x45d4f0['SECRET'],{'expiresIn':_0x45d4f0[_0x157944(0x1d8)],'encoding':_0x157944(0x1b4),'subject':'g-t'}),_0x4465bf={};_0x4465bf[_0x157944(0x1ae)]=_0x3858d2;const _0x2033d6=yield this[_0x157944(0x1e5)]['auth']['create'](_0x4465bf,_0x10f086['instanceNa'+'me']);if(_0x2033d6['error']){const _0x27afa1={};_0x27afa1[_0x157944(0x1c7)]=AuthService['name']+_0x157944(0x1f6),_0x27afa1['error']=_0x2033d6[_0x157944(0x1e6)],this[_0x157944(0x1f2)][_0x157944(0x1e6)](_0x27afa1);throw new exceptions_1[(_0x157944(0x1fa))+(_0x157944(0x1c3))](_0x157944(0x1f9)+'tion\x20error',(_0x9f9cbe=_0x2033d6[_0x157944(0x1e6)])===null||_0x9f9cbe===void(-0x58*0x12+-0x2f*-0x59+0xa27*-0x1)?void(-0x53*0x34+0x55d*-0x7+0x3667):_0x9f9cbe[_0x157944(0x1d6)]());}const _0x29c65c={};return _0x29c65c[_0x157944(0x1ae)]=_0x3858d2,_0x29c65c;});}[a52_0x4b56e1(0x1b5)](_0x53e48f){var _0x5bcc3b;return __awaiter(this,void(0x148*0xd+-0x4ae*-0x5+-0x2*0x1407),void(0x392*-0x7+0x2b2+0x1*0x164c),function*(){const _0x17689a=a52_0x27ae,_0x816c0b=(-0xe26+-0x7*-0x35+0xcb3*0x1,uuid_1['v4'])()[_0x17689a(0x1c4)+'e'](),_0x2bbf3b={};_0x2bbf3b[_0x17689a(0x1b5)]=_0x816c0b;const _0xc552f3=yield this[_0x17689a(0x1e5)][_0x17689a(0x1de)]['create'](_0x2bbf3b,_0x53e48f['instanceNa'+'me']);if(_0xc552f3['error']){const _0x1bbbf7={};_0x1bbbf7[_0x17689a(0x1c7)]=AuthService['name']+_0x17689a(0x1f6),_0x1bbbf7[_0x17689a(0x1e6)]=_0xc552f3[_0x17689a(0x1e6)],this[_0x17689a(0x1f2)][_0x17689a(0x1e6)](_0x1bbbf7);throw new exceptions_1[(_0x17689a(0x1fa))+(_0x17689a(0x1c3))](_0x17689a(0x1f9)+_0x17689a(0x1f7),(_0x5bcc3b=_0xc552f3[_0x17689a(0x1e6)])===null||_0x5bcc3b===void(-0xd*0x15b+0x137*0x9+0x6b0)?void(0x4*0xa4+-0x2386+0x20f6):_0x5bcc3b[_0x17689a(0x1d6)]());}const _0x4dd6ee={};return _0x4dd6ee[_0x17689a(0x1b5)]=_0x816c0b,_0x4dd6ee;});}['generateHa'+'sh'](_0x1a31b4){return __awaiter(this,void(-0x1*0x17e7+-0xee4+0x26cb),void(-0xde5+0x1985+-0x2e8*0x4),function*(){const _0x587f90=a52_0x27ae,_0x1642d8=this[_0x587f90(0x1b7)+'ice'][_0x587f90(0x1c9)](_0x587f90(0x1b2)+'TION');return yield this[_0x1642d8['TYPE']](_0x1a31b4);});}['refreshTok'+'en']({oldToken:_0x109cb0}){return __awaiter(this,void(-0x372+0xa31+-0x9d*0xb),void(-0x34*-0x65+0x22ce+0x2*-0x1ba9),function*(){const _0x387cc1=a52_0x27ae;if(!(-0x12a7+0x17ce+-0x527*0x1,class_validator_1['isJWT'])(_0x109cb0))throw new exceptions_1[(_0x387cc1(0x1fa))+(_0x387cc1(0x1c3))](_0x387cc1(0x1ba)+_0x387cc1(0x1fb));try{const _0x18f0df=this[_0x387cc1(0x1b7)+_0x387cc1(0x1eb)][_0x387cc1(0x1c9)](_0x387cc1(0x1b2)+_0x387cc1(0x1b3))[_0x387cc1(0x1d2)],_0x114dd4={};_0x114dd4[_0x387cc1(0x1f1)+_0x387cc1(0x1cc)]=!![];const _0x1527fb=(0x1df3*0x1+-0x1a08+0x3eb*-0x1,jsonwebtoken_1[_0x387cc1(0x1c2)])(_0x109cb0,_0x18f0df[_0x387cc1(0x1b6)],_0x114dd4),_0x14e424=yield this[_0x387cc1(0x1e5)][_0x387cc1(0x1de)]['find'](_0x1527fb['instanceNa'+'me']),_0x4909d1={};_0x4909d1[_0x387cc1(0x1f1)+'ration']=!![];const _0x2360a1=(0x69a+-0x243e+-0x1c*-0x10f,jsonwebtoken_1[_0x387cc1(0x1c2)])(_0x14e424['jwt'],_0x18f0df[_0x387cc1(0x1b6)],_0x4909d1);if(_0x1527fb['tokenId']!==_0x2360a1[_0x387cc1(0x1ab)])throw new exceptions_1[(_0x387cc1(0x1fa))+(_0x387cc1(0x1c3))](_0x387cc1(0x1ba)+_0x387cc1(0x1fb));const _0x1a04a6={};_0x1a04a6[_0x387cc1(0x1dd)+'me']=_0x1527fb[_0x387cc1(0x1dd)+'me'];const _0x4579a8={'jwt':(yield this[_0x387cc1(0x1ae)](_0x1a04a6))[_0x387cc1(0x1ae)],'instanceName':_0x1527fb[_0x387cc1(0x1dd)+'me']};try{const _0x1147fa=yield this[_0x387cc1(0x1e5)][_0x387cc1(0x1e8)]['find'](_0x1527fb[_0x387cc1(0x1dd)+'me']);if(_0x1147fa[_0x387cc1(0x1cb)]&&this[_0x387cc1(0x1b7)+'ice'][_0x387cc1(0x1c9)](_0x387cc1(0x1ac))[_0x387cc1(0x1bb)]['NEW_JWT_TO'+_0x387cc1(0x1d9)]){const _0x5f593f={};_0x5f593f[_0x387cc1(0x1cf)]=_0x1147fa[_0x387cc1(0x1ef)];const _0x2df3a2=axios_1[_0x387cc1(0x1e3)][_0x387cc1(0x1e2)](_0x5f593f),_0x21a6fe={};_0x21a6fe[_0x387cc1(0x1bd)]='new.jwt',_0x21a6fe[_0x387cc1(0x1be)]=_0x1527fb[_0x387cc1(0x1dd)+'me'],_0x21a6fe['data']=_0x4579a8;const _0x27db4a={};_0x27db4a[_0x387cc1(0x1da)]=this[_0x387cc1(0x1e7)][_0x387cc1(0x1ce)+'s'][_0x1527fb[_0x387cc1(0x1dd)+'me']][_0x387cc1(0x1e0)];const _0x7fb0e2={};_0x7fb0e2[_0x387cc1(0x1d7)]=_0x27db4a,yield _0x2df3a2[_0x387cc1(0x1ad)]('',_0x21a6fe,_0x7fb0e2);}}catch(_0x94dfe8){this[_0x387cc1(0x1f2)][_0x387cc1(0x1e6)](_0x94dfe8);}return _0x4579a8;}catch(_0x3793c3){const _0x4ce54d={};_0x4ce54d[_0x387cc1(0x1c7)]=AuthService[_0x387cc1(0x1d4)]+(_0x387cc1(0x1b8)+_0x387cc1(0x1e1)),_0x4ce54d['error']=_0x3793c3,this[_0x387cc1(0x1f2)][_0x387cc1(0x1e6)](_0x4ce54d);throw new exceptions_1[(_0x387cc1(0x1fa))+(_0x387cc1(0x1c3))](_0x387cc1(0x1ba)+_0x387cc1(0x1fb));}});}}exports['AuthServic'+'e']=AuthService;