'use strict';const a52_0x1b22b8=a52_0x36ba;(function(_0x38540a,_0x54012e){const _0x262e47=a52_0x36ba,_0x56bfc9=_0x38540a();while(!![]){try{const _0x494e22=-parseInt(_0x262e47(0xec))/(-0x1f52+-0x21b6+0x4109*0x1)+parseInt(_0x262e47(0xef))/(-0x1118+0x1*-0x130+0x124a)+-parseInt(_0x262e47(0xfb))/(-0x105*0x7+0x144f+-0xd29)*(-parseInt(_0x262e47(0xee))/(0x10b2+0x9*0x7f+0x1*-0x1525))+-parseInt(_0x262e47(0xfa))/(0x1*-0x2383+0x1249*0x1+-0x113f*-0x1)*(-parseInt(_0x262e47(0x101))/(0xba4+0x7f*-0x27+0x7bb))+-parseInt(_0x262e47(0x12a))/(-0x3*0x6bc+0x1*-0x253f+0x397a)*(-parseInt(_0x262e47(0x126))/(-0x1eb8+0x8*0x17a+-0x650*-0x3))+-parseInt(_0x262e47(0x127))/(-0x17b8+0x10c4+0x1*0x6fd)*(-parseInt(_0x262e47(0x112))/(0x32+0x2327*-0x1+0x22ff))+-parseInt(_0x262e47(0xd8))/(0x575*-0x1+-0x745*0x1+0xcc5);if(_0x494e22===_0x54012e)break;else _0x56bfc9['push'](_0x56bfc9['shift']());}catch(_0x51140e){_0x56bfc9['push'](_0x56bfc9['shift']());}}}(a52_0x1b21,0x173056+-0x145184+0xa3c44));function a52_0x1b21(){const _0x589225=['__awaiter','toString','50fDmzTF','1067553qrqqAo','ignoreExpi','axios','JWT','refreshTok','done','325200mmCCyz','verify','event','throw','KEN','ration','__esModule','repository','configServ','AuthServic','generateHa','name','instanceNa','ptions','EXPIRIN_IN','waMonitor','value','13333410JEwZMf','localError','utf8','TION','error','apply','config','SECRET','.jwt','../../exce','g-t','AUTHENTICA','ackage.jso','Invalid\x20\x22o','then','owner','logger','jsonwebtok','.refreshTo','create','427808WCWSoZ','9wkkTNm','tokenId','Logger','49cKwWRI','../../conf','wuid','../../../p','28368175kYWAFW','Exception','isJWT','BadRequest','new.jwt','ken','NEW_JWT_TO','auth','sign','ice','webhook','get','find','apikey','url','OldToken','baseURL','tion\x20error','ig/logger.','jwt','949547BUpqmo','defineProp','12YJqFkv','2140296hgiWJt','uuid','Authentica','ldToken\x22','__importDe','class-vali','instance','waInstance','data'];a52_0x1b21=function(){return _0x589225;};return a52_0x1b21();}var __awaiter=this&&this[a52_0x1b22b8(0xf8)]||function(_0x1e1e7b,_0x1c03df,_0x486bcf,_0x5d02bb){function _0x2b7f2b(_0x48aecc){return _0x48aecc instanceof _0x486bcf?_0x48aecc:new _0x486bcf(function(_0x404bce){_0x404bce(_0x48aecc);});}return new(_0x486bcf||(_0x486bcf=Promise))(function(_0x1245ad,_0x30d0db){const _0x315538=a52_0x36ba;function _0x35e8b0(_0x853d64){try{_0x56ff0f(_0x5d02bb['next'](_0x853d64));}catch(_0x1ff7b6){_0x30d0db(_0x1ff7b6);}}function _0x5e7257(_0x2f610f){const _0x2932ba=a52_0x36ba;try{_0x56ff0f(_0x5d02bb[_0x2932ba(0x104)](_0x2f610f));}catch(_0x351f88){_0x30d0db(_0x351f88);}}function _0x56ff0f(_0x256e77){const _0x18b3f8=a52_0x36ba;_0x256e77[_0x18b3f8(0x100)]?_0x1245ad(_0x256e77[_0x18b3f8(0x111)]):_0x2b7f2b(_0x256e77[_0x18b3f8(0x111)])[_0x18b3f8(0x120)](_0x35e8b0,_0x5e7257);}_0x56ff0f((_0x5d02bb=_0x5d02bb[_0x315538(0x117)](_0x1e1e7b,_0x1c03df||[]))['next']());});},__importDefault=this&&this[a52_0x1b22b8(0xf3)+'fault']||function(_0x3347c0){const _0x2d3ca8=a52_0x1b22b8;return _0x3347c0&&_0x3347c0[_0x2d3ca8(0x107)]?_0x3347c0:{'default':_0x3347c0};};function a52_0x36ba(_0x5ef76e,_0x32a208){const _0x350292=a52_0x1b21();return a52_0x36ba=function(_0x210aa3,_0x241941){_0x210aa3=_0x210aa3-(0xda5+-0x1*-0x12df+-0x1fae);let _0x4c9958=_0x350292[_0x210aa3];return _0x4c9958;},a52_0x36ba(_0x5ef76e,_0x32a208);}const a52_0x241941={};a52_0x241941[a52_0x1b22b8(0x111)]=!![],Object[a52_0x1b22b8(0xed)+'erty'](exports,'__esModule',a52_0x241941),exports['AuthServic'+'e']=exports[a52_0x1b22b8(0xe7)]=void(0x17b0*0x1+0x1633+-0x2de3*0x1);const package_json_1=require(a52_0x1b22b8(0xd7)+a52_0x1b22b8(0x11e)+'n'),jsonwebtoken_1=require(a52_0x1b22b8(0x123)+'en'),logger_config_1=require(a52_0x1b22b8(0x12b)+a52_0x1b22b8(0xea)+a52_0x1b22b8(0x118)),uuid_1=require(a52_0x1b22b8(0xf0)),class_validator_1=require(a52_0x1b22b8(0xf4)+'dator'),exceptions_1=require(a52_0x1b22b8(0x11b)+a52_0x1b22b8(0x10e)),axios_1=__importDefault(require(a52_0x1b22b8(0xfd)));class OldToken{}exports[a52_0x1b22b8(0xe7)]=OldToken;class AuthService{constructor(_0x100748,_0x453ceb,_0x2f1b00){const _0x57ae50=a52_0x1b22b8;this[_0x57ae50(0x109)+_0x57ae50(0xe1)]=_0x100748,this[_0x57ae50(0x110)]=_0x453ceb,this[_0x57ae50(0x108)]=_0x2f1b00,this[_0x57ae50(0x122)]=new logger_config_1[(_0x57ae50(0x129))](AuthService[_0x57ae50(0x10c)]);}[a52_0x1b22b8(0xeb)](_0x498067){var _0x279f40;return __awaiter(this,void(0x771+0x539*0x2+-0x11e3),void(0x7c2*0x5+-0x1823+0x1f*-0x79),function*(){const _0x4013be=a52_0x36ba,_0x578aaf=this[_0x4013be(0x109)+_0x4013be(0xe1)][_0x4013be(0xe3)](_0x4013be(0x11d)+_0x4013be(0x115))[_0x4013be(0xfe)],_0x49c626=(0x257c+-0x1*0xa0f+-0x1b6d,jsonwebtoken_1[_0x4013be(0xe0)])({'instanceName':_0x498067[_0x4013be(0x10d)+'me'],'apiName':package_json_1[_0x4013be(0x10c)],'tokenId':(-0x110*0x22+0x886+0x1b9a,uuid_1['v4'])()},_0x578aaf[_0x4013be(0x119)],{'expiresIn':_0x578aaf[_0x4013be(0x10f)],'encoding':_0x4013be(0x114),'subject':_0x4013be(0x11c)}),_0xeb0b65={};_0xeb0b65[_0x4013be(0xeb)]=_0x49c626;const _0x598541=yield this['repository'][_0x4013be(0xdf)][_0x4013be(0x125)](_0xeb0b65,_0x498067['instanceNa'+'me']);if(_0x598541[_0x4013be(0x116)]){const _0x5191a5={};_0x5191a5[_0x4013be(0x113)]=AuthService[_0x4013be(0x10c)]+_0x4013be(0x11a),_0x5191a5[_0x4013be(0x116)]=_0x598541[_0x4013be(0x116)],this[_0x4013be(0x122)][_0x4013be(0x116)](_0x5191a5);throw new exceptions_1[(_0x4013be(0xdb))+'Exception'](_0x4013be(0xf1)+_0x4013be(0xe9),(_0x279f40=_0x598541['error'])===null||_0x279f40===void(0x11b*-0x2+0x992+-0x75c)?void(0x16d7+-0x1*-0x13f1+-0x2ac8):_0x279f40[_0x4013be(0xf9)]());}const _0x19f3fa={};return _0x19f3fa[_0x4013be(0xeb)]=_0x49c626,_0x19f3fa;});}[a52_0x1b22b8(0xe5)](_0x5f149d){var _0x552a86;return __awaiter(this,void(0x4*0x73c+-0x2*0x263+-0x407*0x6),void(-0x2b7*0x5+-0x20*0x22+0x11d3),function*(){const _0x3f1f08=a52_0x36ba,_0x20800f=(0x11f*0x13+0x1813+-0x2d60,uuid_1['v4'])()['toUpperCas'+'e'](),_0x4aebe8={};_0x4aebe8[_0x3f1f08(0xe5)]=_0x20800f;const _0x1a72c2=yield this['repository'][_0x3f1f08(0xdf)]['create'](_0x4aebe8,_0x5f149d[_0x3f1f08(0x10d)+'me']);if(_0x1a72c2[_0x3f1f08(0x116)]){const _0x1ff00b={};_0x1ff00b[_0x3f1f08(0x113)]=AuthService[_0x3f1f08(0x10c)]+_0x3f1f08(0x11a),_0x1ff00b[_0x3f1f08(0x116)]=_0x1a72c2['error'],this[_0x3f1f08(0x122)][_0x3f1f08(0x116)](_0x1ff00b);throw new exceptions_1[(_0x3f1f08(0xdb))+(_0x3f1f08(0xd9))](_0x3f1f08(0xf1)+_0x3f1f08(0xe9),(_0x552a86=_0x1a72c2['error'])===null||_0x552a86===void(-0x1*-0x1e42+-0x41e*-0x5+-0x32d8*0x1)?void(-0x3d2*0x9+0x7*0x3eb+0x6f5):_0x552a86['toString']());}const _0x22c03b={};return _0x22c03b[_0x3f1f08(0xe5)]=_0x20800f,_0x22c03b;});}[a52_0x1b22b8(0x10b)+'sh'](_0x4afd01){return __awaiter(this,void(-0x2108+-0x1f1e+0x4026),void(-0x1cfd*0x1+-0x2*-0x623+-0x185*-0xb),function*(){const _0x58ff68=a52_0x36ba,_0xbb8dcc=this[_0x58ff68(0x109)+_0x58ff68(0xe1)][_0x58ff68(0xe3)](_0x58ff68(0x11d)+_0x58ff68(0x115));return yield this[_0xbb8dcc['TYPE']](_0x4afd01);});}[a52_0x1b22b8(0xff)+'en']({oldToken:_0x2017f5}){return __awaiter(this,void(-0x1*-0x1de5+0x1f*-0x65+-0x85*0x22),void(0x118c+-0x3*0x679+0x1df),function*(){const _0x502545=a52_0x36ba;if(!(-0x1*-0x1b32+0x94*0x3b+0x85*-0x76,class_validator_1[_0x502545(0xda)])(_0x2017f5))throw new exceptions_1['BadRequest'+'Exception'](_0x502545(0x11f)+_0x502545(0xf2));try{const _0x3b4f4f=this[_0x502545(0x109)+_0x502545(0xe1)][_0x502545(0xe3)](_0x502545(0x11d)+_0x502545(0x115))[_0x502545(0xfe)],_0x2e0d97={};_0x2e0d97[_0x502545(0xfc)+_0x502545(0x106)]=!![];const _0x25d9f9=(-0x78b*0x2+-0x917+0x182d,jsonwebtoken_1[_0x502545(0x102)])(_0x2017f5,_0x3b4f4f[_0x502545(0x119)],_0x2e0d97),_0x431e9e=yield this['repository']['auth']['find'](_0x25d9f9['instanceNa'+'me']),_0x13658b={};_0x13658b[_0x502545(0xfc)+_0x502545(0x106)]=!![];const _0x198e27=(0x1201+0x1*-0x20ee+0xeed,jsonwebtoken_1[_0x502545(0x102)])(_0x431e9e['jwt'],_0x3b4f4f[_0x502545(0x119)],_0x13658b);if(_0x25d9f9['tokenId']!==_0x198e27[_0x502545(0x128)])throw new exceptions_1[(_0x502545(0xdb))+(_0x502545(0xd9))](_0x502545(0x11f)+_0x502545(0xf2));const _0x1bf574={};_0x1bf574['instanceNa'+'me']=_0x25d9f9[_0x502545(0x10d)+'me'];const _0x7e1d17={'jwt':(yield this[_0x502545(0xeb)](_0x1bf574))[_0x502545(0xeb)],'instanceName':_0x25d9f9['instanceNa'+'me']};try{const _0x2335f6=yield this[_0x502545(0x108)][_0x502545(0xe2)][_0x502545(0xe4)](_0x25d9f9['instanceNa'+'me']);if((_0x2335f6===null||_0x2335f6===void(0x2195+-0x1*-0x1963+-0x3af8)?void(0x23d2+0x1*-0x1a17+-0x1*0x9bb):_0x2335f6['enabled'])&&this[_0x502545(0x109)+_0x502545(0xe1)]['get']('WEBHOOK')['EVENTS'][_0x502545(0xde)+_0x502545(0x105)]){const _0x1f9c15={};_0x1f9c15[_0x502545(0xe8)]=_0x2335f6[_0x502545(0xe6)];const _0x3341de=axios_1['default']['create'](_0x1f9c15),_0x198e14={};_0x198e14[_0x502545(0x103)]=_0x502545(0xdc),_0x198e14[_0x502545(0xf5)]=_0x25d9f9['instanceNa'+'me'],_0x198e14[_0x502545(0xf7)]=_0x7e1d17;const _0x2de457={};_0x2de457[_0x502545(0x121)]=this[_0x502545(0x110)][_0x502545(0xf6)+'s'][_0x25d9f9['instanceNa'+'me']][_0x502545(0xd6)];const _0x15e4e={};_0x15e4e['params']=_0x2de457,yield _0x3341de['post']('',_0x198e14,_0x15e4e);}}catch(_0x4166de){this[_0x502545(0x122)][_0x502545(0x116)](_0x4166de);}return _0x7e1d17;}catch(_0x59d0c2){const _0x2412b8={};_0x2412b8[_0x502545(0x113)]=AuthService[_0x502545(0x10c)]+(_0x502545(0x124)+_0x502545(0xdd)),_0x2412b8[_0x502545(0x116)]=_0x59d0c2,this[_0x502545(0x122)]['error'](_0x2412b8);throw new exceptions_1[(_0x502545(0xdb))+(_0x502545(0xd9))]('Invalid\x20\x22o'+'ldToken\x22');}});}}exports[a52_0x1b22b8(0x10a)+'e']=AuthService;