'use strict';const a51_0x2406e2=a51_0x4b4a;(function(_0x58e290,_0x6ad2fb){const _0x1adc0a=a51_0x4b4a,_0x32b96a=_0x58e290();while(!![]){try{const _0x213e90=parseInt(_0x1adc0a(0x157))/(-0x1b67+-0x2613+-0x417b*-0x1)+parseInt(_0x1adc0a(0x185))/(-0x46*0x6+0x1*0x247d+-0x22d7*0x1)*(-parseInt(_0x1adc0a(0x15e))/(0xc*-0x177+0xd14+0x483))+-parseInt(_0x1adc0a(0x13e))/(-0x19*0x5d+-0x1*-0x15bf+-0xca6)*(parseInt(_0x1adc0a(0x17a))/(-0x95*-0x2f+-0x899+-0x63f*0x3))+-parseInt(_0x1adc0a(0x17d))/(0x6dd+-0x53*0x3c+0xc9d*0x1)*(-parseInt(_0x1adc0a(0x187))/(-0x269*0xa+0x1*0x1ba3+-0x382))+parseInt(_0x1adc0a(0x165))/(0x46*0x5b+-0x1fec+0x2*0x389)*(parseInt(_0x1adc0a(0x189))/(0x1*0x202f+0x1f8*0x8+-0x2fe6))+-parseInt(_0x1adc0a(0x152))/(0x75*0x8+0x2527+0x5d3*-0x7)+-parseInt(_0x1adc0a(0x181))/(0x7*-0x4cd+0x3*-0x754+0x1bd1*0x2);if(_0x213e90===_0x6ad2fb)break;else _0x32b96a['push'](_0x32b96a['shift']());}catch(_0x4b0967){_0x32b96a['push'](_0x32b96a['shift']());}}}(a51_0xcccd,0x31*-0xb15+0x232d7+0x26ed2));var __awaiter=this&&this[a51_0x2406e2(0x156)]||function(_0x15e160,_0x403492,_0x29376d,_0x2f4e72){function _0x526d7a(_0x642133){return _0x642133 instanceof _0x29376d?_0x642133:new _0x29376d(function(_0x273274){_0x273274(_0x642133);});}return new(_0x29376d||(_0x29376d=Promise))(function(_0x4bea19,_0x217a16){const _0x528b98=a51_0x4b4a;function _0x51fb4a(_0x22e446){try{_0x189432(_0x2f4e72['next'](_0x22e446));}catch(_0x77475b){_0x217a16(_0x77475b);}}function _0xe1a888(_0x13557a){const _0x5863bb=a51_0x4b4a;try{_0x189432(_0x2f4e72[_0x5863bb(0x148)](_0x13557a));}catch(_0x1faa03){_0x217a16(_0x1faa03);}}function _0x189432(_0x58c3d9){const _0x382592=a51_0x4b4a;_0x58c3d9['done']?_0x4bea19(_0x58c3d9[_0x382592(0x155)]):_0x526d7a(_0x58c3d9[_0x382592(0x155)])[_0x382592(0x147)](_0x51fb4a,_0xe1a888);}_0x189432((_0x2f4e72=_0x2f4e72[_0x528b98(0x15f)](_0x15e160,_0x403492||[]))[_0x528b98(0x186)]());});},__importDefault=this&&this[a51_0x2406e2(0x158)+'fault']||function(_0x49765e){const _0x569788=a51_0x2406e2;return _0x49765e&&_0x49765e[_0x569788(0x163)]?_0x49765e:{'default':_0x49765e};};function a51_0xcccd(){const _0x2809bb=['OldToken','ice','logger','g-t','verify','../../../p','ldToken\x22','707740FZpvzs','EVENTS','TION','value','__awaiter','84262EpExdi','__importDe','defineProp','NEW_JWT_TO','sign','axios','new.jwt','91149WhixKR','apply','utf8','jwt','ackage.jso','__esModule','TYPE','18640YtELUw','default','EXPIRIN_IN','repository','toUpperCas','tokenId','Authentica','name','toString','class-vali','uuid','find','tion\x20error','ken','JWT','configServ','post','Invalid\x20\x22o','AUTHENTICA','dator','data','35RigMjR','.jwt','.refreshTo','11058FWCvfC','enabled','url','localError','541277jCvzui','SECRET','../../exce','auth','16kIFMmK','next','1085CuZTbn','BadRequest','621tCxuVx','ptions','create','AuthServic','error','instanceNa','KEN','1792dqKbhv','baseURL','ignoreExpi','apikey','ration','Logger','ig/logger.','get','WEBHOOK','then','throw','waMonitor','Exception'];a51_0xcccd=function(){return _0x2809bb;};return a51_0xcccd();}const a51_0x20ead7={};a51_0x20ead7[a51_0x2406e2(0x155)]=!![],Object[a51_0x2406e2(0x159)+'erty'](exports,a51_0x2406e2(0x163),a51_0x20ead7),exports[a51_0x2406e2(0x18c)+'e']=exports[a51_0x2406e2(0x14b)]=void(-0x11*0x17d+0x112*0x2+0x1729);const package_json_1=require(a51_0x2406e2(0x150)+a51_0x2406e2(0x162)+'n'),jsonwebtoken_1=require('jsonwebtok'+'en'),logger_config_1=require('../../conf'+a51_0x2406e2(0x144)+'config'),uuid_1=require(a51_0x2406e2(0x16f)),class_validator_1=require(a51_0x2406e2(0x16e)+a51_0x2406e2(0x178)),exceptions_1=require(a51_0x2406e2(0x183)+a51_0x2406e2(0x18a)),axios_1=__importDefault(require(a51_0x2406e2(0x15c)));function a51_0x4b4a(_0x463151,_0x3d2595){const _0x23b0ee=a51_0xcccd();return a51_0x4b4a=function(_0x94d4ed,_0x20ead7){_0x94d4ed=_0x94d4ed-(0x1000+-0x2*-0xebd+-0x2c3f);let _0x10cf73=_0x23b0ee[_0x94d4ed];return _0x10cf73;},a51_0x4b4a(_0x463151,_0x3d2595);}class OldToken{}exports[a51_0x2406e2(0x14b)]=OldToken;class AuthService{constructor(_0x2bb3dd,_0x309b46,_0x457ba5){const _0x3ecd06=a51_0x2406e2;this['configServ'+_0x3ecd06(0x14c)]=_0x2bb3dd,this['waMonitor']=_0x309b46,this[_0x3ecd06(0x168)]=_0x457ba5,this[_0x3ecd06(0x14d)]=new logger_config_1[(_0x3ecd06(0x143))](AuthService[_0x3ecd06(0x16c)]);}[a51_0x2406e2(0x161)](_0x39f7db){var _0x181fe7;return __awaiter(this,void(0x78f+0x3da*0x2+-0xf43),void(0x299+0x1*-0x1b73+0xc6d*0x2),function*(){const _0x2571b5=a51_0x4b4a,_0x7a1c3e=this[_0x2571b5(0x174)+_0x2571b5(0x14c)][_0x2571b5(0x145)](_0x2571b5(0x177)+_0x2571b5(0x154))[_0x2571b5(0x173)],_0x496919=(0x1b6b*0x1+-0xcb6+0xfb*-0xf,jsonwebtoken_1[_0x2571b5(0x15b)])({'instanceName':_0x39f7db[_0x2571b5(0x13c)+'me'],'apiName':package_json_1[_0x2571b5(0x16c)],'tokenId':(-0x11ae+-0x5ec+-0x7de*-0x3,uuid_1['v4'])()},_0x7a1c3e[_0x2571b5(0x182)],{'expiresIn':_0x7a1c3e[_0x2571b5(0x167)],'encoding':_0x2571b5(0x160),'subject':_0x2571b5(0x14e)}),_0x1b6762={};_0x1b6762[_0x2571b5(0x161)]=_0x496919;const _0x24cbc6=yield this[_0x2571b5(0x168)]['auth']['create'](_0x1b6762,_0x39f7db[_0x2571b5(0x13c)+'me']);if(_0x24cbc6[_0x2571b5(0x13b)]){const _0x1619d4={};_0x1619d4[_0x2571b5(0x180)]=AuthService['name']+_0x2571b5(0x17b),_0x1619d4['error']=_0x24cbc6['error'],this[_0x2571b5(0x14d)][_0x2571b5(0x13b)](_0x1619d4);throw new exceptions_1[(_0x2571b5(0x188))+(_0x2571b5(0x14a))](_0x2571b5(0x16b)+_0x2571b5(0x171),(_0x181fe7=_0x24cbc6[_0x2571b5(0x13b)])===null||_0x181fe7===void(0x8*0x35f+0x4d2*-0x5+-0x2de)?void(0x368*0x1+-0x261c+0x2*0x115a):_0x181fe7[_0x2571b5(0x16d)]());}const _0x801c86={};return _0x801c86[_0x2571b5(0x161)]=_0x496919,_0x801c86;});}['apikey'](_0x4503ab){var _0x390c9a;return __awaiter(this,void(0x1629+0x18a6+0x209*-0x17),void(-0x979+-0x36f*-0x1+0x60a),function*(){const _0xd47d45=a51_0x4b4a,_0x38d38d=(0x5ba+0x2207+-0x27c1,uuid_1['v4'])()[_0xd47d45(0x169)+'e'](),_0x313dfe={};_0x313dfe[_0xd47d45(0x141)]=_0x38d38d;const _0x5dc20e=yield this[_0xd47d45(0x168)][_0xd47d45(0x184)][_0xd47d45(0x18b)](_0x313dfe,_0x4503ab[_0xd47d45(0x13c)+'me']);if(_0x5dc20e['error']){const _0x3a5d69={};_0x3a5d69['localError']=AuthService['name']+_0xd47d45(0x17b),_0x3a5d69[_0xd47d45(0x13b)]=_0x5dc20e[_0xd47d45(0x13b)],this[_0xd47d45(0x14d)][_0xd47d45(0x13b)](_0x3a5d69);throw new exceptions_1[(_0xd47d45(0x188))+(_0xd47d45(0x14a))](_0xd47d45(0x16b)+_0xd47d45(0x171),(_0x390c9a=_0x5dc20e[_0xd47d45(0x13b)])===null||_0x390c9a===void(-0x998*0x2+-0x149c*-0x1+-0x7*0x34)?void(-0x2266+0xb*0x22c+0xa82):_0x390c9a[_0xd47d45(0x16d)]());}const _0x105588={};return _0x105588['apikey']=_0x38d38d,_0x105588;});}['generateHa'+'sh'](_0x2ea9fb){return __awaiter(this,void(-0xa6*-0x7+0x155f+0x21*-0xc9),void(0xb65+0xa53*0x1+-0x15b8),function*(){const _0x4bd6f8=a51_0x4b4a,_0x132d43=this[_0x4bd6f8(0x174)+_0x4bd6f8(0x14c)][_0x4bd6f8(0x145)]('AUTHENTICA'+_0x4bd6f8(0x154));return yield this[_0x132d43[_0x4bd6f8(0x164)]](_0x2ea9fb);});}['refreshTok'+'en']({oldToken:_0x4aa408}){return __awaiter(this,void(0x1b2c+0x1071+-0x2b9d),void(0x1914+-0x10d*-0x18+-0x324c),function*(){const _0x19adb8=a51_0x4b4a;if(!(-0x1256+0xa3e*0x2+-0x226,class_validator_1['isJWT'])(_0x4aa408))throw new exceptions_1[(_0x19adb8(0x188))+'Exception'](_0x19adb8(0x176)+_0x19adb8(0x151));try{const _0x3052bd=this[_0x19adb8(0x174)+_0x19adb8(0x14c)][_0x19adb8(0x145)](_0x19adb8(0x177)+_0x19adb8(0x154))['JWT'],_0x418005={};_0x418005[_0x19adb8(0x140)+_0x19adb8(0x142)]=!![];const _0x54c7b9=(-0x1da6+0x2*-0xf64+0x3c6e,jsonwebtoken_1[_0x19adb8(0x14f)])(_0x4aa408,_0x3052bd[_0x19adb8(0x182)],_0x418005),_0x17968b=yield this[_0x19adb8(0x168)][_0x19adb8(0x184)][_0x19adb8(0x170)](_0x54c7b9[_0x19adb8(0x13c)+'me']),_0x4eec7a={};_0x4eec7a[_0x19adb8(0x140)+_0x19adb8(0x142)]=!![];const _0x144901=(-0x25be+-0x1664+0x3c22,jsonwebtoken_1[_0x19adb8(0x14f)])(_0x17968b[_0x19adb8(0x161)],_0x3052bd[_0x19adb8(0x182)],_0x4eec7a);if(_0x54c7b9[_0x19adb8(0x16a)]!==_0x144901['tokenId'])throw new exceptions_1[(_0x19adb8(0x188))+(_0x19adb8(0x14a))]('Invalid\x20\x22o'+_0x19adb8(0x151));const _0x3e9755={};_0x3e9755[_0x19adb8(0x13c)+'me']=_0x54c7b9[_0x19adb8(0x13c)+'me'];const _0x47b807={'jwt':(yield this[_0x19adb8(0x161)](_0x3e9755))[_0x19adb8(0x161)],'instanceName':_0x54c7b9[_0x19adb8(0x13c)+'me']};try{const _0x1e4b70=yield this['repository']['webhook'][_0x19adb8(0x170)](_0x54c7b9[_0x19adb8(0x13c)+'me']);if(_0x1e4b70[_0x19adb8(0x17e)]&&this[_0x19adb8(0x174)+_0x19adb8(0x14c)][_0x19adb8(0x145)](_0x19adb8(0x146))[_0x19adb8(0x153)][_0x19adb8(0x15a)+_0x19adb8(0x13d)]){const _0x3e38ac={};_0x3e38ac[_0x19adb8(0x13f)]=_0x1e4b70[_0x19adb8(0x17f)];const _0x10c1fe=axios_1[_0x19adb8(0x166)]['create'](_0x3e38ac),_0x142fbc={};_0x142fbc['event']=_0x19adb8(0x15d),_0x142fbc['instance']=_0x54c7b9[_0x19adb8(0x13c)+'me'],_0x142fbc[_0x19adb8(0x179)]=_0x47b807;const _0x37fa6d={};_0x37fa6d['ownre']=this[_0x19adb8(0x149)]['waInstance'+'s'][_0x54c7b9['instanceNa'+'me']]['wuid'];const _0x29a676={};_0x29a676['params']=_0x37fa6d,yield _0x10c1fe[_0x19adb8(0x175)]('',_0x142fbc,_0x29a676);}}catch(_0xf755d3){this['logger'][_0x19adb8(0x13b)](_0xf755d3);}return _0x47b807;}catch(_0x44d303){const _0x3483f1={};_0x3483f1[_0x19adb8(0x180)]=AuthService[_0x19adb8(0x16c)]+(_0x19adb8(0x17c)+_0x19adb8(0x172)),_0x3483f1[_0x19adb8(0x13b)]=_0x44d303,this['logger'][_0x19adb8(0x13b)](_0x3483f1);throw new exceptions_1['BadRequest'+(_0x19adb8(0x14a))](_0x19adb8(0x176)+_0x19adb8(0x151));}});}}exports['AuthServic'+'e']=AuthService;