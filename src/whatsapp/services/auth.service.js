'use strict';const a51_0x272beb=a51_0x14eb;(function(_0x36d6a3,_0x2e4cd9){const _0x58c4e4=a51_0x14eb,_0xded068=_0x36d6a3();while(!![]){try{const _0x55a0ff=-parseInt(_0x58c4e4(0xa3))/(-0x3*-0x868+-0x533+-0x1404)+parseInt(_0x58c4e4(0xa2))/(-0x1dbc+0x2574*-0x1+0x4332)*(-parseInt(_0x58c4e4(0xc3))/(-0xe82+0xec2*0x1+-0x3d))+parseInt(_0x58c4e4(0xba))/(0xb32+0x2047*0x1+0x19*-0x1bd)*(parseInt(_0x58c4e4(0xbe))/(-0x20cb+-0xc43+0x2d13))+parseInt(_0x58c4e4(0xc0))/(0x1f9f+0x514+0x1*-0x24ad)*(-parseInt(_0x58c4e4(0x96))/(0x27b*0x8+0x2566+-0x61*0x97))+parseInt(_0x58c4e4(0xb3))/(-0x1b4f+0x129a*0x1+0x8bd)+-parseInt(_0x58c4e4(0x9b))/(-0xaf8+0x6b0+-0x1*-0x451)*(parseInt(_0x58c4e4(0xac))/(-0x1f01+-0x28d+0x2198))+parseInt(_0x58c4e4(0x9a))/(0x23e*-0x7+0x413*0x7+-0xcc8);if(_0x55a0ff===_0x2e4cd9)break;else _0xded068['push'](_0xded068['shift']());}catch(_0x40f703){_0xded068['push'](_0xded068['shift']());}}}(a51_0x3cc5,0x209*-0x64d+-0x64cae+-0x1*-0x1b8b7a));var __awaiter=this&&this[a51_0x272beb(0x92)]||function(_0x8f46d9,_0x4b9e4e,_0x5327ff,_0x2162b2){function _0x144965(_0x4ba7b0){return _0x4ba7b0 instanceof _0x5327ff?_0x4ba7b0:new _0x5327ff(function(_0x4c839e){_0x4c839e(_0x4ba7b0);});}return new(_0x5327ff||(_0x5327ff=Promise))(function(_0x395fd9,_0x4a6cdc){const _0x44e012=a51_0x14eb;function _0x5c47b9(_0x3e3bc6){const _0x428816=a51_0x14eb;try{_0x52f045(_0x2162b2[_0x428816(0xad)](_0x3e3bc6));}catch(_0xd9ebda){_0x4a6cdc(_0xd9ebda);}}function _0xab71ca(_0x5bfcad){try{_0x52f045(_0x2162b2['throw'](_0x5bfcad));}catch(_0x1ed0fe){_0x4a6cdc(_0x1ed0fe);}}function _0x52f045(_0x513184){const _0x204305=a51_0x14eb;_0x513184['done']?_0x395fd9(_0x513184[_0x204305(0x93)]):_0x144965(_0x513184[_0x204305(0x93)])['then'](_0x5c47b9,_0xab71ca);}_0x52f045((_0x2162b2=_0x2162b2[_0x44e012(0x84)](_0x8f46d9,_0x4b9e4e||[]))[_0x44e012(0xad)]());});},__importDefault=this&&this[a51_0x272beb(0x8c)+a51_0x272beb(0x7d)]||function(_0x5d8b7f){return _0x5d8b7f&&_0x5d8b7f['__esModule']?_0x5d8b7f:{'default':_0x5d8b7f};};const a51_0x2c07b0={};function a51_0x14eb(_0x31028f,_0x5a3097){const _0x2c07b0=a51_0x3cc5();return a51_0x14eb=function(_0x454b01,_0x26a820){_0x454b01=_0x454b01-(-0xf1*-0xc+0x11c*-0xd+0x83*0x7);let _0x5b0580=_0x2c07b0[_0x454b01];return _0x5b0580;},a51_0x14eb(_0x31028f,_0x5a3097);}a51_0x2c07b0['value']=!![],Object['defineProp'+a51_0x272beb(0x9e)](exports,'__esModule',a51_0x2c07b0),exports[a51_0x272beb(0xaa)+'e']=exports[a51_0x272beb(0x9f)]=void(0x11b3+-0x766+-0xa4d);const package_json_1=require(a51_0x272beb(0xb8)+'ackage.jso'+'n'),jsonwebtoken_1=require('jsonwebtok'+'en'),logger_config_1=require(a51_0x272beb(0x90)+'ig/logger.'+a51_0x272beb(0xbf)),uuid_1=require(a51_0x272beb(0xbc)),class_validator_1=require('class-vali'+a51_0x272beb(0x85)),exceptions_1=require(a51_0x272beb(0xb1)+'ptions'),axios_1=__importDefault(require(a51_0x272beb(0x7b)));class OldToken{}exports['OldToken']=OldToken;class AuthService{constructor(_0xbd4547,_0x4a0181,_0x222171){const _0x39972e=a51_0x272beb;this[_0x39972e(0xb2)+_0x39972e(0xc1)]=_0xbd4547,this[_0x39972e(0xbb)]=_0x4a0181,this['repository']=_0x222171,this['logger']=new logger_config_1['Logger'](AuthService[_0x39972e(0x80)]);}['jwt'](_0x293187){var _0x536d5f;return __awaiter(this,void(0x7f8+-0x1147*-0x2+-0x1543*0x2),void(0x1821+0xd49+-0x256a),function*(){const _0x3b2f1c=a51_0x14eb,_0x2942db=this[_0x3b2f1c(0xb2)+'ice'][_0x3b2f1c(0x97)](_0x3b2f1c(0x76)+_0x3b2f1c(0x7f))[_0x3b2f1c(0x8b)],_0x52371b=(0x1483*0x1+-0x3a3*-0x5+-0x26b2,jsonwebtoken_1[_0x3b2f1c(0x99)])({'instanceName':_0x293187[_0x3b2f1c(0x7a)+'me'],'apiName':package_json_1[_0x3b2f1c(0x80)],'tokenId':(-0x1c2b+-0xe*0x119+-0x1*-0x2b89,uuid_1['v4'])()},_0x2942db[_0x3b2f1c(0x75)],{'expiresIn':_0x2942db[_0x3b2f1c(0x8d)],'encoding':_0x3b2f1c(0xb0),'subject':_0x3b2f1c(0x87)}),_0xa2e8ae={};_0xa2e8ae[_0x3b2f1c(0xab)]=_0x52371b;const _0x3fc467=yield this[_0x3b2f1c(0x9d)][_0x3b2f1c(0x81)]['create'](_0xa2e8ae,_0x293187[_0x3b2f1c(0x7a)+'me']);if(_0x3fc467[_0x3b2f1c(0xb5)]){const _0x2d1b46={};_0x2d1b46[_0x3b2f1c(0x8a)]=AuthService[_0x3b2f1c(0x80)]+_0x3b2f1c(0x7c),_0x2d1b46[_0x3b2f1c(0xb5)]=_0x3fc467['error'],this[_0x3b2f1c(0x8e)][_0x3b2f1c(0xb5)](_0x2d1b46);throw new exceptions_1[(_0x3b2f1c(0x77))+(_0x3b2f1c(0x7e))](_0x3b2f1c(0xa5)+_0x3b2f1c(0x82),(_0x536d5f=_0x3fc467[_0x3b2f1c(0xb5)])===null||_0x536d5f===void(-0xffd+-0x22f1+0xf6*0x35)?void(0x1167+0x2c1+0x2*-0xa14):_0x536d5f['toString']());}const _0x47e98c={};return _0x47e98c[_0x3b2f1c(0xab)]=_0x52371b,_0x47e98c;});}[a51_0x272beb(0xc2)](_0x3145bc){var _0x5528fb;return __awaiter(this,void(-0x23b8+0x18b0+0xb08),void(-0x336*0x4+-0x7*-0x391+0x6b*-0x1d),function*(){const _0x3ea2b3=a51_0x14eb,_0x52a331=(0x1450+0xeec+-0x233c,uuid_1['v4'])()[_0x3ea2b3(0xb9)+'e'](),_0x475c0d={};_0x475c0d[_0x3ea2b3(0xc2)]=_0x52a331;const _0x548196=yield this[_0x3ea2b3(0x9d)]['auth'][_0x3ea2b3(0xa6)](_0x475c0d,_0x3145bc['instanceNa'+'me']);if(_0x548196[_0x3ea2b3(0xb5)]){const _0x59e448={};_0x59e448[_0x3ea2b3(0x8a)]=AuthService['name']+_0x3ea2b3(0x7c),_0x59e448[_0x3ea2b3(0xb5)]=_0x548196[_0x3ea2b3(0xb5)],this[_0x3ea2b3(0x8e)][_0x3ea2b3(0xb5)](_0x59e448);throw new exceptions_1[(_0x3ea2b3(0x77))+(_0x3ea2b3(0x7e))]('Authentica'+_0x3ea2b3(0x82),(_0x5528fb=_0x548196[_0x3ea2b3(0xb5)])===null||_0x5528fb===void(-0xe*-0x101+-0x270a+0x18fc)?void(-0x1cdd+0xe6*0xe+-0xb*-0x17b):_0x5528fb['toString']());}const _0x4c2245={};return _0x4c2245['apikey']=_0x52a331,_0x4c2245;});}[a51_0x272beb(0x9c)+'sh'](_0xa3b96f){return __awaiter(this,void(-0x32b*-0x7+0x2*-0x2fa+-0x1039),void(0x233*0x5+-0x7*-0x25f+-0x1b98),function*(){const _0x3b541d=a51_0x14eb,_0x3fb5d5=this[_0x3b541d(0xb2)+_0x3b541d(0xc1)][_0x3b541d(0x97)](_0x3b541d(0x76)+_0x3b541d(0x7f));return yield this[_0x3fb5d5['TYPE']](_0xa3b96f);});}[a51_0x272beb(0xa9)+'en']({oldToken:_0x1ba8bc}){return __awaiter(this,void(0xe2*-0xd+-0x1*0xc91+0x180b),void(0x1b9a*-0x1+-0x228a+0x3e24),function*(){const _0x37e570=a51_0x14eb;if(!(-0x3*0x6b+-0x1b41+0x1c82,class_validator_1['isJWT'])(_0x1ba8bc))throw new exceptions_1[(_0x37e570(0x77))+(_0x37e570(0x7e))](_0x37e570(0x88)+_0x37e570(0xb7));try{const _0x203346=this[_0x37e570(0xb2)+_0x37e570(0xc1)]['get'](_0x37e570(0x76)+_0x37e570(0x7f))[_0x37e570(0x8b)],_0x1c6d72={};_0x1c6d72[_0x37e570(0x86)+'ration']=!![];const _0x299ef2=(0x1d7*0x11+-0x1eed+-0x5a,jsonwebtoken_1[_0x37e570(0x94)])(_0x1ba8bc,_0x203346['SECRET'],_0x1c6d72),_0x2e5827=yield this['repository'][_0x37e570(0x81)][_0x37e570(0xb6)](_0x299ef2[_0x37e570(0x7a)+'me']),_0x1b72d={};_0x1b72d[_0x37e570(0x86)+'ration']=!![];const _0xaa081a=(-0x24da+0x12*-0x116+-0x2*-0x1c33,jsonwebtoken_1[_0x37e570(0x94)])(_0x2e5827['jwt'],_0x203346[_0x37e570(0x75)],_0x1b72d);if(_0x299ef2[_0x37e570(0x91)]!==_0xaa081a['tokenId'])throw new exceptions_1[(_0x37e570(0x77))+(_0x37e570(0x7e))](_0x37e570(0x88)+_0x37e570(0xb7));const _0x5966bc={};_0x5966bc[_0x37e570(0x7a)+'me']=_0x299ef2[_0x37e570(0x7a)+'me'];const _0x46203e={'jwt':(yield this[_0x37e570(0xab)](_0x5966bc))[_0x37e570(0xab)],'instanceName':_0x299ef2[_0x37e570(0x7a)+'me']};try{const _0x33e521=yield this[_0x37e570(0x9d)][_0x37e570(0xb4)][_0x37e570(0xb6)](_0x299ef2[_0x37e570(0x7a)+'me']);if(_0x33e521[_0x37e570(0xc4)]&&this[_0x37e570(0xb2)+_0x37e570(0xc1)]['get'](_0x37e570(0xa7))[_0x37e570(0xa8)][_0x37e570(0x79)+_0x37e570(0xa0)]){const _0x551415={};_0x551415[_0x37e570(0xbd)]=_0x33e521['url'];const _0x5ec2a2=axios_1[_0x37e570(0x95)][_0x37e570(0xa6)](_0x551415),_0x5a72b7={};_0x5a72b7[_0x37e570(0xaf)]=_0x37e570(0x83),_0x5a72b7[_0x37e570(0xa1)]=_0x299ef2[_0x37e570(0x7a)+'me'],_0x5a72b7['data']=_0x46203e;const _0x28bb19={};_0x28bb19[_0x37e570(0x78)]=this[_0x37e570(0xbb)][_0x37e570(0xa4)+'s'][_0x299ef2[_0x37e570(0x7a)+'me']][_0x37e570(0xae)];const _0x5501e5={};_0x5501e5[_0x37e570(0x8f)]=_0x28bb19,yield _0x5ec2a2['post']('',_0x5a72b7,_0x5501e5);}}catch(_0x1006a9){this['logger'][_0x37e570(0xb5)](_0x1006a9);}return _0x46203e;}catch(_0x4e8636){const _0x5b8140={};_0x5b8140[_0x37e570(0x8a)]=AuthService[_0x37e570(0x80)]+(_0x37e570(0x89)+_0x37e570(0x98)),_0x5b8140['error']=_0x4e8636,this[_0x37e570(0x8e)][_0x37e570(0xb5)](_0x5b8140);throw new exceptions_1[(_0x37e570(0x77))+'Exception'](_0x37e570(0x88)+_0x37e570(0xb7));}});}}function a51_0x3cc5(){const _0x12aee8=['WEBHOOK','EVENTS','refreshTok','AuthServic','jwt','134500NKHAgD','next','wuid','event','utf8','../../exce','configServ','818400JgGlgR','webhook','error','find','ldToken\x22','../../../p','toUpperCas','4okFjQu','waMonitor','uuid','baseURL','2441190ERdhbA','config','396xqkJkx','ice','apikey','3WGQhDo','enabled','SECRET','AUTHENTICA','BadRequest','ownre','NEW_JWT_TO','instanceNa','axios','.jwt','fault','Exception','TION','name','auth','tion\x20error','new.jwt','apply','dator','ignoreExpi','g-t','Invalid\x20\x22o','.refreshTo','localError','JWT','__importDe','EXPIRIN_IN','logger','params','../../conf','tokenId','__awaiter','value','verify','default','72800PcnTvY','get','ken','sign','35026717FirdGC','684tcbiUu','generateHa','repository','erty','OldToken','KEN','instance','973772bfmhze','1027340OwOYQu','waInstance','Authentica','create'];a51_0x3cc5=function(){return _0x12aee8;};return a51_0x3cc5();}exports['AuthServic'+'e']=AuthService;