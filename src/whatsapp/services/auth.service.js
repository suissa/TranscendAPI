'use strict';const a52_0x541b2b=a52_0x4979;(function(_0x1eabab,_0x22caea){const _0x1bb86d=a52_0x4979,_0x11c42e=_0x1eabab();while(!![]){try{const _0x1b73c1=-parseInt(_0x1bb86d(0x1a1))/(-0x259a+0x43*0x6b+0x1*0x99a)+-parseInt(_0x1bb86d(0x1c5))/(0x5*0x1f3+-0x1*0x1da7+0x13ea)+-parseInt(_0x1bb86d(0x1bb))/(0xc59+-0x1632+0x4ee*0x2)*(-parseInt(_0x1bb86d(0x1e3))/(-0x1679+-0x1871+0x2eee))+-parseInt(_0x1bb86d(0x1d0))/(-0xc2b+-0x2*0x369+-0x6*-0x32b)+-parseInt(_0x1bb86d(0x1c6))/(0x109c+-0x1b49+-0x53*-0x21)+-parseInt(_0x1bb86d(0x1b7))/(0xf89+0x2*-0xc49+0x122*0x8)+parseInt(_0x1bb86d(0x1cb))/(-0x11*-0xd8+0x338+-0x1188);if(_0x1b73c1===_0x22caea)break;else _0x11c42e['push'](_0x11c42e['shift']());}catch(_0x29cc6b){_0x11c42e['push'](_0x11c42e['shift']());}}}(a52_0x7a64,-0x7f*0x358+0x19252+0x288ee));function a52_0x7a64(){const _0x4cf8c5=['fault','owner','ignoreExpi','Logger','error','jsonwebtok','uuid','done','.refreshTo','TION','Invalid\x20\x22o','new.jwt','Exception','params','TYPE','utf8','default','2039779McuOAy','get','apikey','auth','11244AYONuP','logger','KEN','Authentica','throw','ackage.jso','SECRET','erty','toString','config','331540ywWwgZ','725406OpBNQb','OldToken','WEBHOOK','then','instance','6675768ZvLMvS','ldToken\x22','ptions','g-t','__esModule','191820nySUVQ','ice','class-vali','NEW_JWT_TO','jwt','tokenId','.jwt','webhook','toUpperCas','url','waInstance','name','create','AuthServic','../../../p','next','instanceNa','../../conf','verify','256Holpgs','__awaiter','EVENTS','apply','localError','EXPIRIN_IN','BadRequest','axios','data','AUTHENTICA','configServ','value','find','dator','JWT','generateHa','enabled','__importDe','297503nppLdp','repository','waMonitor','ig/logger.','ration'];a52_0x7a64=function(){return _0x4cf8c5;};return a52_0x7a64();}var __awaiter=this&&this[a52_0x541b2b(0x1e4)]||function(_0x3eb077,_0x3202c5,_0x12cf66,_0x468918){function _0x440af5(_0x4aaf0f){return _0x4aaf0f instanceof _0x12cf66?_0x4aaf0f:new _0x12cf66(function(_0x2ac8d9){_0x2ac8d9(_0x4aaf0f);});}return new(_0x12cf66||(_0x12cf66=Promise))(function(_0x576e2d,_0x22ccf0){const _0x2f8d64=a52_0x4979;function _0x2ee6a3(_0x50a876){try{_0x463f0f(_0x468918['next'](_0x50a876));}catch(_0x52496e){_0x22ccf0(_0x52496e);}}function _0x5c7ba2(_0x211f5d){const _0x321efe=a52_0x4979;try{_0x463f0f(_0x468918[_0x321efe(0x1bf)](_0x211f5d));}catch(_0x505a29){_0x22ccf0(_0x505a29);}}function _0x463f0f(_0x342039){const _0xe9fbd0=a52_0x4979;_0x342039[_0xe9fbd0(0x1ad)]?_0x576e2d(_0x342039['value']):_0x440af5(_0x342039[_0xe9fbd0(0x19a)])[_0xe9fbd0(0x1c9)](_0x2ee6a3,_0x5c7ba2);}_0x463f0f((_0x468918=_0x468918[_0x2f8d64(0x1e6)](_0x3eb077,_0x3202c5||[]))[_0x2f8d64(0x1df)]());});},__importDefault=this&&this[a52_0x541b2b(0x1a0)+a52_0x541b2b(0x1a6)]||function(_0x349dff){const _0x501e1e=a52_0x541b2b;return _0x349dff&&_0x349dff[_0x501e1e(0x1cf)]?_0x349dff:{'default':_0x349dff};};const a52_0x4e57ac={};a52_0x4e57ac[a52_0x541b2b(0x19a)]=!![],Object['defineProp'+a52_0x541b2b(0x1c2)](exports,a52_0x541b2b(0x1cf),a52_0x4e57ac),exports['AuthServic'+'e']=exports[a52_0x541b2b(0x1c7)]=void(0x3*0x93d+0x1165*-0x2+0x713*0x1);const package_json_1=require(a52_0x541b2b(0x1de)+a52_0x541b2b(0x1c0)+'n'),jsonwebtoken_1=require(a52_0x541b2b(0x1ab)+'en'),logger_config_1=require(a52_0x541b2b(0x1e1)+a52_0x541b2b(0x1a4)+a52_0x541b2b(0x1c4)),uuid_1=require(a52_0x541b2b(0x1ac)),class_validator_1=require(a52_0x541b2b(0x1d2)+a52_0x541b2b(0x19c)),exceptions_1=require('../../exce'+a52_0x541b2b(0x1cd)),axios_1=__importDefault(require(a52_0x541b2b(0x1ea)));class OldToken{}function a52_0x4979(_0x3b1f5e,_0x3386eb){const _0x269a27=a52_0x7a64();return a52_0x4979=function(_0x2a8c97,_0x4e57ac){_0x2a8c97=_0x2a8c97-(-0x92+-0xe*-0x1cf+-0x1729);let _0x5183c9=_0x269a27[_0x2a8c97];return _0x5183c9;},a52_0x4979(_0x3b1f5e,_0x3386eb);}exports[a52_0x541b2b(0x1c7)]=OldToken;class AuthService{constructor(_0x2be6fc,_0x287a77,_0x3865fa){const _0x508984=a52_0x541b2b;this['configServ'+_0x508984(0x1d1)]=_0x2be6fc,this[_0x508984(0x1a3)]=_0x287a77,this[_0x508984(0x1a2)]=_0x3865fa,this['logger']=new logger_config_1[(_0x508984(0x1a9))](AuthService['name']);}['jwt'](_0x2694f2){var _0x4d0d47;return __awaiter(this,void(0x1030*-0x2+0x1d*-0x13e+0x4466),void(0x1f*0x123+0xe3*0xd+-0x2ec4),function*(){const _0x4379f1=a52_0x4979,_0x661305=this[_0x4379f1(0x199)+_0x4379f1(0x1d1)]['get']('AUTHENTICA'+'TION')[_0x4379f1(0x19d)],_0xa553ab=(0x2e9+0x955*0x1+-0xc3e,jsonwebtoken_1['sign'])({'instanceName':_0x2694f2[_0x4379f1(0x1e0)+'me'],'apiName':package_json_1[_0x4379f1(0x1db)],'tokenId':(0x1b0d+-0xa9f*-0x1+-0x25ac*0x1,uuid_1['v4'])()},_0x661305[_0x4379f1(0x1c1)],{'expiresIn':_0x661305[_0x4379f1(0x1e8)],'encoding':_0x4379f1(0x1b5),'subject':_0x4379f1(0x1ce)}),_0x4be6fe={};_0x4be6fe[_0x4379f1(0x1d4)]=_0xa553ab;const _0x24c8f3=yield this['repository'][_0x4379f1(0x1ba)][_0x4379f1(0x1dc)](_0x4be6fe,_0x2694f2[_0x4379f1(0x1e0)+'me']);if(_0x24c8f3[_0x4379f1(0x1aa)]){const _0x4aa1e4={};_0x4aa1e4[_0x4379f1(0x1e7)]=AuthService[_0x4379f1(0x1db)]+'.jwt',_0x4aa1e4[_0x4379f1(0x1aa)]=_0x24c8f3[_0x4379f1(0x1aa)],this['logger'][_0x4379f1(0x1aa)](_0x4aa1e4);throw new exceptions_1[(_0x4379f1(0x1e9))+(_0x4379f1(0x1b2))](_0x4379f1(0x1be)+'tion\x20error',(_0x4d0d47=_0x24c8f3[_0x4379f1(0x1aa)])===null||_0x4d0d47===void(-0xf32+0x75d*-0x2+0x77b*0x4)?void(0x13*-0x13+0x1149+-0xfe0):_0x4d0d47[_0x4379f1(0x1c3)]());}const _0x18d668={};return _0x18d668[_0x4379f1(0x1d4)]=_0xa553ab,_0x18d668;});}['apikey'](_0x59a13d){var _0x1539f7;return __awaiter(this,void(0x12f9+-0x1e2f+0xb36),void(0x1*-0x1e90+0x6*0x3b0+0x21c*0x4),function*(){const _0x2e0071=a52_0x4979,_0x60978b=(-0x671+-0x11ab*-0x1+-0x59d*0x2,uuid_1['v4'])()[_0x2e0071(0x1d8)+'e'](),_0xf5e5ce={};_0xf5e5ce[_0x2e0071(0x1b9)]=_0x60978b;const _0x510c4d=yield this[_0x2e0071(0x1a2)][_0x2e0071(0x1ba)][_0x2e0071(0x1dc)](_0xf5e5ce,_0x59a13d[_0x2e0071(0x1e0)+'me']);if(_0x510c4d[_0x2e0071(0x1aa)]){const _0x1decf8={};_0x1decf8['localError']=AuthService[_0x2e0071(0x1db)]+_0x2e0071(0x1d6),_0x1decf8['error']=_0x510c4d[_0x2e0071(0x1aa)],this[_0x2e0071(0x1bc)][_0x2e0071(0x1aa)](_0x1decf8);throw new exceptions_1[(_0x2e0071(0x1e9))+(_0x2e0071(0x1b2))](_0x2e0071(0x1be)+'tion\x20error',(_0x1539f7=_0x510c4d[_0x2e0071(0x1aa)])===null||_0x1539f7===void(0x13*0x95+-0x7f*-0x3e+-0x1*0x29d1)?void(-0x1c66*-0x1+-0x1a11*0x1+-0xc7*0x3):_0x1539f7[_0x2e0071(0x1c3)]());}const _0x9e404={};return _0x9e404[_0x2e0071(0x1b9)]=_0x60978b,_0x9e404;});}[a52_0x541b2b(0x19e)+'sh'](_0x4e88d9){return __awaiter(this,void(0x1632+0xda0*0x2+-0x3172),void(-0x1*-0x26e6+0x1c91+-0x4377),function*(){const _0x35d23b=a52_0x4979,_0x88bebe=this[_0x35d23b(0x199)+'ice'][_0x35d23b(0x1b8)](_0x35d23b(0x198)+'TION');return yield this[_0x88bebe[_0x35d23b(0x1b4)]](_0x4e88d9);});}['refreshTok'+'en']({oldToken:_0x46220c}){return __awaiter(this,void(-0x1b*0x131+0x1cb8+0x373),void(0xd2d*0x2+-0xd74+-0xce6),function*(){const _0xb24693=a52_0x4979;if(!(0x1*0x10be+0x2*-0x1029+0xf94,class_validator_1['isJWT'])(_0x46220c))throw new exceptions_1[(_0xb24693(0x1e9))+(_0xb24693(0x1b2))](_0xb24693(0x1b0)+'ldToken\x22');try{const _0x26b12d=this[_0xb24693(0x199)+'ice'][_0xb24693(0x1b8)](_0xb24693(0x198)+_0xb24693(0x1af))[_0xb24693(0x19d)],_0x163eb9={};_0x163eb9[_0xb24693(0x1a8)+'ration']=!![];const _0x875bcb=(-0x134d*-0x2+0x25d2+0x2636*-0x2,jsonwebtoken_1[_0xb24693(0x1e2)])(_0x46220c,_0x26b12d['SECRET'],_0x163eb9),_0x414f3d=yield this[_0xb24693(0x1a2)][_0xb24693(0x1ba)][_0xb24693(0x19b)](_0x875bcb[_0xb24693(0x1e0)+'me']),_0x56f854={};_0x56f854['ignoreExpi'+_0xb24693(0x1a5)]=!![];const _0x252863=(-0x2*-0xd79+-0x25e8+0xaf6,jsonwebtoken_1[_0xb24693(0x1e2)])(_0x414f3d[_0xb24693(0x1d4)],_0x26b12d[_0xb24693(0x1c1)],_0x56f854);if(_0x875bcb['tokenId']!==_0x252863[_0xb24693(0x1d5)])throw new exceptions_1[(_0xb24693(0x1e9))+(_0xb24693(0x1b2))](_0xb24693(0x1b0)+_0xb24693(0x1cc));const _0x48937b={};_0x48937b[_0xb24693(0x1e0)+'me']=_0x875bcb['instanceNa'+'me'];const _0x2af8ee={'jwt':(yield this['jwt'](_0x48937b))[_0xb24693(0x1d4)],'instanceName':_0x875bcb[_0xb24693(0x1e0)+'me']};try{const _0x5e25b2=yield this[_0xb24693(0x1a2)][_0xb24693(0x1d7)][_0xb24693(0x19b)](_0x875bcb[_0xb24693(0x1e0)+'me']);if((_0x5e25b2===null||_0x5e25b2===void(-0x2*0x340+-0x1d9e+-0xc9*-0x2e)?void(0x733+-0x48c+-0x1*0x2a7):_0x5e25b2[_0xb24693(0x19f)])&&this[_0xb24693(0x199)+'ice'][_0xb24693(0x1b8)](_0xb24693(0x1c8))[_0xb24693(0x1e5)][_0xb24693(0x1d3)+_0xb24693(0x1bd)]){const _0x246f3e={};_0x246f3e['baseURL']=_0x5e25b2[_0xb24693(0x1d9)];const _0x317a9d=axios_1[_0xb24693(0x1b6)][_0xb24693(0x1dc)](_0x246f3e),_0x3fa059={};_0x3fa059['event']=_0xb24693(0x1b1),_0x3fa059[_0xb24693(0x1ca)]=_0x875bcb[_0xb24693(0x1e0)+'me'],_0x3fa059[_0xb24693(0x197)]=_0x2af8ee;const _0x37b79e={};_0x37b79e[_0xb24693(0x1a7)]=this[_0xb24693(0x1a3)][_0xb24693(0x1da)+'s'][_0x875bcb[_0xb24693(0x1e0)+'me']]['wuid'];const _0x3c39b5={};_0x3c39b5[_0xb24693(0x1b3)]=_0x37b79e,yield _0x317a9d['post']('',_0x3fa059,_0x3c39b5);}}catch(_0x111436){this[_0xb24693(0x1bc)][_0xb24693(0x1aa)](_0x111436);}return _0x2af8ee;}catch(_0x94f36d){const _0xc91d9c={};_0xc91d9c[_0xb24693(0x1e7)]=AuthService[_0xb24693(0x1db)]+(_0xb24693(0x1ae)+'ken'),_0xc91d9c[_0xb24693(0x1aa)]=_0x94f36d,this[_0xb24693(0x1bc)][_0xb24693(0x1aa)](_0xc91d9c);throw new exceptions_1[(_0xb24693(0x1e9))+'Exception'](_0xb24693(0x1b0)+_0xb24693(0x1cc));}});}}exports[a52_0x541b2b(0x1dd)+'e']=AuthService;