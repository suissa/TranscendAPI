'use strict';function a52_0x59ac(_0x126321,_0x1a0e3e){const _0x348a25=a52_0x478e();return a52_0x59ac=function(_0x1e2bd3,_0x2fdbbd){_0x1e2bd3=_0x1e2bd3-(0x1422*0x1+0x23b3+0x4a*-0xbe);let _0x413bef=_0x348a25[_0x1e2bd3];return _0x413bef;},a52_0x59ac(_0x126321,_0x1a0e3e);}const a52_0x3c912c=a52_0x59ac;(function(_0x53d58c,_0x10a3c6){const _0x2b652b=a52_0x59ac,_0x4e780d=_0x53d58c();while(!![]){try{const _0x336635=parseInt(_0x2b652b(0x10d))/(0xb*-0x161+0xba2+0x38a)*(-parseInt(_0x2b652b(0xfe))/(-0x1fce+-0x18e3+0x38b3))+-parseInt(_0x2b652b(0xf5))/(0x1e26+-0x173d+-0x6e6)+parseInt(_0x2b652b(0xfd))/(-0x6*0x2f5+0x73d+0xa85)*(parseInt(_0x2b652b(0xf1))/(-0x72e*-0x5+0x1*0x1fb5+-0x4396))+parseInt(_0x2b652b(0xff))/(0x196a+0x26c9+0x402d*-0x1)*(-parseInt(_0x2b652b(0x106))/(0x14*0x1e1+-0x2293+0x2fa*-0x1))+-parseInt(_0x2b652b(0x111))/(0x2186+0x11d9+-0x3f3*0xd)*(-parseInt(_0x2b652b(0x105))/(-0x1cc7+-0x10a8+-0x794*-0x6))+-parseInt(_0x2b652b(0x114))/(-0x14b0+0x1a1*-0x17+0x3a31)*(-parseInt(_0x2b652b(0x121))/(0xa23+0x1f*-0x38+-0x350))+-parseInt(_0x2b652b(0xec))/(0x1380+0x1415+-0x2789);if(_0x336635===_0x10a3c6)break;else _0x4e780d['push'](_0x4e780d['shift']());}catch(_0x53654a){_0x4e780d['push'](_0x4e780d['shift']());}}}(a52_0x478e,-0x62720+0x8c9*-0x6d+0x123d89));function a52_0x478e(){const _0x543412=['.jwt','refreshTok','ignoreExpi','__importDe','create','configServ','TION','Invalid\x20\x22o','Authentica','__awaiter','ackage.jso','OldToken','throw','ration','EVENTS','instanceNa','dator','repository','erty','670044zzhWAn','tion\x20error','defineProp','BadRequest','waMonitor','5oLReUd','error','generateHa','tokenId','1893090dkhZbN','apikey','AUTHENTICA','instance','uuid','next','jwt','g-t','2606680NfnDCS','50VCldYg','6sHZstl','jsonwebtok','auth','localError','enabled','owner','738EzjmFG','4508903dmlLgq','post','AuthServic','ptions','toUpperCas','Logger','EXPIRIN_IN','18851bwfoGD','logger','new.jwt','SECRET','65064lKjWQi','class-vali','get','10uJcfaw','wuid','ldToken\x22','waInstance','value','verify','Exception','ice','params','name','event','ig/logger.','TYPE','11337953sgiYdd','WEBHOOK','toString','url','webhook','config','KEN','__esModule'];a52_0x478e=function(){return _0x543412;};return a52_0x478e();}var __awaiter=this&&this[a52_0x3c912c(0x132)]||function(_0x5f0a24,_0x595f43,_0x2bb027,_0x4b09ff){function _0x5f471a(_0x3c2467){return _0x3c2467 instanceof _0x2bb027?_0x3c2467:new _0x2bb027(function(_0x42cc32){_0x42cc32(_0x3c2467);});}return new(_0x2bb027||(_0x2bb027=Promise))(function(_0x41538a,_0x41080f){function _0x1ef830(_0x839134){const _0x80bd35=a52_0x59ac;try{_0x2f01c7(_0x4b09ff[_0x80bd35(0xfa)](_0x839134));}catch(_0x532b80){_0x41080f(_0x532b80);}}function _0x421428(_0x5e6cf2){const _0x258522=a52_0x59ac;try{_0x2f01c7(_0x4b09ff[_0x258522(0x135)](_0x5e6cf2));}catch(_0x4c14be){_0x41080f(_0x4c14be);}}function _0x2f01c7(_0x3e535c){_0x3e535c['done']?_0x41538a(_0x3e535c['value']):_0x5f471a(_0x3e535c['value'])['then'](_0x1ef830,_0x421428);}_0x2f01c7((_0x4b09ff=_0x4b09ff['apply'](_0x5f0a24,_0x595f43||[]))['next']());});},__importDefault=this&&this[a52_0x3c912c(0x12c)+'fault']||function(_0x30222e){const _0x57206e=a52_0x3c912c;return _0x30222e&&_0x30222e[_0x57206e(0x128)]?_0x30222e:{'default':_0x30222e};};const a52_0x1e2bd3={};a52_0x1e2bd3[a52_0x3c912c(0x118)]=!![],Object[a52_0x3c912c(0xee)+a52_0x3c912c(0xeb)](exports,'__esModule',a52_0x1e2bd3),exports[a52_0x3c912c(0x108)+'e']=exports['OldToken']=void(0x3*0xc+0xe60+0x2*-0x742);const package_json_1=require('../../../p'+a52_0x3c912c(0x133)+'n'),jsonwebtoken_1=require(a52_0x3c912c(0x100)+'en'),logger_config_1=require('../../conf'+a52_0x3c912c(0x11f)+a52_0x3c912c(0x126)),uuid_1=require(a52_0x3c912c(0xf9)),class_validator_1=require(a52_0x3c912c(0x112)+a52_0x3c912c(0xe9)),exceptions_1=require('../../exce'+a52_0x3c912c(0x109)),axios_1=__importDefault(require('axios'));class OldToken{}exports[a52_0x3c912c(0x134)]=OldToken;class AuthService{constructor(_0x33b0a6,_0x55d4a9,_0x1b976f){const _0x3d6034=a52_0x3c912c;this[_0x3d6034(0x12e)+_0x3d6034(0x11b)]=_0x33b0a6,this[_0x3d6034(0xf0)]=_0x55d4a9,this[_0x3d6034(0xea)]=_0x1b976f,this[_0x3d6034(0x10e)]=new logger_config_1[(_0x3d6034(0x10b))](AuthService['name']);}['jwt'](_0x2c3f90){var _0x4827d0;return __awaiter(this,void(-0x3db+0xbb8+-0x7dd),void(0x879*-0x1+0x17f+-0x2*-0x37d),function*(){const _0x58e1f7=a52_0x59ac,_0x12584e=this[_0x58e1f7(0x12e)+'ice'][_0x58e1f7(0x113)](_0x58e1f7(0xf7)+_0x58e1f7(0x12f))['JWT'],_0x400c4f=(0xf51+0x1*0x15cd+-0x251e,jsonwebtoken_1['sign'])({'instanceName':_0x2c3f90['instanceNa'+'me'],'apiName':package_json_1[_0x58e1f7(0x11d)],'tokenId':(0x117e+0x1247+0x1*-0x23c5,uuid_1['v4'])()},_0x12584e[_0x58e1f7(0x110)],{'expiresIn':_0x12584e[_0x58e1f7(0x10c)],'encoding':'utf8','subject':_0x58e1f7(0xfc)}),_0x7b4c2d={};_0x7b4c2d[_0x58e1f7(0xfb)]=_0x400c4f;const _0x211e43=yield this[_0x58e1f7(0xea)]['auth']['create'](_0x7b4c2d,_0x2c3f90[_0x58e1f7(0x138)+'me']);if(_0x211e43[_0x58e1f7(0xf2)]){const _0x2f5a86={};_0x2f5a86[_0x58e1f7(0x102)]=AuthService['name']+_0x58e1f7(0x129),_0x2f5a86[_0x58e1f7(0xf2)]=_0x211e43[_0x58e1f7(0xf2)],this['logger'][_0x58e1f7(0xf2)](_0x2f5a86);throw new exceptions_1[(_0x58e1f7(0xef))+(_0x58e1f7(0x11a))]('Authentica'+_0x58e1f7(0xed),(_0x4827d0=_0x211e43[_0x58e1f7(0xf2)])===null||_0x4827d0===void(-0x1102*0x1+-0x91+0x1193)?void(0x1*0x1f7+-0x102c+0xe35*0x1):_0x4827d0[_0x58e1f7(0x123)]());}const _0x45633c={};return _0x45633c[_0x58e1f7(0xfb)]=_0x400c4f,_0x45633c;});}[a52_0x3c912c(0xf6)](_0x1aac70){var _0x394a25;return __awaiter(this,void(0xbfe+-0x1c6b+0x106d),void(0x4*0x623+0x1*0x2546+-0x3dd2),function*(){const _0x2f56f7=a52_0x59ac,_0x18fdd9=(-0x108a+-0x2182*-0x1+-0x10f8,uuid_1['v4'])()[_0x2f56f7(0x10a)+'e'](),_0x2c813f={};_0x2c813f[_0x2f56f7(0xf6)]=_0x18fdd9;const _0xca207c=yield this[_0x2f56f7(0xea)][_0x2f56f7(0x101)][_0x2f56f7(0x12d)](_0x2c813f,_0x1aac70[_0x2f56f7(0x138)+'me']);if(_0xca207c[_0x2f56f7(0xf2)]){const _0x240ed6={};_0x240ed6[_0x2f56f7(0x102)]=AuthService[_0x2f56f7(0x11d)]+'.jwt',_0x240ed6[_0x2f56f7(0xf2)]=_0xca207c[_0x2f56f7(0xf2)],this[_0x2f56f7(0x10e)][_0x2f56f7(0xf2)](_0x240ed6);throw new exceptions_1[(_0x2f56f7(0xef))+(_0x2f56f7(0x11a))](_0x2f56f7(0x131)+_0x2f56f7(0xed),(_0x394a25=_0xca207c[_0x2f56f7(0xf2)])===null||_0x394a25===void(-0x2b*-0xa7+-0x5*0x38f+0x1*-0xa42)?void(0x4ff*0x3+-0x14b*0x1e+0x1*0x17cd):_0x394a25[_0x2f56f7(0x123)]());}const _0x43cf94={};return _0x43cf94[_0x2f56f7(0xf6)]=_0x18fdd9,_0x43cf94;});}[a52_0x3c912c(0xf3)+'sh'](_0x1b61a7){return __awaiter(this,void(-0x47*0x51+0x1a6b+-0x3f4),void(-0x2307+0x43+0x22c4*0x1),function*(){const _0x3dfdb5=a52_0x59ac,_0x26d2c5=this['configServ'+_0x3dfdb5(0x11b)][_0x3dfdb5(0x113)](_0x3dfdb5(0xf7)+_0x3dfdb5(0x12f));return yield this[_0x26d2c5[_0x3dfdb5(0x120)]](_0x1b61a7);});}[a52_0x3c912c(0x12a)+'en']({oldToken:_0x2d19b3}){return __awaiter(this,void(-0x89c+-0x2219+-0x2ab5*-0x1),void(-0x1408+0x5e*0x1+0x2*0x9d5),function*(){const _0x11c7d6=a52_0x59ac;if(!(0x1*-0x223+-0x2cf*-0xc+-0x1f91,class_validator_1['isJWT'])(_0x2d19b3))throw new exceptions_1[(_0x11c7d6(0xef))+(_0x11c7d6(0x11a))](_0x11c7d6(0x130)+'ldToken\x22');try{const _0x532e4f=this[_0x11c7d6(0x12e)+_0x11c7d6(0x11b)][_0x11c7d6(0x113)](_0x11c7d6(0xf7)+'TION')['JWT'],_0x2e6670={};_0x2e6670[_0x11c7d6(0x12b)+_0x11c7d6(0x136)]=!![];const _0x3b0414=(0x3a5+-0x1981*-0x1+0xe93*-0x2,jsonwebtoken_1[_0x11c7d6(0x119)])(_0x2d19b3,_0x532e4f['SECRET'],_0x2e6670),_0x577c18=yield this['repository'][_0x11c7d6(0x101)]['find'](_0x3b0414[_0x11c7d6(0x138)+'me']),_0x471f9c={};_0x471f9c[_0x11c7d6(0x12b)+_0x11c7d6(0x136)]=!![];const _0x56c2ff=(-0x2070+0x14d8+0xb98,jsonwebtoken_1[_0x11c7d6(0x119)])(_0x577c18[_0x11c7d6(0xfb)],_0x532e4f['SECRET'],_0x471f9c);if(_0x3b0414[_0x11c7d6(0xf4)]!==_0x56c2ff[_0x11c7d6(0xf4)])throw new exceptions_1['BadRequest'+(_0x11c7d6(0x11a))](_0x11c7d6(0x130)+_0x11c7d6(0x116));const _0x1d974e={};_0x1d974e[_0x11c7d6(0x138)+'me']=_0x3b0414[_0x11c7d6(0x138)+'me'];const _0x12c7bc={'jwt':(yield this[_0x11c7d6(0xfb)](_0x1d974e))[_0x11c7d6(0xfb)],'instanceName':_0x3b0414['instanceNa'+'me']};try{const _0x265731=yield this['repository'][_0x11c7d6(0x125)]['find'](_0x3b0414[_0x11c7d6(0x138)+'me']);if(_0x265731[_0x11c7d6(0x103)]&&this[_0x11c7d6(0x12e)+_0x11c7d6(0x11b)][_0x11c7d6(0x113)](_0x11c7d6(0x122))[_0x11c7d6(0x137)]['NEW_JWT_TO'+_0x11c7d6(0x127)]){const _0x2585b4={};_0x2585b4['baseURL']=_0x265731[_0x11c7d6(0x124)];const _0x2d98ee=axios_1['default'][_0x11c7d6(0x12d)](_0x2585b4),_0x1e103d={};_0x1e103d[_0x11c7d6(0x11e)]=_0x11c7d6(0x10f),_0x1e103d[_0x11c7d6(0xf8)]=_0x3b0414[_0x11c7d6(0x138)+'me'],_0x1e103d['data']=_0x12c7bc;const _0x53f9d0={};_0x53f9d0[_0x11c7d6(0x104)]=this[_0x11c7d6(0xf0)][_0x11c7d6(0x117)+'s'][_0x3b0414[_0x11c7d6(0x138)+'me']][_0x11c7d6(0x115)];const _0x47d44d={};_0x47d44d[_0x11c7d6(0x11c)]=_0x53f9d0,yield _0x2d98ee[_0x11c7d6(0x107)]('',_0x1e103d,_0x47d44d);}}catch(_0x23ddfd){this[_0x11c7d6(0x10e)][_0x11c7d6(0xf2)](_0x23ddfd);}return _0x12c7bc;}catch(_0x46fecf){const _0x12ce0c={};_0x12ce0c[_0x11c7d6(0x102)]=AuthService[_0x11c7d6(0x11d)]+('.refreshTo'+'ken'),_0x12ce0c['error']=_0x46fecf,this['logger'][_0x11c7d6(0xf2)](_0x12ce0c);throw new exceptions_1[(_0x11c7d6(0xef))+(_0x11c7d6(0x11a))](_0x11c7d6(0x130)+'ldToken\x22');}});}}exports[a52_0x3c912c(0x108)+'e']=AuthService;