'use strict';function a51_0x295c(){const _0x32b682=['params','jsonwebtok','g-t','OldToken','2142063azWode','tion\x20error','180tIqlAb','1453766GjCdEc','event','.refreshTo','TION','refreshTok','ptions','url','find','erty','webhook','EXPIRIN_IN','TYPE','tokenId','Invalid\x20\x22o','defineProp','value','then','done','.jwt','jwt','JWT','ignoreExpi','__importDe','auth','next','instanceNa','toUpperCas','sign','105DExmwk','Exception','ken','default','wuid','generateHa','1065548CojPMJ','throw','__awaiter','toString','__esModule','7879548Wikjik','SECRET','repository','81976ichdOl','fault','WEBHOOK','uuid','name','ownre','configServ','verify','Authentica','localError','ration','data','534752huvZqq','../../exce','ig/logger.','post','get','ldToken\x22','BadRequest','waMonitor','create','baseURL','2718474UowYEs','apikey','EVENTS','error','new.jwt','utf8','axios','AUTHENTICA','apply','dator','../../conf','ice','ackage.jso','config','logger','AuthServic'];a51_0x295c=function(){return _0x32b682;};return a51_0x295c();}const a51_0x5dd84a=a51_0xd71e;(function(_0x1ef5bc,_0x558bf3){const _0x229ae3=a51_0xd71e,_0x11838b=_0x1ef5bc();while(!![]){try{const _0x1c1bd1=parseInt(_0x229ae3(0xe1))/(-0x14f4+-0x71*0x32+-0x2b07*-0x1)+-parseInt(_0x229ae3(0x103))/(0x16f7+-0x83*-0x26+-0x2a67)+-parseInt(_0x229ae3(0xca))/(-0x2*-0xd8d+0x40f*0x2+-0x2335*0x1)+-parseInt(_0x229ae3(0x10b))/(-0xc7f*-0x1+-0x1974+0xcf9)*(-parseInt(_0x229ae3(0xfd))/(-0x18da+-0x23e3+0x3cc2))+parseInt(_0x229ae3(0x108))/(0x374+0x1*-0xc4b+0x8dd)+parseInt(_0x229ae3(0xde))/(-0x19c*-0x7+-0x8*-0x2bc+-0x4bb*0x7)+-parseInt(_0x229ae3(0xc0))/(0x1*0x10bd+0x176c+-0x1*0x2821)*(parseInt(_0x229ae3(0xe0))/(0x43*0x6c+-0x1*-0x1bef+0x7*-0x806));if(_0x1c1bd1===_0x558bf3)break;else _0x11838b['push'](_0x11838b['shift']());}catch(_0x375ba2){_0x11838b['push'](_0x11838b['shift']());}}}(a51_0x295c,-0x2*0x93073+0x9f2b7+0x13885a));var __awaiter=this&&this[a51_0x5dd84a(0x105)]||function(_0x44795d,_0x8f590f,_0x515fa9,_0x3ed434){function _0x18179f(_0x1f40ff){return _0x1f40ff instanceof _0x515fa9?_0x1f40ff:new _0x515fa9(function(_0xaf9eba){_0xaf9eba(_0x1f40ff);});}return new(_0x515fa9||(_0x515fa9=Promise))(function(_0x49ac93,_0x4c26a8){const _0x131db7=a51_0xd71e;function _0x16cc20(_0x8b88c0){try{_0x2ecea7(_0x3ed434['next'](_0x8b88c0));}catch(_0x4a09da){_0x4c26a8(_0x4a09da);}}function _0x56f5cc(_0x2a4bdd){const _0x3b3f0a=a51_0xd71e;try{_0x2ecea7(_0x3ed434[_0x3b3f0a(0x104)](_0x2a4bdd));}catch(_0x2f54bc){_0x4c26a8(_0x2f54bc);}}function _0x2ecea7(_0x25ae70){const _0x4f11ea=a51_0xd71e;_0x25ae70[_0x4f11ea(0xf2)]?_0x49ac93(_0x25ae70[_0x4f11ea(0xf0)]):_0x18179f(_0x25ae70[_0x4f11ea(0xf0)])[_0x4f11ea(0xf1)](_0x16cc20,_0x56f5cc);}_0x2ecea7((_0x3ed434=_0x3ed434[_0x131db7(0xd2)](_0x44795d,_0x8f590f||[]))[_0x131db7(0xf9)]());});},__importDefault=this&&this[a51_0x5dd84a(0xf7)+a51_0x5dd84a(0x10c)]||function(_0x169ad4){const _0x2e96c8=a51_0x5dd84a;return _0x169ad4&&_0x169ad4[_0x2e96c8(0x107)]?_0x169ad4:{'default':_0x169ad4};};const a51_0x3fc6ea={};a51_0x3fc6ea[a51_0x5dd84a(0xf0)]=!![],Object[a51_0x5dd84a(0xef)+a51_0x5dd84a(0xe9)](exports,a51_0x5dd84a(0x107),a51_0x3fc6ea),exports['AuthServic'+'e']=exports[a51_0x5dd84a(0xdd)]=void(-0x19b8+0x1330+-0x688*-0x1);const package_json_1=require('../../../p'+a51_0x5dd84a(0xd6)+'n'),jsonwebtoken_1=require(a51_0x5dd84a(0xdb)+'en'),logger_config_1=require(a51_0x5dd84a(0xd4)+a51_0x5dd84a(0xc2)+a51_0x5dd84a(0xd7)),uuid_1=require(a51_0x5dd84a(0x10e)),class_validator_1=require('class-vali'+a51_0x5dd84a(0xd3)),exceptions_1=require(a51_0x5dd84a(0xc1)+a51_0x5dd84a(0xe6)),axios_1=__importDefault(require(a51_0x5dd84a(0xd0)));class OldToken{}function a51_0xd71e(_0x2658f6,_0x496340){const _0x1a5b3e=a51_0x295c();return a51_0xd71e=function(_0x57d0ab,_0x4c783f){_0x57d0ab=_0x57d0ab-(0x1896+-0x16e0+-0xfa);let _0x3fc6ea=_0x1a5b3e[_0x57d0ab];return _0x3fc6ea;},a51_0xd71e(_0x2658f6,_0x496340);}exports[a51_0x5dd84a(0xdd)]=OldToken;class AuthService{constructor(_0x27f589,_0x19ae48,_0x2d24f5){const _0x2a83fa=a51_0x5dd84a;this[_0x2a83fa(0x111)+'ice']=_0x27f589,this[_0x2a83fa(0xc7)]=_0x19ae48,this[_0x2a83fa(0x10a)]=_0x2d24f5,this[_0x2a83fa(0xd8)]=new logger_config_1['Logger'](AuthService['name']);}[a51_0x5dd84a(0xf4)](_0x34a7f8){var _0x3d7f6e;return __awaiter(this,void(-0x156*0x8+-0x1655+0x4f*0x6b),void(0x49*-0x18+-0x20a+-0x6*-0x17b),function*(){const _0x5d0c08=a51_0xd71e,_0x439cce=this[_0x5d0c08(0x111)+_0x5d0c08(0xd5)][_0x5d0c08(0xc4)](_0x5d0c08(0xd1)+'TION')[_0x5d0c08(0xf5)],_0x29e979=(0x1fcf+0xce1+-0x2cb0,jsonwebtoken_1[_0x5d0c08(0xfc)])({'instanceName':_0x34a7f8[_0x5d0c08(0xfa)+'me'],'apiName':package_json_1['name'],'tokenId':(0x1084+0x87c+-0x1900,uuid_1['v4'])()},_0x439cce[_0x5d0c08(0x109)],{'expiresIn':_0x439cce[_0x5d0c08(0xeb)],'encoding':_0x5d0c08(0xcf),'subject':_0x5d0c08(0xdc)}),_0x3369ef={};_0x3369ef[_0x5d0c08(0xf4)]=_0x29e979;const _0x1b3c4c=yield this[_0x5d0c08(0x10a)][_0x5d0c08(0xf8)]['create'](_0x3369ef,_0x34a7f8[_0x5d0c08(0xfa)+'me']);if(_0x1b3c4c[_0x5d0c08(0xcd)]){const _0x39e102={};_0x39e102[_0x5d0c08(0xbd)]=AuthService['name']+_0x5d0c08(0xf3),_0x39e102['error']=_0x1b3c4c['error'],this[_0x5d0c08(0xd8)][_0x5d0c08(0xcd)](_0x39e102);throw new exceptions_1[(_0x5d0c08(0xc6))+(_0x5d0c08(0xfe))](_0x5d0c08(0xbc)+_0x5d0c08(0xdf),(_0x3d7f6e=_0x1b3c4c['error'])===null||_0x3d7f6e===void(0x9*-0x117+-0x2*0xaaf+0x1f2d)?void(-0x2*0x6ad+-0x293*-0x1+0xac7):_0x3d7f6e[_0x5d0c08(0x106)]());}const _0x566371={};return _0x566371[_0x5d0c08(0xf4)]=_0x29e979,_0x566371;});}[a51_0x5dd84a(0xcb)](_0x5c37f1){var _0x38d73b;return __awaiter(this,void(0x107a+-0x6*0x60a+0x13c2),void(-0x597*0x3+-0x2171+-0x3236*-0x1),function*(){const _0x3bc7bb=a51_0xd71e,_0x36c59b=(0x2f+-0x1005*0x2+0x1*0x1fdb,uuid_1['v4'])()[_0x3bc7bb(0xfb)+'e'](),_0x512e90={};_0x512e90[_0x3bc7bb(0xcb)]=_0x36c59b;const _0x22645d=yield this[_0x3bc7bb(0x10a)][_0x3bc7bb(0xf8)]['create'](_0x512e90,_0x5c37f1['instanceNa'+'me']);if(_0x22645d[_0x3bc7bb(0xcd)]){const _0x1b04e8={};_0x1b04e8[_0x3bc7bb(0xbd)]=AuthService[_0x3bc7bb(0x10f)]+_0x3bc7bb(0xf3),_0x1b04e8[_0x3bc7bb(0xcd)]=_0x22645d[_0x3bc7bb(0xcd)],this[_0x3bc7bb(0xd8)][_0x3bc7bb(0xcd)](_0x1b04e8);throw new exceptions_1[(_0x3bc7bb(0xc6))+(_0x3bc7bb(0xfe))](_0x3bc7bb(0xbc)+_0x3bc7bb(0xdf),(_0x38d73b=_0x22645d['error'])===null||_0x38d73b===void(-0x17a4+0x19c8+-0x224)?void(-0x1af9+-0x1bce+-0x17b*-0x25):_0x38d73b[_0x3bc7bb(0x106)]());}const _0x425ef2={};return _0x425ef2[_0x3bc7bb(0xcb)]=_0x36c59b,_0x425ef2;});}[a51_0x5dd84a(0x102)+'sh'](_0x5c735a){return __awaiter(this,void(-0x9*-0xc9+-0x1f*-0x89+-0x17a8),void(0xca3+-0xecd*0x1+-0x1*-0x22a),function*(){const _0x3a8411=a51_0xd71e,_0x2a0a0f=this['configServ'+_0x3a8411(0xd5)][_0x3a8411(0xc4)]('AUTHENTICA'+_0x3a8411(0xe4));return yield this[_0x2a0a0f[_0x3a8411(0xec)]](_0x5c735a);});}[a51_0x5dd84a(0xe5)+'en']({oldToken:_0x35115e}){return __awaiter(this,void(0x63*0x55+0xbc*-0x1b+-0xd0b),void(-0x6e7+-0x54c+0xc33),function*(){const _0x25bb47=a51_0xd71e;if(!(0x63*0x18+-0x11*-0x59+-0xf31,class_validator_1['isJWT'])(_0x35115e))throw new exceptions_1['BadRequest'+(_0x25bb47(0xfe))](_0x25bb47(0xee)+_0x25bb47(0xc5));try{const _0x13300a=this[_0x25bb47(0x111)+_0x25bb47(0xd5)][_0x25bb47(0xc4)]('AUTHENTICA'+_0x25bb47(0xe4))[_0x25bb47(0xf5)],_0xd2891a={};_0xd2891a['ignoreExpi'+_0x25bb47(0xbe)]=!![];const _0x563e22=(-0xa54+-0x1*-0x1ac+0x8a8,jsonwebtoken_1['verify'])(_0x35115e,_0x13300a[_0x25bb47(0x109)],_0xd2891a),_0x45ec6d=yield this[_0x25bb47(0x10a)]['auth'][_0x25bb47(0xe8)](_0x563e22[_0x25bb47(0xfa)+'me']),_0x27b2ce={};_0x27b2ce[_0x25bb47(0xf6)+_0x25bb47(0xbe)]=!![];const _0x11c5ea=(-0x10a0+-0x39*-0xad+-0x5f*0x3b,jsonwebtoken_1[_0x25bb47(0x112)])(_0x45ec6d[_0x25bb47(0xf4)],_0x13300a['SECRET'],_0x27b2ce);if(_0x563e22[_0x25bb47(0xed)]!==_0x11c5ea[_0x25bb47(0xed)])throw new exceptions_1['BadRequest'+'Exception'](_0x25bb47(0xee)+_0x25bb47(0xc5));const _0x444aab={};_0x444aab[_0x25bb47(0xfa)+'me']=_0x563e22['instanceNa'+'me'];const _0x54fac6={'jwt':(yield this[_0x25bb47(0xf4)](_0x444aab))[_0x25bb47(0xf4)],'instanceName':_0x563e22[_0x25bb47(0xfa)+'me']};try{const _0x5d6ffb=yield this[_0x25bb47(0x10a)][_0x25bb47(0xea)][_0x25bb47(0xe8)](_0x563e22[_0x25bb47(0xfa)+'me']);if(_0x5d6ffb['enabled']&&this['configServ'+_0x25bb47(0xd5)][_0x25bb47(0xc4)](_0x25bb47(0x10d))[_0x25bb47(0xcc)]['NEW_JWT_TO'+'KEN']){const _0x399eff={};_0x399eff[_0x25bb47(0xc9)]=_0x5d6ffb[_0x25bb47(0xe7)];const _0x4130c0=axios_1[_0x25bb47(0x100)][_0x25bb47(0xc8)](_0x399eff),_0x25f18c={};_0x25f18c[_0x25bb47(0xe2)]=_0x25bb47(0xce),_0x25f18c['instance']=_0x563e22[_0x25bb47(0xfa)+'me'],_0x25f18c[_0x25bb47(0xbf)]=_0x54fac6;const _0x25b78f={};_0x25b78f[_0x25bb47(0x110)]=this[_0x25bb47(0xc7)]['waInstance'+'s'][_0x563e22['instanceNa'+'me']][_0x25bb47(0x101)];const _0x335f4d={};_0x335f4d[_0x25bb47(0xda)]=_0x25b78f,yield _0x4130c0[_0x25bb47(0xc3)]('',_0x25f18c,_0x335f4d);}}catch(_0x306a54){this[_0x25bb47(0xd8)]['error'](_0x306a54);}return _0x54fac6;}catch(_0x5adb99){const _0x53e2b6={};_0x53e2b6['localError']=AuthService['name']+(_0x25bb47(0xe3)+_0x25bb47(0xff)),_0x53e2b6[_0x25bb47(0xcd)]=_0x5adb99,this['logger'][_0x25bb47(0xcd)](_0x53e2b6);throw new exceptions_1[(_0x25bb47(0xc6))+(_0x25bb47(0xfe))]('Invalid\x20\x22o'+_0x25bb47(0xc5));}});}}exports[a51_0x5dd84a(0xd9)+'e']=AuthService;