'use strict';function a52_0x1b67(_0x27af38,_0x5b2bab){const _0x3d42fd=a52_0xd707();return a52_0x1b67=function(_0x36c395,_0x553321){_0x36c395=_0x36c395-(0x4ad+0xc99+-0xfb4);let _0x556b1a=_0x3d42fd[_0x36c395];return _0x556b1a;},a52_0x1b67(_0x27af38,_0x5b2bab);}const a52_0x5d0812=a52_0x1b67;(function(_0x5a9ba3,_0x25c1f4){const _0x14a3f6=a52_0x1b67,_0x436bdc=_0x5a9ba3();while(!![]){try{const _0x2fb03=-parseInt(_0x14a3f6(0x1e0))/(0x1*-0x229f+-0x9bd+-0x2c5d*-0x1)+parseInt(_0x14a3f6(0x1d6))/(0x213f+0x2e2+-0x529*0x7)*(parseInt(_0x14a3f6(0x1e1))/(-0xec1*0x2+0x28*0x5e+-0xed5*-0x1))+-parseInt(_0x14a3f6(0x1a0))/(-0x9ca*0x1+-0x124+0xaf2)+parseInt(_0x14a3f6(0x1b3))/(-0x2570+0x1*0x229b+-0x49*-0xa)+parseInt(_0x14a3f6(0x1bc))/(0x4bd*0x2+-0x12a*0xb+-0xb*-0x4e)*(parseInt(_0x14a3f6(0x1b1))/(-0x4*0x54d+-0x2d7*0x9+-0x2eca*-0x1))+parseInt(_0x14a3f6(0x192))/(0x16cc+0xa*-0x371+0xba6*0x1)*(-parseInt(_0x14a3f6(0x1ab))/(-0x26bd+-0x2031+-0x25*-0x1eb))+-parseInt(_0x14a3f6(0x1d7))/(-0x1*0x1de1+-0x1fe1+0x3dcc)*(-parseInt(_0x14a3f6(0x1d2))/(0x81c+-0x761*-0x5+-0x47f*0xa));if(_0x2fb03===_0x25c1f4)break;else _0x436bdc['push'](_0x436bdc['shift']());}catch(_0x577757){_0x436bdc['push'](_0x436bdc['shift']());}}}(a52_0xd707,0x3fa26+0x3162*0x5d+0x3b*-0x2354));function a52_0xd707(){const _0x58c0a0=['__esModule','dator','error','TION','OldToken','185646HzbRfl','sign','ackage.jso','toUpperCas','get','SECRET','utf8','enabled','AUTHENTICA','name','find','instanceNa','tokenId','class-vali','config','tion\x20error','erty','.jwt','ignoreExpi','fault','params','Authentica','1207448BPrxOZ','__importDe','webhook','localError','117716ujomzj','10RkHxmB','instance','ice','jwt','new.jwt','url','apikey','waMonitor','isJWT','465414pBVcRu','24LVOqCz','TYPE','owner','328YJrqvV','ldToken\x22','Logger','value','baseURL','NEW_JWT_TO','generateHa','.refreshTo','create','configServ','g-t','jsonwebtok','apply','Exception','1459316DBkWoh','refreshTok','axios','BadRequest','event','auth','../../conf','EVENTS','logger','EXPIRIN_IN','JWT','41913iRycIq','Invalid\x20\x22o','wuid','toString','repository','ptions','189YrshwA','defineProp','2539485VmSkUK','verify','AuthServic','ration'];a52_0xd707=function(){return _0x58c0a0;};return a52_0xd707();}var __awaiter=this&&this['__awaiter']||function(_0x51df23,_0x3caec,_0x42cda3,_0x2a8375){function _0x43c10f(_0x301545){return _0x301545 instanceof _0x42cda3?_0x301545:new _0x42cda3(function(_0x1c17eb){_0x1c17eb(_0x301545);});}return new(_0x42cda3||(_0x42cda3=Promise))(function(_0x598f30,_0x52abd9){const _0x232c37=a52_0x1b67;function _0x54dd2f(_0x5c3a20){try{_0x30bb2c(_0x2a8375['next'](_0x5c3a20));}catch(_0x51cdf6){_0x52abd9(_0x51cdf6);}}function _0x337082(_0x5a9988){try{_0x30bb2c(_0x2a8375['throw'](_0x5a9988));}catch(_0x3af759){_0x52abd9(_0x3af759);}}function _0x30bb2c(_0x18b6b4){const _0xdc60d7=a52_0x1b67;_0x18b6b4['done']?_0x598f30(_0x18b6b4[_0xdc60d7(0x195)]):_0x43c10f(_0x18b6b4[_0xdc60d7(0x195)])['then'](_0x54dd2f,_0x337082);}_0x30bb2c((_0x2a8375=_0x2a8375[_0x232c37(0x19e)](_0x51df23,_0x3caec||[]))['next']());});},__importDefault=this&&this[a52_0x5d0812(0x1d3)+a52_0x5d0812(0x1cf)]||function(_0x10f959){const _0x1b20b3=a52_0x5d0812;return _0x10f959&&_0x10f959[_0x1b20b3(0x1b7)]?_0x10f959:{'default':_0x10f959};};const a52_0x556b1a={};a52_0x556b1a[a52_0x5d0812(0x195)]=!![],Object[a52_0x5d0812(0x1b2)+a52_0x5d0812(0x1cc)](exports,a52_0x5d0812(0x1b7),a52_0x556b1a),exports[a52_0x5d0812(0x1b5)+'e']=exports[a52_0x5d0812(0x1bb)]=void(-0x28f*-0x4+-0x15*0x161+-0x12b9*-0x1);const package_json_1=require('../../../p'+a52_0x5d0812(0x1be)+'n'),jsonwebtoken_1=require(a52_0x5d0812(0x19d)+'en'),logger_config_1=require(a52_0x5d0812(0x1a6)+'ig/logger.'+a52_0x5d0812(0x1ca)),uuid_1=require('uuid'),class_validator_1=require(a52_0x5d0812(0x1c9)+a52_0x5d0812(0x1b8)),exceptions_1=require('../../exce'+a52_0x5d0812(0x1b0)),axios_1=__importDefault(require(a52_0x5d0812(0x1a2)));class OldToken{}exports[a52_0x5d0812(0x1bb)]=OldToken;class AuthService{constructor(_0x373e07,_0x527d06,_0xf1169f){const _0x885819=a52_0x5d0812;this[_0x885819(0x19b)+_0x885819(0x1d9)]=_0x373e07,this[_0x885819(0x1de)]=_0x527d06,this['repository']=_0xf1169f,this[_0x885819(0x1a8)]=new logger_config_1[(_0x885819(0x194))](AuthService['name']);}[a52_0x5d0812(0x1da)](_0x28b87d){var _0x23df5b;return __awaiter(this,void(-0x138d+-0xa7f*-0x1+0x90e),void(0x3*0x59d+-0x2122+0x104b),function*(){const _0x1c7bdd=a52_0x1b67,_0x40f55a=this[_0x1c7bdd(0x19b)+_0x1c7bdd(0x1d9)][_0x1c7bdd(0x1c0)]('AUTHENTICA'+_0x1c7bdd(0x1ba))[_0x1c7bdd(0x1aa)],_0x275237=(-0x1dbb*-0x1+0x2+-0x1dbd,jsonwebtoken_1[_0x1c7bdd(0x1bd)])({'instanceName':_0x28b87d[_0x1c7bdd(0x1c7)+'me'],'apiName':package_json_1[_0x1c7bdd(0x1c5)],'tokenId':(0x41c+-0x1008+0xbec,uuid_1['v4'])()},_0x40f55a[_0x1c7bdd(0x1c1)],{'expiresIn':_0x40f55a[_0x1c7bdd(0x1a9)],'encoding':_0x1c7bdd(0x1c2),'subject':_0x1c7bdd(0x19c)}),_0x1a7087={};_0x1a7087[_0x1c7bdd(0x1da)]=_0x275237;const _0x4a5417=yield this[_0x1c7bdd(0x1af)][_0x1c7bdd(0x1a5)][_0x1c7bdd(0x19a)](_0x1a7087,_0x28b87d[_0x1c7bdd(0x1c7)+'me']);if(_0x4a5417[_0x1c7bdd(0x1b9)]){const _0x467fb1={};_0x467fb1[_0x1c7bdd(0x1d5)]=AuthService[_0x1c7bdd(0x1c5)]+'.jwt',_0x467fb1[_0x1c7bdd(0x1b9)]=_0x4a5417[_0x1c7bdd(0x1b9)],this[_0x1c7bdd(0x1a8)][_0x1c7bdd(0x1b9)](_0x467fb1);throw new exceptions_1[(_0x1c7bdd(0x1a3))+'Exception'](_0x1c7bdd(0x1d1)+'tion\x20error',(_0x23df5b=_0x4a5417['error'])===null||_0x23df5b===void(-0x1a80+-0xd*-0x175+0x78f)?void(0x1a1*0x13+0x26af+0x2*-0x22d1):_0x23df5b[_0x1c7bdd(0x1ae)]());}const _0x28eeb0={};return _0x28eeb0[_0x1c7bdd(0x1da)]=_0x275237,_0x28eeb0;});}['apikey'](_0x5d1b6d){var _0x535ad7;return __awaiter(this,void(0x3*0xba7+0xda*0x5+-0x2737),void(0x12*0x31+-0x4*0x78b+0x16*0x137),function*(){const _0x119295=a52_0x1b67,_0x33e13c=(0xbad+0x1d99+-0x2946,uuid_1['v4'])()[_0x119295(0x1bf)+'e'](),_0x5a5e9f={};_0x5a5e9f[_0x119295(0x1dd)]=_0x33e13c;const _0x5f13d4=yield this[_0x119295(0x1af)][_0x119295(0x1a5)][_0x119295(0x19a)](_0x5a5e9f,_0x5d1b6d[_0x119295(0x1c7)+'me']);if(_0x5f13d4[_0x119295(0x1b9)]){const _0x3db113={};_0x3db113['localError']=AuthService['name']+_0x119295(0x1cd),_0x3db113[_0x119295(0x1b9)]=_0x5f13d4[_0x119295(0x1b9)],this[_0x119295(0x1a8)]['error'](_0x3db113);throw new exceptions_1[(_0x119295(0x1a3))+(_0x119295(0x19f))]('Authentica'+_0x119295(0x1cb),(_0x535ad7=_0x5f13d4[_0x119295(0x1b9)])===null||_0x535ad7===void(0xdfa+0x1*0x1b25+0xb*-0x3bd)?void(-0x1*0x72f+-0x4e7*-0x4+-0x1*0xc6d):_0x535ad7['toString']());}const _0x1bc713={};return _0x1bc713[_0x119295(0x1dd)]=_0x33e13c,_0x1bc713;});}[a52_0x5d0812(0x198)+'sh'](_0xb920cd){return __awaiter(this,void(0x23f*0x1+-0xa1f*0x3+-0x76*-0x3d),void(0x23ce+0x1c69*-0x1+-0x765),function*(){const _0x537a94=a52_0x1b67,_0x43b0be=this[_0x537a94(0x19b)+_0x537a94(0x1d9)][_0x537a94(0x1c0)](_0x537a94(0x1c4)+_0x537a94(0x1ba));return yield this[_0x43b0be[_0x537a94(0x1e2)]](_0xb920cd);});}[a52_0x5d0812(0x1a1)+'en']({oldToken:_0x545ffb}){return __awaiter(this,void(0x449*-0x8+-0x1*-0x39f+0x1ea9),void(0x8*0x43f+0x67*-0x2f+-0xf0f),function*(){const _0x374045=a52_0x1b67;if(!(-0x635*-0x3+-0x2*0x8cc+-0x107,class_validator_1[_0x374045(0x1df)])(_0x545ffb))throw new exceptions_1[(_0x374045(0x1a3))+'Exception'](_0x374045(0x1ac)+_0x374045(0x193));try{const _0x13f8c7=this[_0x374045(0x19b)+_0x374045(0x1d9)]['get']('AUTHENTICA'+'TION')['JWT'],_0x27ed89={};_0x27ed89[_0x374045(0x1ce)+_0x374045(0x1b6)]=!![];const _0x11339e=(0x7c1+0x4d9+0xc9a*-0x1,jsonwebtoken_1[_0x374045(0x1b4)])(_0x545ffb,_0x13f8c7[_0x374045(0x1c1)],_0x27ed89),_0x3a0ef9=yield this[_0x374045(0x1af)][_0x374045(0x1a5)][_0x374045(0x1c6)](_0x11339e[_0x374045(0x1c7)+'me']),_0x29a65f={};_0x29a65f[_0x374045(0x1ce)+_0x374045(0x1b6)]=!![];const _0x491824=(0x1de*-0x5+-0x1277+-0x1bcd*-0x1,jsonwebtoken_1[_0x374045(0x1b4)])(_0x3a0ef9[_0x374045(0x1da)],_0x13f8c7[_0x374045(0x1c1)],_0x29a65f);if(_0x11339e[_0x374045(0x1c8)]!==_0x491824['tokenId'])throw new exceptions_1[(_0x374045(0x1a3))+(_0x374045(0x19f))](_0x374045(0x1ac)+_0x374045(0x193));const _0x387dbc={};_0x387dbc[_0x374045(0x1c7)+'me']=_0x11339e[_0x374045(0x1c7)+'me'];const _0x3ee055={'jwt':(yield this[_0x374045(0x1da)](_0x387dbc))['jwt'],'instanceName':_0x11339e[_0x374045(0x1c7)+'me']};try{const _0x3d83f3=yield this[_0x374045(0x1af)][_0x374045(0x1d4)]['find'](_0x11339e[_0x374045(0x1c7)+'me']);if(_0x3d83f3[_0x374045(0x1c3)]&&this[_0x374045(0x19b)+_0x374045(0x1d9)][_0x374045(0x1c0)]('WEBHOOK')[_0x374045(0x1a7)][_0x374045(0x197)+'KEN']){const _0x2d3b5b={};_0x2d3b5b[_0x374045(0x196)]=_0x3d83f3[_0x374045(0x1dc)];const _0x2aad9b=axios_1['default']['create'](_0x2d3b5b),_0x110daa={};_0x110daa[_0x374045(0x1a4)]=_0x374045(0x1db),_0x110daa[_0x374045(0x1d8)]=_0x11339e[_0x374045(0x1c7)+'me'],_0x110daa['data']=_0x3ee055;const _0x44bb08={};_0x44bb08[_0x374045(0x1e3)]=this[_0x374045(0x1de)]['waInstance'+'s'][_0x11339e[_0x374045(0x1c7)+'me']][_0x374045(0x1ad)];const _0x266489={};_0x266489[_0x374045(0x1d0)]=_0x44bb08,yield _0x2aad9b['post']('',_0x110daa,_0x266489);}}catch(_0x4bba23){this[_0x374045(0x1a8)][_0x374045(0x1b9)](_0x4bba23);}return _0x3ee055;}catch(_0x5e2b3b){const _0x5819f5={};_0x5819f5[_0x374045(0x1d5)]=AuthService[_0x374045(0x1c5)]+(_0x374045(0x199)+'ken'),_0x5819f5[_0x374045(0x1b9)]=_0x5e2b3b,this[_0x374045(0x1a8)][_0x374045(0x1b9)](_0x5819f5);throw new exceptions_1[(_0x374045(0x1a3))+(_0x374045(0x19f))](_0x374045(0x1ac)+_0x374045(0x193));}});}}exports[a52_0x5d0812(0x1b5)+'e']=AuthService;