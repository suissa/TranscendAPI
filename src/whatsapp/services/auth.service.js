'use strict';const a52_0x1c7d48=a52_0x24c7;(function(_0x48479f,_0x461e94){const _0x3651da=a52_0x24c7,_0x27db52=_0x48479f();while(!![]){try{const _0x5b043f=parseInt(_0x3651da(0x20b))/(0x402+0x1*0x142d+-0x182e)+-parseInt(_0x3651da(0x202))/(0x21e1+-0x14e7+-0xcf8)*(parseInt(_0x3651da(0x23f))/(-0xc75+-0xfb8+0x70c*0x4))+-parseInt(_0x3651da(0x223))/(0xa6a+-0x131+-0x935)*(-parseInt(_0x3651da(0x236))/(-0x3*-0x520+0x4b7*0x2+-0x18c9))+-parseInt(_0x3651da(0x224))/(-0x1980+0x1d68+0x47*-0xe)*(parseInt(_0x3651da(0x1f0))/(0x2e*-0x69+0xfb+0x11ea))+-parseInt(_0x3651da(0x23d))/(0x9*0xfa+0xb1b+0x69f*-0x3)+-parseInt(_0x3651da(0x21e))/(-0x28c+-0x1ee8+0x217d)+parseInt(_0x3651da(0x222))/(-0x3*-0xc62+0x18b*0x7+-0x2fe9)*(parseInt(_0x3651da(0x234))/(0x1318+-0x371*-0x4+-0x10f*0x1f));if(_0x5b043f===_0x461e94)break;else _0x27db52['push'](_0x27db52['shift']());}catch(_0x4da95a){_0x27db52['push'](_0x27db52['shift']());}}}(a52_0x9e13,-0x30c40+0x21f53+0x10*0xce17));var __awaiter=this&&this[a52_0x1c7d48(0x205)]||function(_0x2d9694,_0x57012d,_0x45fbe5,_0x78c629){function _0x216956(_0x4a4c37){return _0x4a4c37 instanceof _0x45fbe5?_0x4a4c37:new _0x45fbe5(function(_0x4db502){_0x4db502(_0x4a4c37);});}return new(_0x45fbe5||(_0x45fbe5=Promise))(function(_0x3851c3,_0x4523b4){const _0x55341e=a52_0x24c7;function _0x5867be(_0x4c66f8){const _0x527849=a52_0x24c7;try{_0x295dab(_0x78c629[_0x527849(0x207)](_0x4c66f8));}catch(_0x54ac06){_0x4523b4(_0x54ac06);}}function _0x3fcc95(_0x331154){const _0xfb2971=a52_0x24c7;try{_0x295dab(_0x78c629[_0xfb2971(0x20d)](_0x331154));}catch(_0x2ea187){_0x4523b4(_0x2ea187);}}function _0x295dab(_0x3f29e6){const _0x1fedaf=a52_0x24c7;_0x3f29e6['done']?_0x3851c3(_0x3f29e6[_0x1fedaf(0x1fd)]):_0x216956(_0x3f29e6[_0x1fedaf(0x1fd)])[_0x1fedaf(0x1f5)](_0x5867be,_0x3fcc95);}_0x295dab((_0x78c629=_0x78c629[_0x55341e(0x23b)](_0x2d9694,_0x57012d||[]))[_0x55341e(0x207)]());});},__importDefault=this&&this[a52_0x1c7d48(0x1f4)+'fault']||function(_0x43e465){const _0x219382=a52_0x1c7d48;return _0x43e465&&_0x43e465[_0x219382(0x22f)]?_0x43e465:{'default':_0x43e465};};function a52_0x9e13(){const _0x2468ed=['value','KEN','ldToken\x22','tion\x20error','OldToken','79252fOuHXH','apikey','.jwt','__awaiter','configServ','next','Logger','TYPE','WEBHOOK','1231091xVrfRf','enabled','throw','SECRET','get','logger','repository','params','waMonitor','JWT','instance','event','TION','sign','Exception','ignoreExpi','EXPIRIN_IN','error','data','4678155TrjwmD','../../conf','AUTHENTICA','create','22830QehvLq','248elYvQO','1278930UQWVTg','../../../p','instanceNa','Invalid\x20\x22o','.refreshTo','utf8','localError','url','wuid','default','AuthServic','__esModule','jwt','auth','axios','ice','6875OJsIXZ','g-t','72830hDoQYg','baseURL','NEW_JWT_TO','owner','ration','apply','dator','9896576TGICqs','BadRequest','45dpkAQZ','Authentica','toString','14FSZvCO','class-vali','tokenId','ptions','__importDe','then','erty','uuid','defineProp','toUpperCas','../../exce','name','verify'];a52_0x9e13=function(){return _0x2468ed;};return a52_0x9e13();}const a52_0x113faf={};a52_0x113faf[a52_0x1c7d48(0x1fd)]=!![],Object[a52_0x1c7d48(0x1f8)+a52_0x1c7d48(0x1f6)](exports,'__esModule',a52_0x113faf),exports[a52_0x1c7d48(0x22e)+'e']=exports[a52_0x1c7d48(0x201)]=void(-0x7*-0x493+-0x8*0x7+-0x1fcd);const package_json_1=require(a52_0x1c7d48(0x225)+'ackage.jso'+'n'),jsonwebtoken_1=require('jsonwebtok'+'en'),logger_config_1=require(a52_0x1c7d48(0x21f)+'ig/logger.'+'config'),uuid_1=require(a52_0x1c7d48(0x1f7)),class_validator_1=require(a52_0x1c7d48(0x1f1)+a52_0x1c7d48(0x23c)),exceptions_1=require(a52_0x1c7d48(0x1fa)+a52_0x1c7d48(0x1f3)),axios_1=__importDefault(require(a52_0x1c7d48(0x232)));class OldToken{}function a52_0x24c7(_0x28b318,_0x580287){const _0x51c462=a52_0x9e13();return a52_0x24c7=function(_0x4d7a43,_0x113faf){_0x4d7a43=_0x4d7a43-(-0x44c+0x564+-0xd7*-0x1);let _0x56c568=_0x51c462[_0x4d7a43];return _0x56c568;},a52_0x24c7(_0x28b318,_0x580287);}exports[a52_0x1c7d48(0x201)]=OldToken;class AuthService{constructor(_0x37d7e4,_0x27142c,_0x5d93f3){const _0xfd12fe=a52_0x1c7d48;this[_0xfd12fe(0x206)+_0xfd12fe(0x233)]=_0x37d7e4,this[_0xfd12fe(0x213)]=_0x27142c,this[_0xfd12fe(0x211)]=_0x5d93f3,this['logger']=new logger_config_1[(_0xfd12fe(0x208))](AuthService[_0xfd12fe(0x1fb)]);}['jwt'](_0x5b14ee){var _0xb1ee22;return __awaiter(this,void(-0x2113*-0x1+0x22bb+-0x43ce),void(0x1f73+0x3e1*-0x5+0xc0e*-0x1),function*(){const _0x47284=a52_0x24c7,_0x245b60=this[_0x47284(0x206)+_0x47284(0x233)]['get'](_0x47284(0x220)+'TION')[_0x47284(0x214)],_0x5453c8=(0x3*0xc2b+0x2b*-0x2d+-0x1cf2,jsonwebtoken_1[_0x47284(0x218)])({'instanceName':_0x5b14ee[_0x47284(0x226)+'me'],'apiName':package_json_1[_0x47284(0x1fb)],'tokenId':(-0xf2+-0x18a0+-0x3*-0x886,uuid_1['v4'])()},_0x245b60[_0x47284(0x20e)],{'expiresIn':_0x245b60[_0x47284(0x21b)],'encoding':_0x47284(0x229),'subject':_0x47284(0x235)}),_0x33f721={};_0x33f721[_0x47284(0x230)]=_0x5453c8;const _0x4d6dea=yield this['repository'][_0x47284(0x231)][_0x47284(0x221)](_0x33f721,_0x5b14ee[_0x47284(0x226)+'me']);if(_0x4d6dea['error']){const _0x36efb6={};_0x36efb6[_0x47284(0x22a)]=AuthService['name']+_0x47284(0x204),_0x36efb6['error']=_0x4d6dea[_0x47284(0x21c)],this['logger'][_0x47284(0x21c)](_0x36efb6);throw new exceptions_1[(_0x47284(0x23e))+'Exception'](_0x47284(0x240)+_0x47284(0x200),(_0xb1ee22=_0x4d6dea[_0x47284(0x21c)])===null||_0xb1ee22===void(-0x180b*0x1+-0x103f*0x1+0x284a)?void(-0xdf5+-0xfcf+0x1e*0xfe):_0xb1ee22[_0x47284(0x1ef)]());}const _0x68e31={};return _0x68e31[_0x47284(0x230)]=_0x5453c8,_0x68e31;});}['apikey'](_0x2277d8){var _0xe786cc;return __awaiter(this,void(0x509+0x1b31+0x1e*-0x113),void(0xfc2*-0x2+0x1796+0x3a*0x23),function*(){const _0x31efc4=a52_0x24c7,_0x202fe8=(0x1fbe+-0x1*0x174d+-0x1*0x871,uuid_1['v4'])()[_0x31efc4(0x1f9)+'e'](),_0x43a1a4={};_0x43a1a4[_0x31efc4(0x203)]=_0x202fe8;const _0x4826e7=yield this[_0x31efc4(0x211)]['auth'][_0x31efc4(0x221)](_0x43a1a4,_0x2277d8[_0x31efc4(0x226)+'me']);if(_0x4826e7[_0x31efc4(0x21c)]){const _0x529f1b={};_0x529f1b[_0x31efc4(0x22a)]=AuthService[_0x31efc4(0x1fb)]+_0x31efc4(0x204),_0x529f1b[_0x31efc4(0x21c)]=_0x4826e7[_0x31efc4(0x21c)],this['logger'][_0x31efc4(0x21c)](_0x529f1b);throw new exceptions_1[(_0x31efc4(0x23e))+'Exception'](_0x31efc4(0x240)+'tion\x20error',(_0xe786cc=_0x4826e7[_0x31efc4(0x21c)])===null||_0xe786cc===void(-0xad8+0x2682+-0x1baa)?void(0x1*0x2263+-0x7d*0x19+0x162e*-0x1):_0xe786cc['toString']());}const _0xe82b66={};return _0xe82b66['apikey']=_0x202fe8,_0xe82b66;});}['generateHa'+'sh'](_0x4dbc33){return __awaiter(this,void(0x269*-0x5+0x116d*0x1+-0x560),void(-0x1*0x2149+-0x67*-0x2b+0x16*0xba),function*(){const _0x34754b=a52_0x24c7,_0x417591=this[_0x34754b(0x206)+_0x34754b(0x233)]['get'](_0x34754b(0x220)+'TION');return yield this[_0x417591[_0x34754b(0x209)]](_0x4dbc33);});}['refreshTok'+'en']({oldToken:_0xd5156d}){return __awaiter(this,void(0x88a+0x24f8+-0x5*0x91a),void(0x1*-0x2101+-0x1*-0x18f9+0x808),function*(){const _0x496efc=a52_0x24c7;if(!(-0x1ea1*0x1+-0x15b9+-0x345a*-0x1,class_validator_1['isJWT'])(_0xd5156d))throw new exceptions_1[(_0x496efc(0x23e))+(_0x496efc(0x219))]('Invalid\x20\x22o'+_0x496efc(0x1ff));try{const _0xbab63b=this[_0x496efc(0x206)+_0x496efc(0x233)][_0x496efc(0x20f)](_0x496efc(0x220)+_0x496efc(0x217))[_0x496efc(0x214)],_0xfbb66c={};_0xfbb66c[_0x496efc(0x21a)+_0x496efc(0x23a)]=!![];const _0x59713e=(-0xa*0x1d8+-0x1c0+0x1430,jsonwebtoken_1[_0x496efc(0x1fc)])(_0xd5156d,_0xbab63b[_0x496efc(0x20e)],_0xfbb66c),_0x103bc8=yield this[_0x496efc(0x211)][_0x496efc(0x231)]['find'](_0x59713e['instanceNa'+'me']),_0x42af75={};_0x42af75[_0x496efc(0x21a)+_0x496efc(0x23a)]=!![];const _0x2a3e2e=(0x1c1*0x3+0xdc7+-0x985*0x2,jsonwebtoken_1['verify'])(_0x103bc8[_0x496efc(0x230)],_0xbab63b[_0x496efc(0x20e)],_0x42af75);if(_0x59713e[_0x496efc(0x1f2)]!==_0x2a3e2e[_0x496efc(0x1f2)])throw new exceptions_1['BadRequest'+(_0x496efc(0x219))]('Invalid\x20\x22o'+'ldToken\x22');const _0x5c82da={};_0x5c82da[_0x496efc(0x226)+'me']=_0x59713e['instanceNa'+'me'];const _0x43de7a={'jwt':(yield this['jwt'](_0x5c82da))[_0x496efc(0x230)],'instanceName':_0x59713e['instanceNa'+'me']};try{const _0x429299=yield this[_0x496efc(0x211)]['webhook']['find'](_0x59713e[_0x496efc(0x226)+'me']);if(_0x429299[_0x496efc(0x20c)]&&this[_0x496efc(0x206)+'ice'][_0x496efc(0x20f)](_0x496efc(0x20a))['EVENTS'][_0x496efc(0x238)+_0x496efc(0x1fe)]){const _0x471cb3={};_0x471cb3[_0x496efc(0x237)]=_0x429299[_0x496efc(0x22b)];const _0x3291b0=axios_1[_0x496efc(0x22d)][_0x496efc(0x221)](_0x471cb3),_0x1184a7={};_0x1184a7[_0x496efc(0x216)]='new.jwt',_0x1184a7[_0x496efc(0x215)]=_0x59713e[_0x496efc(0x226)+'me'],_0x1184a7[_0x496efc(0x21d)]=_0x43de7a;const _0xd68002={};_0xd68002[_0x496efc(0x239)]=this['waMonitor']['waInstance'+'s'][_0x59713e[_0x496efc(0x226)+'me']][_0x496efc(0x22c)];const _0x138417={};_0x138417[_0x496efc(0x212)]=_0xd68002,yield _0x3291b0['post']('',_0x1184a7,_0x138417);}}catch(_0x42bb28){this['logger'][_0x496efc(0x21c)](_0x42bb28);}return _0x43de7a;}catch(_0x26bbb9){const _0x237310={};_0x237310[_0x496efc(0x22a)]=AuthService[_0x496efc(0x1fb)]+(_0x496efc(0x228)+'ken'),_0x237310['error']=_0x26bbb9,this[_0x496efc(0x210)]['error'](_0x237310);throw new exceptions_1[(_0x496efc(0x23e))+'Exception'](_0x496efc(0x227)+_0x496efc(0x1ff));}});}}exports['AuthServic'+'e']=AuthService;