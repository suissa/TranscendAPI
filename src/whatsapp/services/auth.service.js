'use strict';const a52_0x3cda30=a52_0xac45;(function(_0x430861,_0x5b8ed6){const _0x430125=a52_0xac45,_0x4465b9=_0x430861();while(!![]){try{const _0x43519e=-parseInt(_0x430125(0x15c))/(0x32d*-0x5+-0x2478+0x345a)*(parseInt(_0x430125(0x15b))/(-0x23d8+-0x1a1+0x257b*0x1))+-parseInt(_0x430125(0x11e))/(0x2333+0xc83*0x2+-0x89a*0x7)*(-parseInt(_0x430125(0x13a))/(0x2140+-0x17bf+-0x97d))+parseInt(_0x430125(0x142))/(0x60b+0x232c*-0x1+-0x23e*-0xd)+-parseInt(_0x430125(0x147))/(-0x5*-0xbd+-0x258b+0x21e0)+-parseInt(_0x430125(0x145))/(0xaf7+0x1*0x2627+-0xd5*0x3b)*(parseInt(_0x430125(0x14d))/(0x29*0xeb+0x1acf+-0xa*0x671))+-parseInt(_0x430125(0x12a))/(0x2*0x46d+0x1e3*-0x6+0x281)+parseInt(_0x430125(0x129))/(0x4*-0x6ed+0x88*0x6+0x188e);if(_0x43519e===_0x5b8ed6)break;else _0x4465b9['push'](_0x4465b9['shift']());}catch(_0x382efd){_0x4465b9['push'](_0x4465b9['shift']());}}}(a52_0x3b56,-0xb8fe2*0x1+0x10c35f+-0x1*-0x5a86d));var __awaiter=this&&this[a52_0x3cda30(0x154)]||function(_0x1b3302,_0xdddb56,_0x506e89,_0x2e896f){function _0x2d3609(_0x318659){return _0x318659 instanceof _0x506e89?_0x318659:new _0x506e89(function(_0x3f850c){_0x3f850c(_0x318659);});}return new(_0x506e89||(_0x506e89=Promise))(function(_0x2d803c,_0x336a9d){const _0x558027=a52_0xac45;function _0x3657a0(_0xe524f3){const _0xe571d3=a52_0xac45;try{_0xc26af(_0x2e896f[_0xe571d3(0x138)](_0xe524f3));}catch(_0x4c93b0){_0x336a9d(_0x4c93b0);}}function _0x37b473(_0x174fe3){const _0x2822f9=a52_0xac45;try{_0xc26af(_0x2e896f[_0x2822f9(0x12f)](_0x174fe3));}catch(_0x43f5ed){_0x336a9d(_0x43f5ed);}}function _0xc26af(_0x1c312e){const _0x33abf3=a52_0xac45;_0x1c312e[_0x33abf3(0x13d)]?_0x2d803c(_0x1c312e[_0x33abf3(0x144)]):_0x2d3609(_0x1c312e[_0x33abf3(0x144)])['then'](_0x3657a0,_0x37b473);}_0xc26af((_0x2e896f=_0x2e896f[_0x558027(0x11f)](_0x1b3302,_0xdddb56||[]))[_0x558027(0x138)]());});},__importDefault=this&&this[a52_0x3cda30(0x11d)+'fault']||function(_0x25cbd4){const _0x1b9de5=a52_0x3cda30;return _0x25cbd4&&_0x25cbd4[_0x1b9de5(0x116)]?_0x25cbd4:{'default':_0x25cbd4};};const a52_0x1686a3={};function a52_0xac45(_0x3a3c74,_0x190167){const _0x2f41ca=a52_0x3b56();return a52_0xac45=function(_0xe116e9,_0x1686a3){_0xe116e9=_0xe116e9-(-0x20ea*-0x1+0x51c+-0x24f4);let _0x2c5e0f=_0x2f41ca[_0xe116e9];return _0x2c5e0f;},a52_0xac45(_0x3a3c74,_0x190167);}a52_0x1686a3[a52_0x3cda30(0x144)]=!![],Object[a52_0x3cda30(0x115)+a52_0x3cda30(0x146)](exports,a52_0x3cda30(0x116),a52_0x1686a3),exports[a52_0x3cda30(0x15e)+'e']=exports[a52_0x3cda30(0x152)]=void(-0x2b9+-0x2202+0x24bb*0x1);const package_json_1=require(a52_0x3cda30(0x148)+a52_0x3cda30(0x150)+'n'),jsonwebtoken_1=require(a52_0x3cda30(0x120)+'en'),logger_config_1=require('../../conf'+'ig/logger.'+a52_0x3cda30(0x12c)),uuid_1=require('uuid'),class_validator_1=require(a52_0x3cda30(0x14f)+a52_0x3cda30(0x155)),exceptions_1=require('../../exce'+a52_0x3cda30(0x117)),axios_1=__importDefault(require(a52_0x3cda30(0x156)));class OldToken{}function a52_0x3b56(){const _0x3374c7=['jwt','Exception','NEW_JWT_TO','tion\x20error','631474zFsFpM','1PqQAaM','.jwt','AuthServic','data','webhook','TYPE','toString','auth','create','repository','JWT','waMonitor','ignoreExpi','wuid','error','defineProp','__esModule','ptions','post','url','localError','isJWT','owner','__importDe','327HBkeOO','apply','jsonwebtok','tokenId','params','.refreshTo','BadRequest','refreshTok','EXPIRIN_IN','KEN','instanceNa','33456170MOdFqZ','10490436PwUnTi','logger','config','configServ','EVENTS','throw','apikey','ration','AUTHENTICA','name','WEBHOOK','Logger','generateHa','toUpperCas','next','ice','7892bmIwVm','baseURL','verify','done','instance','SECRET','g-t','utf8','971460iejpWq','new.jwt','value','3535MtNmwg','erty','6175152dfnDyi','../../../p','ken','event','Invalid\x20\x22o','find','8440sMCFWq','TION','class-vali','ackage.jso','ldToken\x22','OldToken','get','__awaiter','dator','axios'];a52_0x3b56=function(){return _0x3374c7;};return a52_0x3b56();}exports[a52_0x3cda30(0x152)]=OldToken;class AuthService{constructor(_0x29dfba,_0x1d83fb,_0x510600){const _0x5f4c68=a52_0x3cda30;this['configServ'+_0x5f4c68(0x139)]=_0x29dfba,this[_0x5f4c68(0x167)]=_0x1d83fb,this[_0x5f4c68(0x165)]=_0x510600,this[_0x5f4c68(0x12b)]=new logger_config_1[(_0x5f4c68(0x135))](AuthService[_0x5f4c68(0x133)]);}[a52_0x3cda30(0x157)](_0xeea1ad){var _0x27bf8f;return __awaiter(this,void(0x12ad+-0x1*0xec3+0x2*-0x1f5),void(0xa99+-0xaa8+0x5*0x3),function*(){const _0x38516e=a52_0xac45,_0x1eb6ab=this[_0x38516e(0x12d)+_0x38516e(0x139)][_0x38516e(0x153)](_0x38516e(0x132)+_0x38516e(0x14e))[_0x38516e(0x166)],_0x2510c7=(-0xe0a+0x115*0xd+0x7*-0x1,jsonwebtoken_1['sign'])({'instanceName':_0xeea1ad['instanceNa'+'me'],'apiName':package_json_1[_0x38516e(0x133)],'tokenId':(-0xd90+0xad9+0x2b7,uuid_1['v4'])()},_0x1eb6ab['SECRET'],{'expiresIn':_0x1eb6ab[_0x38516e(0x126)],'encoding':_0x38516e(0x141),'subject':_0x38516e(0x140)}),_0x34e9a1={};_0x34e9a1[_0x38516e(0x157)]=_0x2510c7;const _0x251377=yield this[_0x38516e(0x165)][_0x38516e(0x163)][_0x38516e(0x164)](_0x34e9a1,_0xeea1ad[_0x38516e(0x128)+'me']);if(_0x251377[_0x38516e(0x114)]){const _0x39f7ef={};_0x39f7ef['localError']=AuthService[_0x38516e(0x133)]+_0x38516e(0x15d),_0x39f7ef['error']=_0x251377['error'],this[_0x38516e(0x12b)]['error'](_0x39f7ef);throw new exceptions_1[(_0x38516e(0x124))+'Exception']('Authentica'+'tion\x20error',(_0x27bf8f=_0x251377[_0x38516e(0x114)])===null||_0x27bf8f===void(-0x755*-0x5+0x2070+-0x4519)?void(-0x1092+-0x212f*0x1+-0x2f*-0x10f):_0x27bf8f[_0x38516e(0x162)]());}const _0x2764dd={};return _0x2764dd[_0x38516e(0x157)]=_0x2510c7,_0x2764dd;});}[a52_0x3cda30(0x130)](_0x3e3635){var _0x359ef6;return __awaiter(this,void(0x8a9+0x55*-0x65+0x31c*0x8),void(0x116+-0x1628+0x1512),function*(){const _0x24b099=a52_0xac45,_0x2ccea1=(-0xf2+-0xf24+0x1016,uuid_1['v4'])()[_0x24b099(0x137)+'e'](),_0x3ab40b={};_0x3ab40b[_0x24b099(0x130)]=_0x2ccea1;const _0x2cfcc9=yield this[_0x24b099(0x165)][_0x24b099(0x163)]['create'](_0x3ab40b,_0x3e3635[_0x24b099(0x128)+'me']);if(_0x2cfcc9[_0x24b099(0x114)]){const _0x34bf71={};_0x34bf71[_0x24b099(0x11a)]=AuthService[_0x24b099(0x133)]+'.jwt',_0x34bf71[_0x24b099(0x114)]=_0x2cfcc9['error'],this[_0x24b099(0x12b)][_0x24b099(0x114)](_0x34bf71);throw new exceptions_1[(_0x24b099(0x124))+(_0x24b099(0x158))]('Authentica'+_0x24b099(0x15a),(_0x359ef6=_0x2cfcc9[_0x24b099(0x114)])===null||_0x359ef6===void(-0x1606+-0x355*0x1+-0x195b*-0x1)?void(0x1fb7+-0x9ff+-0x2b7*0x8):_0x359ef6[_0x24b099(0x162)]());}const _0xbf70b8={};return _0xbf70b8[_0x24b099(0x130)]=_0x2ccea1,_0xbf70b8;});}[a52_0x3cda30(0x136)+'sh'](_0x383de3){return __awaiter(this,void(0x3f9+-0x79*0x2d+0x114c),void(-0x1*-0x22e3+0x1291+-0x3574),function*(){const _0x3a65a2=a52_0xac45,_0x4bf5f3=this[_0x3a65a2(0x12d)+'ice'][_0x3a65a2(0x153)]('AUTHENTICA'+'TION');return yield this[_0x4bf5f3[_0x3a65a2(0x161)]](_0x383de3);});}[a52_0x3cda30(0x125)+'en']({oldToken:_0x5496ca}){return __awaiter(this,void(-0x5a5+0x1dc6+-0x1821),void(-0x22d9+-0x4*0x308+-0x1*-0x2ef9),function*(){const _0x31770a=a52_0xac45;if(!(-0x2320*0x1+0xdfd*-0x1+-0x21*-0x17d,class_validator_1[_0x31770a(0x11b)])(_0x5496ca))throw new exceptions_1['BadRequest'+(_0x31770a(0x158))]('Invalid\x20\x22o'+'ldToken\x22');try{const _0x58b4d2=this[_0x31770a(0x12d)+_0x31770a(0x139)]['get'](_0x31770a(0x132)+_0x31770a(0x14e))[_0x31770a(0x166)],_0x3f5323={};_0x3f5323[_0x31770a(0x112)+_0x31770a(0x131)]=!![];const _0x4a3caf=(0x1*0x11fa+0x3*-0x687+0x19b,jsonwebtoken_1['verify'])(_0x5496ca,_0x58b4d2['SECRET'],_0x3f5323),_0x2a3652=yield this[_0x31770a(0x165)][_0x31770a(0x163)][_0x31770a(0x14c)](_0x4a3caf['instanceNa'+'me']),_0x46091f={};_0x46091f[_0x31770a(0x112)+_0x31770a(0x131)]=!![];const _0x2b3aba=(0x1598+-0x2020+-0x8*-0x151,jsonwebtoken_1[_0x31770a(0x13c)])(_0x2a3652[_0x31770a(0x157)],_0x58b4d2[_0x31770a(0x13f)],_0x46091f);if(_0x4a3caf[_0x31770a(0x121)]!==_0x2b3aba[_0x31770a(0x121)])throw new exceptions_1[(_0x31770a(0x124))+(_0x31770a(0x158))](_0x31770a(0x14b)+_0x31770a(0x151));const _0x579662={};_0x579662['instanceNa'+'me']=_0x4a3caf[_0x31770a(0x128)+'me'];const _0x143427={'jwt':(yield this['jwt'](_0x579662))['jwt'],'instanceName':_0x4a3caf[_0x31770a(0x128)+'me']};try{const _0xd9f873=yield this[_0x31770a(0x165)][_0x31770a(0x160)]['find'](_0x4a3caf['instanceNa'+'me']);if((_0xd9f873===null||_0xd9f873===void(0x1652+-0x224e+0xbfc)?void(0x1735+-0x319*0x5+-0x7b8):_0xd9f873['enabled'])&&this[_0x31770a(0x12d)+_0x31770a(0x139)]['get'](_0x31770a(0x134))[_0x31770a(0x12e)][_0x31770a(0x159)+_0x31770a(0x127)]){const _0x319e3d={};_0x319e3d[_0x31770a(0x13b)]=_0xd9f873[_0x31770a(0x119)];const _0x28fbce=axios_1['default']['create'](_0x319e3d),_0x31470c={};_0x31470c[_0x31770a(0x14a)]=_0x31770a(0x143),_0x31470c[_0x31770a(0x13e)]=_0x4a3caf[_0x31770a(0x128)+'me'],_0x31470c[_0x31770a(0x15f)]=_0x143427;const _0x37dc7b={};_0x37dc7b[_0x31770a(0x11c)]=this['waMonitor']['waInstance'+'s'][_0x4a3caf[_0x31770a(0x128)+'me']][_0x31770a(0x113)];const _0x14c352={};_0x14c352[_0x31770a(0x122)]=_0x37dc7b,yield _0x28fbce[_0x31770a(0x118)]('',_0x31470c,_0x14c352);}}catch(_0x2e10d4){this[_0x31770a(0x12b)][_0x31770a(0x114)](_0x2e10d4);}return _0x143427;}catch(_0x3e41c0){const _0x1581de={};_0x1581de[_0x31770a(0x11a)]=AuthService[_0x31770a(0x133)]+(_0x31770a(0x123)+_0x31770a(0x149)),_0x1581de['error']=_0x3e41c0,this[_0x31770a(0x12b)]['error'](_0x1581de);throw new exceptions_1['BadRequest'+'Exception'](_0x31770a(0x14b)+_0x31770a(0x151));}});}}exports[a52_0x3cda30(0x15e)+'e']=AuthService;