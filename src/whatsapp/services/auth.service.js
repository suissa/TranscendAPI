'use strict';const a51_0x568b16=a51_0x431c;(function(_0x1f9e4d,_0x34d16a){const _0x211e95=a51_0x431c,_0x149850=_0x1f9e4d();while(!![]){try{const _0x3e6146=-parseInt(_0x211e95(0x131))/(-0xaa*0x2b+0x2*0xc19+0x45d)*(parseInt(_0x211e95(0x123))/(0x8*-0x359+-0x1b7f+0x3649))+parseInt(_0x211e95(0x11f))/(-0x2*0xa1d+-0x1ca7+0x30e4)*(-parseInt(_0x211e95(0x117))/(-0x2fc+0x1b9a*-0x1+0x1e9a))+-parseInt(_0x211e95(0xfc))/(0x113*-0x19+0x152a+0x5b6)+parseInt(_0x211e95(0xf6))/(0x24d6+0x1f31+-0x4401)*(-parseInt(_0x211e95(0x11c))/(0x21ad+-0x1004+-0x3d*0x4a))+parseInt(_0x211e95(0x129))/(-0xe97+-0x1c87*0x1+0x2b26)+parseInt(_0x211e95(0x110))/(0x14d6+-0x25db+-0x76*-0x25)+-parseInt(_0x211e95(0x12a))/(0xd5*-0x20+0x2df+-0x17cb*-0x1)*(-parseInt(_0x211e95(0x12d))/(0x17a3+-0x1cc6+0x52e));if(_0x3e6146===_0x34d16a)break;else _0x149850['push'](_0x149850['shift']());}catch(_0x252a52){_0x149850['push'](_0x149850['shift']());}}}(a51_0x96c6,0xf3a79+-0x22505*0x9+0xec896));var __awaiter=this&&this['__awaiter']||function(_0x3dc57a,_0x51e922,_0x3f3016,_0x28d8d7){function _0x5ade80(_0x3def35){return _0x3def35 instanceof _0x3f3016?_0x3def35:new _0x3f3016(function(_0xc5fcd0){_0xc5fcd0(_0x3def35);});}return new(_0x3f3016||(_0x3f3016=Promise))(function(_0x5e864d,_0xb4fba4){const _0x43a13c=a51_0x431c;function _0x3502d6(_0x164cfc){const _0x35e19a=a51_0x431c;try{_0x294716(_0x28d8d7[_0x35e19a(0xf5)](_0x164cfc));}catch(_0x856890){_0xb4fba4(_0x856890);}}function _0x4e99a8(_0x3c3d1f){const _0x33dd7b=a51_0x431c;try{_0x294716(_0x28d8d7[_0x33dd7b(0x12f)](_0x3c3d1f));}catch(_0xbd281d){_0xb4fba4(_0xbd281d);}}function _0x294716(_0x1e6e29){const _0x1db108=a51_0x431c;_0x1e6e29[_0x1db108(0x12c)]?_0x5e864d(_0x1e6e29[_0x1db108(0xeb)]):_0x5ade80(_0x1e6e29[_0x1db108(0xeb)])[_0x1db108(0x108)](_0x3502d6,_0x4e99a8);}_0x294716((_0x28d8d7=_0x28d8d7[_0x43a13c(0xf7)](_0x3dc57a,_0x51e922||[]))[_0x43a13c(0xf5)]());});},__importDefault=this&&this['__importDe'+a51_0x568b16(0x10d)]||function(_0x1d1ce6){const _0x49261e=a51_0x568b16;return _0x1d1ce6&&_0x1d1ce6[_0x49261e(0x10a)]?_0x1d1ce6:{'default':_0x1d1ce6};};const a51_0x52796a={};a51_0x52796a[a51_0x568b16(0xeb)]=!![],Object[a51_0x568b16(0xfd)+'erty'](exports,'__esModule',a51_0x52796a),exports[a51_0x568b16(0xf9)+'e']=exports[a51_0x568b16(0x116)]=void(0x2575+-0x279*-0xa+-0x3e2f*0x1);function a51_0x431c(_0x417842,_0x3c3b32){const _0x57a6a6=a51_0x96c6();return a51_0x431c=function(_0x407fa0,_0x52796a){_0x407fa0=_0x407fa0-(-0x1af8+-0x1b*-0xf3+0x23e);let _0x5d6759=_0x57a6a6[_0x407fa0];return _0x5d6759;},a51_0x431c(_0x417842,_0x3c3b32);}const package_json_1=require(a51_0x568b16(0x11e)+'ackage.jso'+'n'),jsonwebtoken_1=require('jsonwebtok'+'en'),logger_config_1=require('../../conf'+a51_0x568b16(0xed)+'config'),uuid_1=require('uuid'),class_validator_1=require(a51_0x568b16(0x115)+a51_0x568b16(0x139)),exceptions_1=require(a51_0x568b16(0x11a)+a51_0x568b16(0x109)),axios_1=__importDefault(require(a51_0x568b16(0x132)));class OldToken{}exports[a51_0x568b16(0x116)]=OldToken;function a51_0x96c6(){const _0x13e9cd=['create','done','3833302VQSlgQ','logger','throw','Authentica','848bYLzQh','axios','error','BadRequest','instanceNa','auth','instance','enabled','dator','WEBHOOK','generateHa','verify','g-t','jwt','Exception','isJWT','value','ice','ig/logger.','Logger','waInstance','ignoreExpi','KEN','name','configServ','tokenId','next','24OWCVZl','apply','JWT','AuthServic','TYPE','event','6297560xccvzi','defineProp','TION','AUTHENTICA','refreshTok','ownre','waMonitor','baseURL','ration','url','post','utf8','then','ptions','__esModule','get','find','fault','webhook','localError','10851453ykdbHj','EXPIRIN_IN','EVENTS','SECRET','toString','class-vali','OldToken','68XVUbaO','NEW_JWT_TO','apikey','../../exce','data','2278829DwDKQO','wuid','../../../p','35436fSiVOW','repository','ldToken\x22','tion\x20error','3084ipSRvW','toUpperCas','Invalid\x20\x22o','new.jwt','ken','.jwt','6227752QvqaNT','80CjTgeF'];a51_0x96c6=function(){return _0x13e9cd;};return a51_0x96c6();}class AuthService{constructor(_0x26c446,_0x21ae43,_0x5aa4fb){const _0x40c073=a51_0x568b16;this[_0x40c073(0xf3)+_0x40c073(0xec)]=_0x26c446,this[_0x40c073(0x102)]=_0x21ae43,this[_0x40c073(0x120)]=_0x5aa4fb,this[_0x40c073(0x12e)]=new logger_config_1[(_0x40c073(0xee))](AuthService['name']);}[a51_0x568b16(0xe8)](_0x2b25e4){var _0xde0b8b;return __awaiter(this,void(0x1713+0x2c*0xba+0x3d*-0xe7),void(0xd32+0x1*0x189d+-0x25cf*0x1),function*(){const _0x54a430=a51_0x431c,_0x32288e=this[_0x54a430(0xf3)+_0x54a430(0xec)]['get'](_0x54a430(0xff)+_0x54a430(0xfe))['JWT'],_0x4b9414=(-0xb3*0x1f+0x1635*0x1+0x1*-0x88,jsonwebtoken_1['sign'])({'instanceName':_0x2b25e4[_0x54a430(0x135)+'me'],'apiName':package_json_1[_0x54a430(0xf2)],'tokenId':(-0x6*0x92+0x13cf+-0x1063*0x1,uuid_1['v4'])()},_0x32288e[_0x54a430(0x113)],{'expiresIn':_0x32288e[_0x54a430(0x111)],'encoding':_0x54a430(0x107),'subject':_0x54a430(0xe7)}),_0x4a3ba0={};_0x4a3ba0[_0x54a430(0xe8)]=_0x4b9414;const _0x187fa4=yield this[_0x54a430(0x120)][_0x54a430(0x136)][_0x54a430(0x12b)](_0x4a3ba0,_0x2b25e4[_0x54a430(0x135)+'me']);if(_0x187fa4[_0x54a430(0x133)]){const _0x509ec0={};_0x509ec0[_0x54a430(0x10f)]=AuthService['name']+_0x54a430(0x128),_0x509ec0['error']=_0x187fa4['error'],this[_0x54a430(0x12e)][_0x54a430(0x133)](_0x509ec0);throw new exceptions_1[(_0x54a430(0x134))+(_0x54a430(0xe9))](_0x54a430(0x130)+_0x54a430(0x122),(_0xde0b8b=_0x187fa4['error'])===null||_0xde0b8b===void(0x1625*-0x1+0x1*-0x186b+0x95*0x50)?void(-0x2fe*-0x1+0x2ac+-0x5aa):_0xde0b8b[_0x54a430(0x114)]());}const _0x3f96eb={};return _0x3f96eb[_0x54a430(0xe8)]=_0x4b9414,_0x3f96eb;});}['apikey'](_0x4504a5){var _0x419904;return __awaiter(this,void(0x649+-0xf*-0x1d6+-0x21d3),void(0xa08+-0x43*-0x1f+-0x3a1*0x5),function*(){const _0x25bdb6=a51_0x431c,_0x5764b3=(0x2538+-0x20a+-0x232e,uuid_1['v4'])()[_0x25bdb6(0x124)+'e'](),_0x14adfe={};_0x14adfe[_0x25bdb6(0x119)]=_0x5764b3;const _0xf69004=yield this[_0x25bdb6(0x120)]['auth'][_0x25bdb6(0x12b)](_0x14adfe,_0x4504a5[_0x25bdb6(0x135)+'me']);if(_0xf69004[_0x25bdb6(0x133)]){const _0x4cb6a0={};_0x4cb6a0[_0x25bdb6(0x10f)]=AuthService[_0x25bdb6(0xf2)]+_0x25bdb6(0x128),_0x4cb6a0[_0x25bdb6(0x133)]=_0xf69004[_0x25bdb6(0x133)],this[_0x25bdb6(0x12e)][_0x25bdb6(0x133)](_0x4cb6a0);throw new exceptions_1[(_0x25bdb6(0x134))+(_0x25bdb6(0xe9))](_0x25bdb6(0x130)+'tion\x20error',(_0x419904=_0xf69004[_0x25bdb6(0x133)])===null||_0x419904===void(-0x24ff+0xf3d*-0x1+0x343c)?void(0x9*-0x269+0x7*0x3e9+-0x5ae):_0x419904[_0x25bdb6(0x114)]());}const _0x43d285={};return _0x43d285[_0x25bdb6(0x119)]=_0x5764b3,_0x43d285;});}[a51_0x568b16(0x13b)+'sh'](_0x1b7cad){return __awaiter(this,void(-0x2*-0x10f6+-0x5b2+-0x1c3a),void(0x191+-0x24b9+0x2328),function*(){const _0x5a29aa=a51_0x431c,_0x1aca8e=this['configServ'+'ice'][_0x5a29aa(0x10b)](_0x5a29aa(0xff)+_0x5a29aa(0xfe));return yield this[_0x1aca8e[_0x5a29aa(0xfa)]](_0x1b7cad);});}[a51_0x568b16(0x100)+'en']({oldToken:_0x4bd6e1}){return __awaiter(this,void(0x1f06+0x5b*0x29+-0x9*0x511),void(-0x1c6e+0x149c*0x1+-0x1*-0x7d2),function*(){const _0x4065f6=a51_0x431c;if(!(-0x1*0x140a+0x64a*-0x1+-0x2*-0xd2a,class_validator_1[_0x4065f6(0xea)])(_0x4bd6e1))throw new exceptions_1[(_0x4065f6(0x134))+(_0x4065f6(0xe9))]('Invalid\x20\x22o'+'ldToken\x22');try{const _0x53e784=this[_0x4065f6(0xf3)+_0x4065f6(0xec)][_0x4065f6(0x10b)](_0x4065f6(0xff)+_0x4065f6(0xfe))[_0x4065f6(0xf8)],_0x518361={};_0x518361[_0x4065f6(0xf0)+'ration']=!![];const _0x9299d5=(-0x127d+0xb24+0x759,jsonwebtoken_1[_0x4065f6(0x13c)])(_0x4bd6e1,_0x53e784[_0x4065f6(0x113)],_0x518361),_0x48d290=yield this[_0x4065f6(0x120)]['auth'][_0x4065f6(0x10c)](_0x9299d5[_0x4065f6(0x135)+'me']),_0x1b7699={};_0x1b7699[_0x4065f6(0xf0)+_0x4065f6(0x104)]=!![];const _0x2e8d74=(0x4f*-0x71+0x201b*-0x1+0x42fa*0x1,jsonwebtoken_1['verify'])(_0x48d290[_0x4065f6(0xe8)],_0x53e784[_0x4065f6(0x113)],_0x1b7699);if(_0x9299d5[_0x4065f6(0xf4)]!==_0x2e8d74[_0x4065f6(0xf4)])throw new exceptions_1[(_0x4065f6(0x134))+'Exception'](_0x4065f6(0x125)+_0x4065f6(0x121));const _0x31ea44={};_0x31ea44[_0x4065f6(0x135)+'me']=_0x9299d5['instanceNa'+'me'];const _0xb7d10a={'jwt':(yield this['jwt'](_0x31ea44))[_0x4065f6(0xe8)],'instanceName':_0x9299d5['instanceNa'+'me']};try{const _0x4a6aad=yield this['repository'][_0x4065f6(0x10e)][_0x4065f6(0x10c)](_0x9299d5[_0x4065f6(0x135)+'me']);if(_0x4a6aad[_0x4065f6(0x138)]&&this[_0x4065f6(0xf3)+_0x4065f6(0xec)][_0x4065f6(0x10b)](_0x4065f6(0x13a))[_0x4065f6(0x112)][_0x4065f6(0x118)+_0x4065f6(0xf1)]){const _0x5d6fae={};_0x5d6fae[_0x4065f6(0x103)]=_0x4a6aad[_0x4065f6(0x105)];const _0x4afd5d=axios_1['default'][_0x4065f6(0x12b)](_0x5d6fae),_0x1c6359={};_0x1c6359[_0x4065f6(0xfb)]=_0x4065f6(0x126),_0x1c6359[_0x4065f6(0x137)]=_0x9299d5[_0x4065f6(0x135)+'me'],_0x1c6359[_0x4065f6(0x11b)]=_0xb7d10a;const _0x287aa6={};_0x287aa6[_0x4065f6(0x101)]=this[_0x4065f6(0x102)][_0x4065f6(0xef)+'s'][_0x9299d5[_0x4065f6(0x135)+'me']][_0x4065f6(0x11d)];const _0x2db1b0={};_0x2db1b0['params']=_0x287aa6,yield _0x4afd5d[_0x4065f6(0x106)]('',_0x1c6359,_0x2db1b0);}}catch(_0x39490d){this[_0x4065f6(0x12e)]['error'](_0x39490d);}return _0xb7d10a;}catch(_0x2dfb23){const _0x2da2be={};_0x2da2be['localError']=AuthService[_0x4065f6(0xf2)]+('.refreshTo'+_0x4065f6(0x127)),_0x2da2be[_0x4065f6(0x133)]=_0x2dfb23,this['logger'][_0x4065f6(0x133)](_0x2da2be);throw new exceptions_1[(_0x4065f6(0x134))+(_0x4065f6(0xe9))](_0x4065f6(0x125)+_0x4065f6(0x121));}});}}exports[a51_0x568b16(0xf9)+'e']=AuthService;