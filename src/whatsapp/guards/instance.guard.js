'use strict';const a30_0x443bf6=a30_0x34b6;function a30_0x31e1(){const _0x436efb=['707178cevBSC','p.module','length','ENABLED','\x22instanceN','ForbidenEx','The\x20\x22','value','Broker','waMonitor','nfig','join','2135vFNopH','../../conf','throw','dbServer','path','fetchInsta','../reposit','ptions','instanceLo','459584blhRvN','istsGuard','/instance/','350820igaEhm','../../db/d','ception','ory/reposi','done','21256irVWBm','DB_PREFIX_','../../exce','CONNECTION','\x20does\x20not\x20','ig/path.co','instanceNa','nces','instanceEx','23588048EbjIlY','originalUr','next','ggedGuard','18RgCoeH','params','1806rtVkNo','This\x20name\x20','117FXDjWf','../whatsap','b.connect','ame\x22\x20not\x20p','toArray','__esModule','exist','rovided.','includes','defineProp','existsSync','763688zokrgw','__awaiter','waInstance','325sYjrWP','create','NotFoundEx'];a30_0x31e1=function(){return _0x436efb;};return a30_0x31e1();}(function(_0x5adc92,_0x4cc1b9){const _0x24bba8=a30_0x34b6,_0x3c4ce1=_0x5adc92();while(!![]){try{const _0x3085c5=-parseInt(_0x24bba8(0x181))/(-0x182*0x1+0x202+-0x7f)+-parseInt(_0x24bba8(0x187))/(0x1a38+-0x645*0x2+-0xdac)+parseInt(_0x24bba8(0x1b1))/(-0x2612+0x26*-0x4a+0x3111)*(parseInt(_0x24bba8(0x19c))/(0x45*-0x62+0x4e9*-0x7+0x3ccd))+-parseInt(_0x24bba8(0x184))/(-0xc53*0x2+-0x1*0x5db+0x1e86)*(parseInt(_0x24bba8(0x1b3))/(-0x58b*-0x1+0xe1f+-0x13a4))+-parseInt(_0x24bba8(0x193))/(0x1*0x865+-0x223+-0x63b*0x1)*(parseInt(_0x24bba8(0x1a4))/(-0x3*-0x911+0x19e9+-0x3514))+-parseInt(_0x24bba8(0x1b5))/(-0x76*0x1f+-0xceb*-0x1+0x4*0x5a)*(parseInt(_0x24bba8(0x19f))/(0x21ba+-0x2575+0x3c5))+parseInt(_0x24bba8(0x1ad))/(-0x13*0x7f+0x133c+0x2*-0x4e2);if(_0x3085c5===_0x4cc1b9)break;else _0x3c4ce1['push'](_0x3c4ce1['shift']());}catch(_0x4bbcf3){_0x3c4ce1['push'](_0x3c4ce1['shift']());}}}(a30_0x31e1,0x23*-0xfff+0x5cc4e*0x2+-0x2d74c));var __awaiter=this&&this[a30_0x443bf6(0x182)]||function(_0x368d39,_0x2bf912,_0x198fc6,_0x1bc3cf){function _0x440d23(_0x3bc417){return _0x3bc417 instanceof _0x198fc6?_0x3bc417:new _0x198fc6(function(_0x2b34f0){_0x2b34f0(_0x3bc417);});}return new(_0x198fc6||(_0x198fc6=Promise))(function(_0x3380d6,_0x337f29){const _0x5f0ad8=a30_0x34b6;function _0x2ec47b(_0x5c409b){const _0x48f66f=a30_0x34b6;try{_0x38aa54(_0x1bc3cf[_0x48f66f(0x1af)](_0x5c409b));}catch(_0x4b96ad){_0x337f29(_0x4b96ad);}}function _0x15f8b5(_0x3e1604){const _0x4b7c33=a30_0x34b6;try{_0x38aa54(_0x1bc3cf[_0x4b7c33(0x195)](_0x3e1604));}catch(_0x201e1e){_0x337f29(_0x201e1e);}}function _0x38aa54(_0x46b12e){const _0x1531fa=a30_0x34b6;_0x46b12e[_0x1531fa(0x1a3)]?_0x3380d6(_0x46b12e[_0x1531fa(0x18e)]):_0x440d23(_0x46b12e[_0x1531fa(0x18e)])['then'](_0x2ec47b,_0x15f8b5);}_0x38aa54((_0x1bc3cf=_0x1bc3cf['apply'](_0x368d39,_0x2bf912||[]))[_0x5f0ad8(0x1af)]());});};const a30_0x3c5aed={};a30_0x3c5aed[a30_0x443bf6(0x18e)]=!![],Object[a30_0x443bf6(0x17f)+'erty'](exports,a30_0x443bf6(0x1ba),a30_0x3c5aed),exports['instanceLo'+a30_0x443bf6(0x1b0)]=exports[a30_0x443bf6(0x1ac)+a30_0x443bf6(0x19d)]=void(0xdc2+0x1d53+0x10d*-0x29);const fs_1=require('fs'),path_1=require(a30_0x443bf6(0x197)),path_config_1=require(a30_0x443bf6(0x194)+a30_0x443bf6(0x1a9)+a30_0x443bf6(0x191)),db_connect_1=require(a30_0x443bf6(0x1a0)+a30_0x443bf6(0x1b7)),exceptions_1=require(a30_0x443bf6(0x1a6)+a30_0x443bf6(0x19a)),repository_manager_1=require(a30_0x443bf6(0x199)+a30_0x443bf6(0x1a2)+'tory.manag'+'er'),whatsapp_module_1=require(a30_0x443bf6(0x1b6)+a30_0x443bf6(0x188));function getInstance(_0x56a0fa){return __awaiter(this,void(-0x13*0x34+-0xc99+0x1075),void(-0x2b*0xc5+0x496*-0x2+-0x1*-0x2a43),function*(){const _0x4e8dca=a30_0x34b6,_0x525f37=whatsapp_module_1[_0x4e8dca(0x190)][_0x4e8dca(0x183)+'s'][_0x56a0fa];if(db_connect_1['db'][_0x4e8dca(0x18a)]){const _0x3da543=repository_manager_1['Repository'+_0x4e8dca(0x18f)][_0x4e8dca(0x196)]['db'](db_connect_1['db'][_0x4e8dca(0x1a7)][_0x4e8dca(0x1a5)+'NAME']+'-instances')['collection'](_0x56a0fa);return _0x525f37||(yield _0x3da543['find']({})[_0x4e8dca(0x1b9)]())[_0x4e8dca(0x189)]>0xc4+-0x2672*0x1+0x562*0x7;}return _0x525f37||(0x1*-0xef3+-0x1464+0x53*0x6d,fs_1[_0x4e8dca(0x180)])((-0x2537*-0x1+-0x1*-0x10a5+-0x35dc,path_1[_0x4e8dca(0x192)])(path_config_1['INSTANCE_D'+'IR'],_0x56a0fa));});}function instanceExistsGuard(_0x3f72e0,_0x10e82d,_0x1065d7){return __awaiter(this,void(-0xc0*0x6+0xb*-0x377+-0x1*-0x2a9d),void(0x5*0x293+0x1e88+-0x1*0x2b67),function*(){const _0x3fdc59=a30_0x34b6;if(_0x3f72e0[_0x3fdc59(0x1ae)+'l'][_0x3fdc59(0x17e)](_0x3fdc59(0x19e)+_0x3fdc59(0x185))||_0x3f72e0[_0x3fdc59(0x1ae)+'l'][_0x3fdc59(0x17e)]('/instance/'+_0x3fdc59(0x198)+_0x3fdc59(0x1ab)))return _0x1065d7();const _0x3409fa=_0x3f72e0[_0x3fdc59(0x1b2)];if(!(_0x3409fa===null||_0x3409fa===void(-0x2*0x403+-0x397*-0x7+-0x111b)?void(-0xbf9+-0x937+0x1530):_0x3409fa[_0x3fdc59(0x1aa)+'me']))throw new exceptions_1['BadRequest'+'Exception'](_0x3fdc59(0x18b)+_0x3fdc59(0x1b8)+_0x3fdc59(0x17d));if(!(yield getInstance(_0x3409fa[_0x3fdc59(0x1aa)+'me'])))throw new exceptions_1[(_0x3fdc59(0x186))+(_0x3fdc59(0x1a1))](_0x3fdc59(0x18d)+_0x3409fa[_0x3fdc59(0x1aa)+'me']+('\x22\x20instance'+_0x3fdc59(0x1a8)+_0x3fdc59(0x17c)));_0x1065d7();});}exports['instanceEx'+'istsGuard']=instanceExistsGuard;function a30_0x34b6(_0x56497d,_0x12d148){const _0x4f2007=a30_0x31e1();return a30_0x34b6=function(_0x4bd2a2,_0x3c5aed){_0x4bd2a2=_0x4bd2a2-(0x1*-0x857+-0x171a+0x20ed);let _0x407a91=_0x4f2007[_0x4bd2a2];return _0x407a91;},a30_0x34b6(_0x56497d,_0x12d148);}function instanceLoggedGuard(_0x191770,_0x11b2d4,_0x2fd9ec){return __awaiter(this,void(-0x3*-0xc55+0x2569+-0x4a68*0x1),void(-0x2f*-0xc1+-0x1964+0x359*-0x3),function*(){const _0x2ed54a=a30_0x34b6;if(_0x191770[_0x2ed54a(0x1ae)+'l'][_0x2ed54a(0x17e)](_0x2ed54a(0x19e)+_0x2ed54a(0x185))){const _0x40d598=_0x191770['body'];if(yield getInstance(_0x40d598[_0x2ed54a(0x1aa)+'me']))throw new exceptions_1[(_0x2ed54a(0x18c))+(_0x2ed54a(0x1a1))](_0x2ed54a(0x1b4)+'\x22'+_0x40d598[_0x2ed54a(0x1aa)+'me']+('\x22\x20is\x20alrea'+'dy\x20in\x20use.'));whatsapp_module_1[_0x2ed54a(0x190)][_0x2ed54a(0x183)+'s'][_0x40d598[_0x2ed54a(0x1aa)+'me']]&&delete whatsapp_module_1['waMonitor'][_0x2ed54a(0x183)+'s'][_0x40d598['instanceNa'+'me']];}_0x2fd9ec();});}exports[a30_0x443bf6(0x19b)+a30_0x443bf6(0x1b0)]=instanceLoggedGuard;