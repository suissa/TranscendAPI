'use strict';const a41_0x5a6ef2=a41_0x3477;function a41_0x3477(_0x137c85,_0x184d4e){const _0x2c5f78=a41_0x3baa();return a41_0x3477=function(_0x5002bd,_0x3d8d4c){_0x5002bd=_0x5002bd-(0x4*0x5e1+0x25f6+-0x3cff);let _0x1cf8de=_0x2c5f78[_0x5002bd];return _0x1cf8de;},a41_0x3477(_0x137c85,_0x184d4e);}(function(_0x22d290,_0x2339db){const _0x25cf9f=a41_0x3477,_0x2006e4=_0x22d290();while(!![]){try{const _0x72bc95=parseInt(_0x25cf9f(0xbe))/(-0x1cf+0x2*0x612+-0xa54)*(parseInt(_0x25cf9f(0x9c))/(-0x26c8+-0x2232+0x48fc))+parseInt(_0x25cf9f(0x8a))/(-0x1*0x7+0x2e*0x26+-0xb*0x9e)*(-parseInt(_0x25cf9f(0xa1))/(-0x3cf+0x258e+-0x311*0xb))+parseInt(_0x25cf9f(0x7b))/(0x64*-0x3a+0x2*-0xd2b+-0x3103*-0x1)+-parseInt(_0x25cf9f(0x9a))/(0x10c+0x1131+-0x1237)+parseInt(_0x25cf9f(0xa2))/(-0x1*0x176f+0x4b8*0x4+0x496)*(parseInt(_0x25cf9f(0x85))/(0x2140+-0x8b*0x32+-0x612))+parseInt(_0x25cf9f(0xac))/(0x1d68+0x9*-0x2ec+-0x313*0x1)*(parseInt(_0x25cf9f(0xae))/(-0x56b*0x2+-0x791*0x1+0x1271*0x1))+-parseInt(_0x25cf9f(0xba))/(-0x9d2+0x1*0xbb+0xa7*0xe);if(_0x72bc95===_0x2339db)break;else _0x2006e4['push'](_0x2006e4['shift']());}catch(_0x47a2d7){_0x2006e4['push'](_0x2006e4['shift']());}}}(a41_0x3baa,0x1*-0x32f29+-0x641*0x64+-0xe026e*-0x1));function a41_0x3baa(){const _0x5767de=['update','ERROR:\x20','messageTim','ues','ENABLED','throw','3554694RGfXsk','where','opendirSyn','estamp','1FgGUpR','tor','error','__esModule','readdirSyn','value','push','apply','2757545MKZzBa','assign','asyncItera','find','splice','join','\x20is\x20not\x20de','limit','dbSettings','writeStore','24sDqMgH','encoding','length','fined.','entries','6mboAFx','insertMany','then','t/abstract','owner','key','readFileSy','messageMod','messages','ncIterator','function','__asyncVal','delete','isFile','updateOne','.repositor','348096lUnoQW','return','970958bIGLPZ','unlinkSync','__awaiter','utf-8','MessageQue','1890428jXlsRg','958181TovMDB','log','call','parse','forEach','sort','insertCoun','next','resolve','iterator','252uKofgC','Symbol.asy','152890enPdBd','storePath','ository','$set','../abstrac','done'];a41_0x3baa=function(){return _0x5767de;};return a41_0x3baa();}var __awaiter=this&&this[a41_0x5a6ef2(0x9e)]||function(_0x4ca846,_0x4cbe1b,_0x37c2a7,_0x2d07d0){function _0x1ff52e(_0x20b29c){return _0x20b29c instanceof _0x37c2a7?_0x20b29c:new _0x37c2a7(function(_0x2a4362){_0x2a4362(_0x20b29c);});}return new(_0x37c2a7||(_0x37c2a7=Promise))(function(_0x738af9,_0x4f50c2){const _0x15833d=a41_0x3477;function _0x397eb9(_0x2c8c9d){const _0xc71d4d=a41_0x3477;try{_0x146243(_0x2d07d0[_0xc71d4d(0xa9)](_0x2c8c9d));}catch(_0x5bf88f){_0x4f50c2(_0x5bf88f);}}function _0x2f5d25(_0x52cf14){const _0x165ca1=a41_0x3477;try{_0x146243(_0x2d07d0[_0x165ca1(0xb9)](_0x52cf14));}catch(_0x1cc0c4){_0x4f50c2(_0x1cc0c4);}}function _0x146243(_0x491d91){const _0x939fd=a41_0x3477;_0x491d91[_0x939fd(0xb3)]?_0x738af9(_0x491d91[_0x939fd(0xc3)]):_0x1ff52e(_0x491d91[_0x939fd(0xc3)])[_0x939fd(0x8c)](_0x397eb9,_0x2f5d25);}_0x146243((_0x2d07d0=_0x2d07d0[_0x15833d(0xc5)](_0x4ca846,_0x4cbe1b||[]))[_0x15833d(0xa9)]());});},__asyncValues=this&&this[a41_0x5a6ef2(0x95)+a41_0x5a6ef2(0xb7)]||function(_0x385656){const _0x1d3020=a41_0x5a6ef2;if(!Symbol[_0x1d3020(0x7d)+_0x1d3020(0xbf)])throw new TypeError(_0x1d3020(0xad)+_0x1d3020(0x93)+_0x1d3020(0x81)+_0x1d3020(0x88));var _0x167d5c=_0x385656[Symbol[_0x1d3020(0x7d)+_0x1d3020(0xbf)]],_0x52674e;return _0x167d5c?_0x167d5c['call'](_0x385656):(_0x385656=typeof __values===_0x1d3020(0x94)?__values(_0x385656):_0x385656[Symbol[_0x1d3020(0xab)]](),_0x52674e={},_0x2f5f22(_0x1d3020(0xa9)),_0x2f5f22('throw'),_0x2f5f22(_0x1d3020(0x9b)),_0x52674e[Symbol[_0x1d3020(0x7d)+_0x1d3020(0xbf)]]=function(){return this;},_0x52674e);function _0x2f5f22(_0x4e9733){_0x52674e[_0x4e9733]=_0x385656[_0x4e9733]&&function(_0x5df472){return new Promise(function(_0x584ff8,_0x301dd1){const _0x391ca4=a41_0x3477;_0x5df472=_0x385656[_0x4e9733](_0x5df472),_0x3d13a9(_0x584ff8,_0x301dd1,_0x5df472[_0x391ca4(0xb3)],_0x5df472[_0x391ca4(0xc3)]);});};}function _0x3d13a9(_0x4ad500,_0xdae4c5,_0x262dca,_0x241383){const _0x377a82=_0x1d3020;Promise[_0x377a82(0xaa)](_0x241383)[_0x377a82(0x8c)](function(_0x417853){const _0x2a9930={};_0x2a9930['value']=_0x417853,_0x2a9930['done']=_0x262dca,_0x4ad500(_0x2a9930);},_0xdae4c5);}};const a41_0x1cf8de={};a41_0x1cf8de['value']=!![],Object['defineProp'+'erty'](exports,a41_0x5a6ef2(0xc1),a41_0x1cf8de),exports['MessageRep'+a41_0x5a6ef2(0xb0)]=exports[a41_0x5a6ef2(0xa0)+'ry']=void(-0xeed+0xc0d*-0x1+0x1afa);const path_1=require('path'),abstract_repository_1=require(a41_0x5a6ef2(0xb2)+a41_0x5a6ef2(0x8d)+a41_0x5a6ef2(0x99)+'y'),fs_1=require('fs');class MessageQuery{}exports[a41_0x5a6ef2(0xa0)+'ry']=MessageQuery;class MessageRepository extends abstract_repository_1['Repository']{constructor(_0x1494af,_0x2dd893){const _0x14e222=a41_0x5a6ef2;super(_0x2dd893),this[_0x14e222(0x91)+'el']=_0x1494af,this['configServ'+'ice']=_0x2dd893;}['insert'](_0x97d1d2,_0x539510=![]){return __awaiter(this,void(-0x3e*-0x73+0x14c4+-0x309e),void(-0x1611+-0x293*-0xe+0x1*-0xdf9),function*(){const _0x3e582f=a41_0x3477;if(_0x97d1d2[_0x3e582f(0x87)]===0x2052+0x1ca5+-0x3cf7*0x1)return;try{if(this[_0x3e582f(0x83)][_0x3e582f(0xb8)]&&_0x539510){const _0x59fb20=yield this[_0x3e582f(0x91)+'el'][_0x3e582f(0x8b)]([..._0x97d1d2]),_0x2c3704={};return _0x2c3704[_0x3e582f(0xa8)+'t']=_0x59fb20['length'],_0x2c3704;}if(_0x539510){_0x97d1d2['forEach'](_0x53e10e=>this[_0x3e582f(0x84)]({'path':(-0x2fd*0x4+0xc*-0x164+0x1ca4,path_1[_0x3e582f(0x80)])(this[_0x3e582f(0xaf)],_0x3e582f(0x92),_0x53e10e[_0x3e582f(0x8e)]),'fileName':_0x53e10e['key']['id'],'data':_0x53e10e}));const _0x1a034d={};return _0x1a034d[_0x3e582f(0xa8)+'t']=_0x97d1d2[_0x3e582f(0x87)],_0x1a034d;}const _0x492b30={};return _0x492b30[_0x3e582f(0xa8)+'t']=0x0,_0x492b30;}catch(_0x15f5e5){return console[_0x3e582f(0xa3)](_0x3e582f(0xb5),_0x15f5e5),_0x15f5e5;}finally{_0x97d1d2=undefined;}});}[a41_0x5a6ef2(0x7e)](_0x40b2f6){var _0xb6f0dc,_0x3056f3,_0x4f884a,_0x20373e,_0x544d12,_0x108f67,_0x21496f,_0x374b73,_0x100cc7,_0x5b289e;return __awaiter(this,void(-0xc05+0x135b*-0x1+0x1f60),void(0x1fe5+-0x26ca+0x6e5),function*(){const _0x1da859=a41_0x3477;try{if(this[_0x1da859(0x83)][_0x1da859(0xb8)]){if((_0x544d12=_0x40b2f6===null||_0x40b2f6===void(-0x48*-0x11+-0x160f+-0x1*-0x1147)?void(-0x1f3e+0x2667+-0x729*0x1):_0x40b2f6[_0x1da859(0xbb)])===null||_0x544d12===void(0x214c+0x84d+-0x2999)?void(0x1*0x2ab+0x816+-0xac1*0x1):_0x544d12[_0x1da859(0x8f)]){for(const [_0xd590b5,_0xca5ee0]of Object[_0x1da859(0x89)](_0x40b2f6[_0x1da859(0xbb)][_0x1da859(0x8f)])){_0x40b2f6[_0x1da859(0xbb)]['key.'+_0xd590b5]=_0xca5ee0;}(_0x108f67=_0x40b2f6===null||_0x40b2f6===void(0x1a*0x9a+-0x2485+-0x42d*-0x5)?void(0x5d8*0x1+-0x817+0x23f):_0x40b2f6[_0x1da859(0xbb)])===null||_0x108f67===void(0x184f+0x44*0x53+-0x2e5b)?!![]:delete _0x108f67[_0x1da859(0x8f)];}const _0x543fd6={};return _0x543fd6[_0x1da859(0xb6)+_0x1da859(0xbd)]=-(0x102e+0x2c3+-0x8*0x25e),yield this['messageMod'+'el'][_0x1da859(0x7e)](Object[_0x1da859(0x7c)]({},_0x40b2f6['where']))[_0x1da859(0xa7)](_0x543fd6)[_0x1da859(0x82)]((_0x21496f=_0x40b2f6===null||_0x40b2f6===void(-0x4b7*-0x6+-0x2b4+0x1*-0x1996)?void(0x5fb+0x1*-0x11e6+-0x71*-0x1b):_0x40b2f6[_0x1da859(0x82)])!==null&&_0x21496f!==void(-0x1fc1+-0xf10+-0x11*-0x2c1)?_0x21496f:-0x4aa+0x1a25+-0xd*0x1a7);}const _0x4cb12f=[];if((_0x100cc7=(_0x374b73=_0x40b2f6===null||_0x40b2f6===void(0x20bf+0x4d*-0x37+-0x22*0x7a)?void(0x1483+0x912*0x1+0x1*-0x1d95):_0x40b2f6[_0x1da859(0xbb)])===null||_0x374b73===void(-0x127c*-0x1+-0x2*-0x5ae+-0x1dd8)?void(0x1c9*-0x4+-0x2031+0x2755):_0x374b73[_0x1da859(0x8f)])===null||_0x100cc7===void(0xae+-0xcad+0xbff*0x1)?void(0x1b3+-0x16f*-0x1+-0x322):_0x100cc7['id']){const _0x343eda={};_0x343eda[_0x1da859(0x86)]=_0x1da859(0x9f),_0x4cb12f[_0x1da859(0xc4)](JSON['parse']((-0x2c*0x94+-0x1*-0x24d4+-0xb64,fs_1['readFileSy'+'nc'])((0x2602+0x15f5+-0x3*0x13fd,path_1[_0x1da859(0x80)])(this['storePath'],_0x1da859(0x92),_0x40b2f6[_0x1da859(0xbb)]['owner'],_0x40b2f6[_0x1da859(0xbb)][_0x1da859(0x8f)]['id']+'.json'),_0x343eda)));}else{const _0xd97966={};_0xd97966['encoding']=_0x1da859(0x9f);const _0x2f2f09=(-0x31e*-0x9+-0x8*0x4b4+-0x1ea*-0x5,fs_1[_0x1da859(0xbc)+'c'])((-0x21c7+-0x1796*-0x1+-0x1*-0xa31,path_1[_0x1da859(0x80)])(this[_0x1da859(0xaf)],_0x1da859(0x92),_0x40b2f6['where']['owner']),_0xd97966);try{for(var _0xf8b914=!![],_0x53e0e3=__asyncValues(_0x2f2f09),_0x5868ac;_0x5868ac=yield _0x53e0e3[_0x1da859(0xa9)](),_0xb6f0dc=_0x5868ac[_0x1da859(0xb3)],!_0xb6f0dc;){_0x20373e=_0x5868ac[_0x1da859(0xc3)],_0xf8b914=![];try{const _0x5759a5=_0x20373e;if(_0x5759a5[_0x1da859(0x97)]()){const _0x19cb67={};_0x19cb67[_0x1da859(0x86)]=_0x1da859(0x9f),_0x4cb12f[_0x1da859(0xc4)](JSON[_0x1da859(0xa5)]((0x1e03+0xbcb*-0x3+0x55e,fs_1[_0x1da859(0x90)+'nc'])((-0x17b*-0x14+-0x1*-0x8a2+0x3d3*-0xa,path_1[_0x1da859(0x80)])(this['storePath'],_0x1da859(0x92),_0x40b2f6[_0x1da859(0xbb)][_0x1da859(0x8e)],_0x5759a5['name']),_0x19cb67)));}}finally{_0xf8b914=!![];}}}catch(_0x5c014c){const _0x46b08a={};_0x46b08a[_0x1da859(0xc0)]=_0x5c014c,_0x3056f3=_0x46b08a;}finally{try{if(!_0xf8b914&&!_0xb6f0dc&&(_0x4f884a=_0x53e0e3['return']))yield _0x4f884a[_0x1da859(0xa4)](_0x53e0e3);}finally{if(_0x3056f3)throw _0x3056f3['error'];}}}return _0x4cb12f['sort']((_0x3f4e8e,_0x5d3e89)=>{const _0x345ee1=_0x1da859;return _0x5d3e89[_0x345ee1(0xb6)+_0x345ee1(0xbd)]-_0x3f4e8e['messageTim'+'estamp'];})[_0x1da859(0x7f)](-0x1494*0x1+-0x297*0x1+0x172b,(_0x5b289e=_0x40b2f6===null||_0x40b2f6===void(0x121a+0x1*0x195c+0x2b76*-0x1)?void(-0xc33+-0x1050+0x1c83):_0x40b2f6[_0x1da859(0x82)])!==null&&_0x5b289e!==void(-0x1488+-0x2145*-0x1+-0xcbd)?_0x5b289e:_0x4cb12f[_0x1da859(0x87)]);}catch(_0x307564){return[];}});}[a41_0x5a6ef2(0x96)](_0x2ca435){return __awaiter(this,void(-0x561+0x253+0x30e),void(0x2*0x21+-0x1da0+-0x6*-0x4e5),function*(){const _0x540cfd=a41_0x3477;try{if(this[_0x540cfd(0x83)][_0x540cfd(0xb8)])yield this[_0x540cfd(0x91)+'el']['deleteMany'](Object[_0x540cfd(0x7c)]({},_0x2ca435['where']));else{const {owner:_0x3ac993}=_0x2ca435['where'],_0x22c719=(0x158f*0x1+-0x8c9+0x6d*-0x1e,fs_1[_0x540cfd(0xc2)+'c'])((0xb*0x109+-0x1db7+-0x17*-0xcc,path_1[_0x540cfd(0x80)])(this['storePath'],_0x540cfd(0x92),_0x3ac993));_0x22c719[_0x540cfd(0xa6)](_0x89feaf=>{const _0x49b567=_0x540cfd,_0x3a3107=(0x1156+0x68*0x1a+-0x1*0x1be6,path_1[_0x49b567(0x80)])(this[_0x49b567(0xaf)],_0x49b567(0x92),_0x3ac993,_0x89feaf);(0x1*0xb73+0x1275+0x4fc*-0x6,fs_1[_0x49b567(0x9d)])(_0x3a3107);});}}catch(_0x577a99){console[_0x540cfd(0xc0)](_0x577a99);}});}[a41_0x5a6ef2(0xb4)](_0x28817c,_0xff5136){return __awaiter(this,void(-0x153*-0x10+-0x1d4b+0x53*0x19),void(0x1e0f+0x1866+-0x3675),function*(){const _0x5873f9=a41_0x3477;try{if(this[_0x5873f9(0x83)]['ENABLED']){const _0x550b2c={};_0x550b2c[_0x5873f9(0xb1)]=_0xff5136,yield this[_0x5873f9(0x91)+'el'][_0x5873f9(0x98)](Object[_0x5873f9(0x7c)]({},_0x28817c[_0x5873f9(0xbb)]),_0x550b2c);}else{}}catch(_0x3a724c){console['error'](_0x3a724c);}});}[a41_0x5a6ef2(0x8b)](_0x883c05,_0x8e7770=![]){return __awaiter(this,void(0x1*-0x2e8+-0xe72+0x8ad*0x2),void(-0x1484+-0x13*-0x3b+0x51*0x33),function*(){const _0x529e28=a41_0x3477;if(_0x883c05[_0x529e28(0x87)]===-0x798+0x10e8+-0x950)return;try{if(this[_0x529e28(0x83)][_0x529e28(0xb8)]&&_0x8e7770){const _0x517d8d=yield this['messageMod'+'el'][_0x529e28(0x8b)]([..._0x883c05]),_0x4b9536={};return _0x4b9536[_0x529e28(0xa8)+'t']=_0x517d8d[_0x529e28(0x87)],_0x4b9536;}if(_0x8e7770){_0x883c05['forEach'](_0x30e4c8=>this[_0x529e28(0x84)]({'path':(-0xb7f+0x2*-0x33a+0x11f3,path_1[_0x529e28(0x80)])(this[_0x529e28(0xaf)],'messages',_0x30e4c8[_0x529e28(0x8e)]),'fileName':_0x30e4c8[_0x529e28(0x8f)]['id'],'data':_0x30e4c8}));const _0x211c5b={};return _0x211c5b[_0x529e28(0xa8)+'t']=_0x883c05[_0x529e28(0x87)],_0x211c5b;}const _0x1fc67a={};return _0x1fc67a['insertCoun'+'t']=0x0,_0x1fc67a;}catch(_0x22904a){return console[_0x529e28(0xa3)](_0x529e28(0xb5),_0x22904a),_0x22904a;}finally{_0x883c05=undefined;}});}}exports['MessageRep'+a41_0x5a6ef2(0xb0)]=MessageRepository;