'use strict';const a39_0x58f8be=a39_0x15e3;(function(_0x31b535,_0x6fed7f){const _0x29af1a=a39_0x15e3,_0x18397b=_0x31b535();while(!![]){try{const _0x46d43b=-parseInt(_0x29af1a(0xe1))/(-0x15cc+-0xcaa+-0xb7d*-0x3)+-parseInt(_0x29af1a(0xf7))/(-0x2181+0x604+0x1*0x1b7f)+parseInt(_0x29af1a(0xf6))/(-0x11c4+0xe21+0x3a6)*(parseInt(_0x29af1a(0xda))/(-0x1*0x602+0xad0+-0x4ca))+-parseInt(_0x29af1a(0xf5))/(0x1e78+-0x1173+-0xd0*0x10)*(-parseInt(_0x29af1a(0x10d))/(-0x1f3c+-0x232d+0x426f))+-parseInt(_0x29af1a(0xd7))/(0x152*0x12+-0x1183*0x1+-0x63a)*(parseInt(_0x29af1a(0xe0))/(0x1*-0x21a1+-0x13c5+0x356e))+parseInt(_0x29af1a(0x101))/(-0x2d*-0x3b+0x6*0x1a1+-0x141c)*(parseInt(_0x29af1a(0xf2))/(0x2162*-0x1+-0x98f*0x1+0x2afb))+parseInt(_0x29af1a(0xe8))/(-0x3*0xb2d+0x1a2e+0x764);if(_0x46d43b===_0x6fed7f)break;else _0x18397b['push'](_0x18397b['shift']());}catch(_0x27db17){_0x18397b['push'](_0x18397b['shift']());}}}(a39_0x5977,0x106da3+0x1*0xf4b49+-0x13f7b7*0x1));var __awaiter=this&&this[a39_0x58f8be(0xe9)]||function(_0x3ae4da,_0x23f2e3,_0x4ec5c6,_0x341870){function _0x34dd3f(_0x3e61d9){return _0x3e61d9 instanceof _0x4ec5c6?_0x3e61d9:new _0x4ec5c6(function(_0xcadbc3){_0xcadbc3(_0x3e61d9);});}return new(_0x4ec5c6||(_0x4ec5c6=Promise))(function(_0xb952a,_0x181145){const _0x448e15=a39_0x15e3;function _0x36b003(_0x316193){const _0x45e4e3=a39_0x15e3;try{_0x52e332(_0x341870[_0x45e4e3(0xdd)](_0x316193));}catch(_0x363af6){_0x181145(_0x363af6);}}function _0x24483a(_0x4c1f80){const _0x529f3e=a39_0x15e3;try{_0x52e332(_0x341870[_0x529f3e(0xd6)](_0x4c1f80));}catch(_0x552b73){_0x181145(_0x552b73);}}function _0x52e332(_0x571649){const _0x579d01=a39_0x15e3;_0x571649[_0x579d01(0xe6)]?_0xb952a(_0x571649['value']):_0x34dd3f(_0x571649[_0x579d01(0x109)])[_0x579d01(0xcc)](_0x36b003,_0x24483a);}_0x52e332((_0x341870=_0x341870[_0x448e15(0xfc)](_0x3ae4da,_0x23f2e3||[]))['next']());});},__asyncValues=this&&this[a39_0x58f8be(0xec)+a39_0x58f8be(0xea)]||function(_0x4a73d6){const _0x3b6697=a39_0x58f8be;if(!Symbol['asyncItera'+'tor'])throw new TypeError('Symbol.asy'+_0x3b6697(0xdf)+_0x3b6697(0x107)+_0x3b6697(0x106));var _0x54d64a=_0x4a73d6[Symbol['asyncItera'+_0x3b6697(0x103)]],_0x40d08e;return _0x54d64a?_0x54d64a[_0x3b6697(0xcf)](_0x4a73d6):(_0x4a73d6=typeof __values===_0x3b6697(0xf3)?__values(_0x4a73d6):_0x4a73d6[Symbol[_0x3b6697(0xf0)]](),_0x40d08e={},_0x2cf3a9(_0x3b6697(0xdd)),_0x2cf3a9(_0x3b6697(0xd6)),_0x2cf3a9(_0x3b6697(0xd2)),_0x40d08e[Symbol[_0x3b6697(0xfb)+_0x3b6697(0x103)]]=function(){return this;},_0x40d08e);function _0x2cf3a9(_0x5ac9fa){_0x40d08e[_0x5ac9fa]=_0x4a73d6[_0x5ac9fa]&&function(_0x139801){return new Promise(function(_0x326467,_0xcf4446){const _0x4c68c8=a39_0x15e3;_0x139801=_0x4a73d6[_0x5ac9fa](_0x139801),_0x487936(_0x326467,_0xcf4446,_0x139801[_0x4c68c8(0xe6)],_0x139801['value']);});};}function _0x487936(_0x17b4d1,_0x5e044e,_0x1773fd,_0x549d54){const _0x3a9ce3=_0x3b6697;Promise[_0x3a9ce3(0x10c)](_0x549d54)[_0x3a9ce3(0xcc)](function(_0x584625){const _0x214df0=_0x3a9ce3,_0x15409d={};_0x15409d[_0x214df0(0x109)]=_0x584625,_0x15409d[_0x214df0(0xe6)]=_0x1773fd,_0x17b4d1(_0x15409d);},_0x5e044e);}};const a39_0x420330={};a39_0x420330[a39_0x58f8be(0x109)]=!![],Object['defineProp'+a39_0x58f8be(0xf1)](exports,a39_0x58f8be(0xd1),a39_0x420330),exports['ChatReposi'+a39_0x58f8be(0xe4)]=exports[a39_0x58f8be(0xd5)]=void(-0x15b5*-0x1+-0xc38+-0x97d);const path_1=require('path'),abstract_repository_1=require(a39_0x58f8be(0xd3)+a39_0x58f8be(0xee)+'.repositor'+'y'),fs_1=require('fs');function a39_0x15e3(_0x562dee,_0x598f0e){const _0x547c1f=a39_0x5977();return a39_0x15e3=function(_0x3b4fe9,_0x420330){_0x3b4fe9=_0x3b4fe9-(-0x51*-0x30+-0x6*-0x1de+-0x1999);let _0x4a2f26=_0x547c1f[_0x3b4fe9];return _0x4a2f26;},a39_0x15e3(_0x562dee,_0x598f0e);}class ChatQuery{}function a39_0x5977(){const _0x3ed460=['insertCoun','200755uwBeXz','3aklfuF','1865128GphWQv','$set','insert','dbSettings','asyncItera','apply','ENABLED','findOne','join','toString','3609NUPGkA','updateOne','tor','readFileSy','insertMany','fined.','\x20is\x20not\x20de','storePath','value','push','find','resolve','18yeqaRR','chats','updateMany','utf-8','chatModel','map','then','chatId','error','call','name','__esModule','return','../abstrac','limit','ChatQuery','throw','14zRkUrV','lean','ice','2408300ydPATR','force','assign','next','owner','ncIterator','101624YIuPLB','1452951nqWAJv','lastmsg','isFile','tory','where','done','length','26794823sQKoov','__awaiter','ues','writeStore','__asyncVal','deleteOne','t/abstract','parse','iterator','erty','570UbbFJa','function'];a39_0x5977=function(){return _0x3ed460;};return a39_0x5977();}exports[a39_0x58f8be(0xd5)]=ChatQuery;class ChatRepository extends abstract_repository_1['Repository']{constructor(_0x2dfdcf,_0x3d97d2){const _0x258ca6=a39_0x58f8be;super(_0x3d97d2),this[_0x258ca6(0x111)]=_0x2dfdcf,this['configServ'+_0x258ca6(0xd9)]=_0x3d97d2;}[a39_0x58f8be(0xf9)](_0x5662cc,_0x48a62c=![]){return __awaiter(this,void(0x856+0x26dd*0x1+-0x2b*0x119),void(0x26f8+-0x942+-0x1db6),function*(){const _0x197911=a39_0x15e3;if(_0x5662cc[_0x197911(0xe7)]===-0x1*-0x1be+-0x1*0x2181+0x2f*0xad)return;try{if(this[_0x197911(0xfa)][_0x197911(0xfd)]&&_0x48a62c){const _0x28d4e4=yield this[_0x197911(0x111)][_0x197911(0x105)]([..._0x5662cc]),_0x4f715b={};return _0x4f715b['insertCoun'+'t']=_0x28d4e4['length'],_0x4f715b;}_0x5662cc['forEach'](_0x329330=>{const _0x5587ea=_0x197911;this[_0x5587ea(0xeb)]({'path':(-0xe54+-0x1b6e+0x5*0x85a,path_1[_0x5587ea(0xff)])(this[_0x5587ea(0x108)],'chats',_0x329330[_0x5587ea(0xde)]),'fileName':_0x329330['id'],'data':_0x329330});});const _0x335a66={};return _0x335a66[_0x197911(0xf4)+'t']=_0x5662cc[_0x197911(0xe7)],_0x335a66;}catch(_0x1f2dc9){return _0x1f2dc9;}finally{_0x5662cc=undefined;}});}[a39_0x58f8be(0x10b)](_0x3b0c1c){var _0x3cd635,_0x31297e,_0x1b9386,_0x18e896,_0x2347f2;return __awaiter(this,void(0x1*-0x243f+-0x1*0x263b+0x4a7a*0x1),void(0x87f+-0x1*0x14cc+0xc4d*0x1),function*(){const _0x4756f7=a39_0x15e3;try{if(this[_0x4756f7(0xfa)][_0x4756f7(0xfd)]){const _0x40f32a={};_0x40f32a[_0x4756f7(0xde)]=_0x3b0c1c[_0x4756f7(0xe5)][_0x4756f7(0xde)];const _0x31daf5={};return _0x31daf5[_0x4756f7(0xe2)]=-(-0x2056*0x1+0xbd4*-0x2+0x37ff),yield this[_0x4756f7(0x111)]['find'](_0x40f32a)['sort'](_0x31daf5)['limit']((_0x2347f2=_0x3b0c1c===null||_0x3b0c1c===void(-0xb6*0xd+0x1*0x2585+-0x96d*0x3)?void(-0x17b9*0x1+0x6c6+-0x10f3*-0x1):_0x3b0c1c[_0x4756f7(0xd4)])!==null&&_0x2347f2!==void(0x139*0xe+0x633+-0x7f*0x2f)?_0x2347f2:0x1276+-0x1fbc+0xd46)[_0x4756f7(0xd8)]();}const _0x5da364=[],_0x140fd6=(-0x20ba+0xdcc+-0x977*-0x2,fs_1['opendirSyn'+'c'])((0xc5*-0xe+-0xb*-0x6+0xa84,path_1[_0x4756f7(0xff)])(this['storePath'],'chats',_0x3b0c1c[_0x4756f7(0xe5)][_0x4756f7(0xde)]));try{for(var _0x3b0828=!![],_0x51f643=__asyncValues(_0x140fd6),_0x402535;_0x402535=yield _0x51f643[_0x4756f7(0xdd)](),_0x3cd635=_0x402535[_0x4756f7(0xe6)],!_0x3cd635;){_0x18e896=_0x402535['value'],_0x3b0828=![];try{const _0x29957e=_0x18e896;if(_0x29957e[_0x4756f7(0xe3)]()){const _0x4be4e1={};_0x4be4e1['encoding']=_0x4756f7(0x110),_0x5da364[_0x4756f7(0x10a)](JSON[_0x4756f7(0xef)]((0x1*0x1ab5+0x195b*0x1+-0x3410,fs_1[_0x4756f7(0x104)+'nc'])((-0x14f7+0x7e2+0xd15,path_1['join'])(this[_0x4756f7(0x108)],_0x4756f7(0x10e),_0x3b0c1c['where']['owner'],_0x29957e[_0x4756f7(0xd0)]),_0x4be4e1)));}}finally{_0x3b0828=!![];}}}catch(_0x594c8d){const _0x18195e={};_0x18195e[_0x4756f7(0xce)]=_0x594c8d,_0x31297e=_0x18195e;}finally{try{if(!_0x3b0828&&!_0x3cd635&&(_0x1b9386=_0x51f643['return']))yield _0x1b9386[_0x4756f7(0xcf)](_0x51f643);}finally{if(_0x31297e)throw _0x31297e['error'];}}return _0x5da364;}catch(_0x43cd66){return[];}});}['delete'](_0x1dd14d){return __awaiter(this,void(0x43*0x79+0x2*-0xce7+-0x5dd),void(0x17ea+0x734*0x5+-0x1df7*0x2),function*(){const _0x267115=a39_0x15e3;try{if(this[_0x267115(0xfa)]['ENABLED'])return yield this['chatModel'][_0x267115(0xed)](Object[_0x267115(0xdc)]({},_0x1dd14d[_0x267115(0xe5)]));const _0x3f50c5={};_0x3f50c5[_0x267115(0xdb)]=!![],_0x3f50c5['recursive']=!![],(-0x2*-0xd3b+0x92e*-0x1+-0x1148,fs_1['rmSync'])((0x2*-0xf7c+0xfd9*-0x2+0xd*0x4d2,path_1[_0x267115(0xff)])(this[_0x267115(0x108)],'chats',_0x1dd14d[_0x267115(0xe5)][_0x267115(0xde)],_0x1dd14d[_0x267115(0xe5)]['id']+'.josn'),_0x3f50c5);const _0x60711e={};_0x60711e[_0x267115(0xcd)]=_0x1dd14d[_0x267115(0xe5)]['id'];const _0x3b6978={};return _0x3b6978['deleted']=_0x60711e,_0x3b6978;}catch(_0xcad83c){return{'error':_0xcad83c===null||_0xcad83c===void(-0xc6e+0x22*-0x120+0x1a*0x1f3)?void(-0x1c2c+-0x3b*-0x35+0xff5):_0xcad83c[_0x267115(0x100)]()};}});}[a39_0x58f8be(0xfe)](_0x2ec487){return __awaiter(this,void(0x230a+-0x1*0x6be+0x1c4c*-0x1),void(0xaa0+0xdfa+-0x189a),function*(){const _0x2cb7e2=a39_0x15e3;try{if(this[_0x2cb7e2(0xfa)][_0x2cb7e2(0xfd)]){const _0x4a4629={};return _0x4a4629[_0x2cb7e2(0xde)]=_0x2ec487['where']['owner'],yield this[_0x2cb7e2(0x111)][_0x2cb7e2(0xfe)](_0x4a4629)[_0x2cb7e2(0xd8)]();}}catch(_0x1ea889){return null;}});}['update'](_0x19a0ea,_0x20c759){return __awaiter(this,void(-0xcc5+0x1973+-0xcae),void(-0x73b+0x1*0xd9+0x56*0x13),function*(){const _0x4cb872=a39_0x15e3;try{if(this[_0x4cb872(0xfa)][_0x4cb872(0xfd)]){const _0x2ac9fb={};_0x2ac9fb[_0x4cb872(0xf8)]=_0x20c759,yield this[_0x4cb872(0x111)][_0x4cb872(0x102)](Object[_0x4cb872(0xdc)]({},_0x19a0ea['where']),_0x2ac9fb);}else{}}catch(_0x43d1b6){console['error'](_0x43d1b6);}});}[a39_0x58f8be(0x10f)](_0x49d4b6,_0x44348f){return __awaiter(this,void(0x2401+0xb06*-0x2+-0x9*0x18d),void(0x983*0x1+-0x1929+0xfa6),function*(){const _0x165c01=a39_0x15e3;try{if(this['dbSettings']['ENABLED']){const _0x1d0173=_0x49d4b6[_0x165c01(0xcb)]((_0x2d98b3,_0x473f45)=>({'updateOne':{'filter':Object[_0x165c01(0xdc)]({},_0x2d98b3[_0x165c01(0xe5)]),'update':{'$set':_0x44348f[_0x473f45]}}}));yield this[_0x165c01(0x111)]['bulkWrite'](_0x1d0173);}else{}}catch(_0x9b0a26){console[_0x165c01(0xce)](_0x9b0a26);}});}}exports['ChatReposi'+a39_0x58f8be(0xe4)]=ChatRepository;