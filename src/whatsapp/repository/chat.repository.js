'use strict';function a39_0x9a6d(_0x62d3ce,_0x3798ab){const _0x19acb7=a39_0x4240();return a39_0x9a6d=function(_0x2d5b4a,_0x55b848){_0x2d5b4a=_0x2d5b4a-(-0x56*0x1+0x2586*0x1+0x4*-0x91d);let _0x125c91=_0x19acb7[_0x2d5b4a];return _0x125c91;},a39_0x9a6d(_0x62d3ce,_0x3798ab);}const a39_0x5f2d78=a39_0x9a6d;(function(_0x476d75,_0x2fb8ed){const _0xf84c56=a39_0x9a6d,_0x2ca1de=_0x476d75();while(!![]){try{const _0x2a7be9=parseInt(_0xf84c56(0xfa))/(0x1328+0x5a3*0x3+-0x2410)+parseInt(_0xf84c56(0x100))/(-0x1b60+-0x150b+0x21b*0x17)*(-parseInt(_0xf84c56(0xcf))/(0x159f+0x11ab+0x7db*-0x5))+parseInt(_0xf84c56(0x101))/(0xd*0x217+0x1022+0x1*-0x2b49)*(parseInt(_0xf84c56(0xed))/(0xe2f*-0x1+-0x45f*-0x3+0x117))+parseInt(_0xf84c56(0xd6))/(0x4d*0x55+-0x8eb+-0x10a0)+-parseInt(_0xf84c56(0xd5))/(0x1*-0x272+-0xea+0x363)*(-parseInt(_0xf84c56(0xdd))/(0x8a6+0x1331*0x1+-0x1bcf))+parseInt(_0xf84c56(0xf4))/(0x121*0x1f+-0x5d3+-0x1d23*0x1)+parseInt(_0xf84c56(0xf9))/(0x2555+0x442*-0x7+-0x77d)*(-parseInt(_0xf84c56(0xe0))/(-0x1*0x13ed+0x1556+-0x15e));if(_0x2a7be9===_0x2fb8ed)break;else _0x2ca1de['push'](_0x2ca1de['shift']());}catch(_0x3431fb){_0x2ca1de['push'](_0x2ca1de['shift']());}}}(a39_0x4240,-0xf4776*0x1+-0xd6a0+0x1ec883));var __awaiter=this&&this['__awaiter']||function(_0x19a201,_0x3a07eb,_0x5c84ba,_0x2a8d1d){function _0x247cb4(_0x109a3e){return _0x109a3e instanceof _0x5c84ba?_0x109a3e:new _0x5c84ba(function(_0x50a131){_0x50a131(_0x109a3e);});}return new(_0x5c84ba||(_0x5c84ba=Promise))(function(_0xc9b7d7,_0x347e20){const _0xa9f6f3=a39_0x9a6d;function _0x34c692(_0xdf3586){try{_0x58061b(_0x2a8d1d['next'](_0xdf3586));}catch(_0x31855e){_0x347e20(_0x31855e);}}function _0xeb5df1(_0x157492){try{_0x58061b(_0x2a8d1d['throw'](_0x157492));}catch(_0x2aa64c){_0x347e20(_0x2aa64c);}}function _0x58061b(_0x2c82c1){const _0x3367ba=a39_0x9a6d;_0x2c82c1[_0x3367ba(0xec)]?_0xc9b7d7(_0x2c82c1[_0x3367ba(0xd2)]):_0x247cb4(_0x2c82c1[_0x3367ba(0xd2)])[_0x3367ba(0xe2)](_0x34c692,_0xeb5df1);}_0x58061b((_0x2a8d1d=_0x2a8d1d['apply'](_0x19a201,_0x3a07eb||[]))[_0xa9f6f3(0xdb)]());});},__asyncValues=this&&this[a39_0x5f2d78(0xc8)+a39_0x5f2d78(0xbe)]||function(_0x4ce34f){const _0x3c994f=a39_0x5f2d78;if(!Symbol[_0x3c994f(0xcd)+'tor'])throw new TypeError(_0x3c994f(0xca)+_0x3c994f(0xee)+_0x3c994f(0x108)+_0x3c994f(0xf6));var _0x343ff3=_0x4ce34f[Symbol['asyncItera'+'tor']],_0x2c8f3e;return _0x343ff3?_0x343ff3[_0x3c994f(0xc1)](_0x4ce34f):(_0x4ce34f=typeof __values===_0x3c994f(0xd4)?__values(_0x4ce34f):_0x4ce34f[Symbol[_0x3c994f(0xf0)]](),_0x2c8f3e={},_0x3a1e61(_0x3c994f(0xdb)),_0x3a1e61(_0x3c994f(0xf8)),_0x3a1e61('return'),_0x2c8f3e[Symbol[_0x3c994f(0xcd)+_0x3c994f(0xea)]]=function(){return this;},_0x2c8f3e);function _0x3a1e61(_0x43acec){_0x2c8f3e[_0x43acec]=_0x4ce34f[_0x43acec]&&function(_0x123893){return new Promise(function(_0x2dea54,_0x283a03){const _0x299949=a39_0x9a6d;_0x123893=_0x4ce34f[_0x43acec](_0x123893),_0x9a607(_0x2dea54,_0x283a03,_0x123893[_0x299949(0xec)],_0x123893[_0x299949(0xd2)]);});};}function _0x9a607(_0x307624,_0x3bd97f,_0x37e771,_0x358347){const _0x51afaa=_0x3c994f;Promise[_0x51afaa(0x107)](_0x358347)[_0x51afaa(0xe2)](function(_0x1b4a13){const _0x512c6a=_0x51afaa,_0x4156b9={};_0x4156b9[_0x512c6a(0xd2)]=_0x1b4a13,_0x4156b9[_0x512c6a(0xec)]=_0x37e771,_0x307624(_0x4156b9);},_0x3bd97f);}};const a39_0x2d5b4a={};a39_0x2d5b4a[a39_0x5f2d78(0xd2)]=!![],Object[a39_0x5f2d78(0x106)+a39_0x5f2d78(0xe1)](exports,a39_0x5f2d78(0xe8),a39_0x2d5b4a),exports[a39_0x5f2d78(0xf5)+a39_0x5f2d78(0xc9)]=exports['ChatQuery']=void(-0x22af+-0x1807+-0x9c9*-0x6);const path_1=require('path'),abstract_repository_1=require(a39_0x5f2d78(0xfb)+a39_0x5f2d78(0xbc)+a39_0x5f2d78(0xe9)+'y'),fs_1=require('fs');function a39_0x4240(){const _0x293ca9=['defineProp','resolve','\x20is\x20not\x20de','t/abstract','utf-8','ues','where','delete','call','findOne','error','$set','update','return','ice','__asyncVal','tory','Symbol.asy','join','deleteOne','asyncItera','lastmsg','4624707NqzfyK','chatModel','assign','value','configServ','function','1122254IhNgPR','9667764BEwhcF','insert','Repository','recursive','parse','next','owner','8pooVxt','opendirSyn','ENABLED','9686281SLjSDE','erty','then','encoding','writeStore','bulkWrite','length','limit','__esModule','.repositor','tor','push','done','9335tZaYzR','ncIterator','lean','iterator','rmSync','deleted','.josn','8806653GETIYN','ChatReposi','fined.','chatId','throw','30OyjbFQ','801731IUrprN','../abstrac','dbSettings','insertCoun','force','chats','2zcaTAJ','3412Ltamkf','ChatQuery','storePath','find','isFile'];a39_0x4240=function(){return _0x293ca9;};return a39_0x4240();}class ChatQuery{}exports[a39_0x5f2d78(0x102)]=ChatQuery;class ChatRepository extends abstract_repository_1[a39_0x5f2d78(0xd8)]{constructor(_0x52e9c1,_0xe1a63){const _0xbcc7d7=a39_0x5f2d78;super(_0xe1a63),this[_0xbcc7d7(0xd0)]=_0x52e9c1,this[_0xbcc7d7(0xd3)+_0xbcc7d7(0xc7)]=_0xe1a63;}[a39_0x5f2d78(0xd7)](_0x210b03,_0x19a6ef=![]){return __awaiter(this,void(-0x1*0x25eb+0x31*-0x95+-0x10*-0x427),void(0x1388*-0x1+-0x1445*-0x1+-0xbd),function*(){const _0x4cfa35=a39_0x9a6d;if(_0x210b03[_0x4cfa35(0xe6)]===-0xc1*0x27+-0x15d*0xd+0x1790*0x2)return;try{if(this[_0x4cfa35(0xfc)]['ENABLED']&&_0x19a6ef){const _0x51ec8f=yield this[_0x4cfa35(0xd0)]['insertMany']([..._0x210b03]),_0xa87512={};return _0xa87512[_0x4cfa35(0xfd)+'t']=_0x51ec8f[_0x4cfa35(0xe6)],_0xa87512;}_0x210b03['forEach'](_0x3bd822=>{const _0x1ff29a=_0x4cfa35;this[_0x1ff29a(0xe4)]({'path':(-0x5c7+-0xc6f+0x1236,path_1[_0x1ff29a(0xcb)])(this[_0x1ff29a(0x103)],_0x1ff29a(0xff),_0x3bd822['owner']),'fileName':_0x3bd822['id'],'data':_0x3bd822});});const _0x3bbdea={};return _0x3bbdea[_0x4cfa35(0xfd)+'t']=_0x210b03['length'],_0x3bbdea;}catch(_0x208c2a){return _0x208c2a;}finally{_0x210b03=undefined;}});}[a39_0x5f2d78(0x104)](_0x47fc15){var _0xde9611,_0xb88600,_0x4d9b9a,_0x5c809c,_0xdbb90f;return __awaiter(this,void(-0x199f+0x78d*0x1+-0x2*-0x909),void(0xc6a+0x1*0x103f+0x1*-0x1ca9),function*(){const _0x288dd5=a39_0x9a6d;try{if(this[_0x288dd5(0xfc)]['ENABLED']){const _0x48cb24={};_0x48cb24['owner']=_0x47fc15['where'][_0x288dd5(0xdc)];const _0x5475ee={};return _0x5475ee[_0x288dd5(0xce)]=-(-0x1efe+-0x1*0x2b5+0x21b4),yield this[_0x288dd5(0xd0)]['find'](_0x48cb24)['sort'](_0x5475ee)[_0x288dd5(0xe7)]((_0xdbb90f=_0x47fc15===null||_0x47fc15===void(0xb0c+-0x296*0x2+-0x5e0)?void(-0x1*0x142a+0xfc4*-0x2+0x33b2):_0x47fc15['limit'])!==null&&_0xdbb90f!==void(0x17*0x31+0x1958+-0x1dbf)?_0xdbb90f:0x1*0x15d7+0x10*-0x256+-0xf89*-0x1)[_0x288dd5(0xef)]();}const _0x12a603=[],_0x3e90e3=(-0x127d+-0xb*0x133+0x2*0xfd7,fs_1[_0x288dd5(0xde)+'c'])((-0x1c7d+-0x109*-0xd+0xf08*0x1,path_1[_0x288dd5(0xcb)])(this['storePath'],'chats',_0x47fc15[_0x288dd5(0xbf)][_0x288dd5(0xdc)]));try{for(var _0x448d10=!![],_0x3c5aab=__asyncValues(_0x3e90e3),_0x46c445;_0x46c445=yield _0x3c5aab[_0x288dd5(0xdb)](),_0xde9611=_0x46c445['done'],!_0xde9611;){_0x5c809c=_0x46c445[_0x288dd5(0xd2)],_0x448d10=![];try{const _0x3522aa=_0x5c809c;if(_0x3522aa[_0x288dd5(0x105)]()){const _0x1e7445={};_0x1e7445[_0x288dd5(0xe3)]=_0x288dd5(0xbd),_0x12a603[_0x288dd5(0xeb)](JSON[_0x288dd5(0xda)]((-0x3*0xcce+-0x2584+0x1*0x4bee,fs_1['readFileSy'+'nc'])((0x30c*-0x6+-0x3f1*0x6+0x29ee,path_1[_0x288dd5(0xcb)])(this[_0x288dd5(0x103)],_0x288dd5(0xff),_0x47fc15[_0x288dd5(0xbf)][_0x288dd5(0xdc)],_0x3522aa['name']),_0x1e7445)));}}finally{_0x448d10=!![];}}}catch(_0x4cb498){const _0x3cbe56={};_0x3cbe56[_0x288dd5(0xc3)]=_0x4cb498,_0xb88600=_0x3cbe56;}finally{try{if(!_0x448d10&&!_0xde9611&&(_0x4d9b9a=_0x3c5aab[_0x288dd5(0xc6)]))yield _0x4d9b9a[_0x288dd5(0xc1)](_0x3c5aab);}finally{if(_0xb88600)throw _0xb88600[_0x288dd5(0xc3)];}}return _0x12a603;}catch(_0x5ede3d){return[];}});}[a39_0x5f2d78(0xc0)](_0x569291){return __awaiter(this,void(-0x55*0xd+-0x1b*-0xe7+-0x140c),void(-0x1a9e+-0x112e+-0x2*-0x15e6),function*(){const _0x41cce1=a39_0x9a6d;try{if(this['dbSettings'][_0x41cce1(0xdf)])return yield this[_0x41cce1(0xd0)][_0x41cce1(0xcc)](Object[_0x41cce1(0xd1)]({},_0x569291[_0x41cce1(0xbf)]));const _0x3a3617={};_0x3a3617[_0x41cce1(0xfe)]=!![],_0x3a3617[_0x41cce1(0xd9)]=!![],(0x6d+-0x26ff+0x2692,fs_1[_0x41cce1(0xf1)])((0xb77+-0x11cd+0x656,path_1['join'])(this[_0x41cce1(0x103)],_0x41cce1(0xff),_0x569291['where'][_0x41cce1(0xdc)],_0x569291['where']['id']+_0x41cce1(0xf3)),_0x3a3617);const _0x5724db={};_0x5724db[_0x41cce1(0xf7)]=_0x569291[_0x41cce1(0xbf)]['id'];const _0x26b6cc={};return _0x26b6cc[_0x41cce1(0xf2)]=_0x5724db,_0x26b6cc;}catch(_0x1243bf){return{'error':_0x1243bf===null||_0x1243bf===void(-0x181c+0x1*0x14d2+-0x1a5*-0x2)?void(0x2b*-0x31+-0x1bed+0x2428):_0x1243bf['toString']()};}});}[a39_0x5f2d78(0xc2)](_0x116a47){return __awaiter(this,void(0xc+-0x4*0x83+0x200),void(-0x505+0x4f*-0x34+0x1511),function*(){const _0x5aa66d=a39_0x9a6d;try{if(this['dbSettings'][_0x5aa66d(0xdf)]){const _0x3e7cd8={};return _0x3e7cd8[_0x5aa66d(0xdc)]=_0x116a47[_0x5aa66d(0xbf)]['owner'],yield this['chatModel'][_0x5aa66d(0xc2)](_0x3e7cd8)[_0x5aa66d(0xef)]();}}catch(_0x3c8448){return null;}});}[a39_0x5f2d78(0xc5)](_0x3280a0,_0x2f7afe){return __awaiter(this,void(-0x16ec+-0x5ee*0x3+-0x36*-0xc1),void(-0x2*-0xad5+0x977+0xd*-0x265),function*(){const _0x11405d=a39_0x9a6d;try{if(this[_0x11405d(0xfc)][_0x11405d(0xdf)]){const _0x43f48e={};_0x43f48e[_0x11405d(0xc4)]=_0x2f7afe,yield this[_0x11405d(0xd0)]['updateOne'](Object[_0x11405d(0xd1)]({},_0x3280a0[_0x11405d(0xbf)]),_0x43f48e);}else{}}catch(_0x2d06c2){console[_0x11405d(0xc3)](_0x2d06c2);}});}['updateMany'](_0x3ed78c,_0x3e0d4f){return __awaiter(this,void(0x76b+0x3*-0x60d+-0x2af*-0x4),void(-0xfba+0x1c6a+-0xcb0),function*(){const _0x4d7c07=a39_0x9a6d;try{if(this[_0x4d7c07(0xfc)][_0x4d7c07(0xdf)]){const _0x33e418=_0x3ed78c['map']((_0x6cfe80,_0x3a221d)=>({'updateOne':{'filter':Object[_0x4d7c07(0xd1)]({},_0x6cfe80[_0x4d7c07(0xbf)]),'update':{'$set':_0x3e0d4f[_0x3a221d]}}}));yield this[_0x4d7c07(0xd0)][_0x4d7c07(0xe5)](_0x33e418);}else{}}catch(_0x51a73a){console[_0x4d7c07(0xc3)](_0x51a73a);}});}}exports[a39_0x5f2d78(0xf5)+a39_0x5f2d78(0xc9)]=ChatRepository;