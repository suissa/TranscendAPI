'use strict';function a39_0xec99(){const _0x2ccaa8=['length','lastmsg','bulkWrite','return','ice','lean','asyncItera','deleteOne','insert','toString','ncIterator','chatId','44650170hJBqKv','.repositor','where','insertMany','push','parse','then','ues','limit','delete','Repository','__esModule','1527165bLXRFY','6204IhhLik','tor','dbSettings','chatModel','recursive','isFile','readFileSy','ChatReposi','update','findOne','function','insertCoun','call','forEach','4txoxll','ChatQuery','error','128SzZdTV','next','1788170yNwHtK','assign','10693728scnopM','throw','name','tory','31728znEuAY','opendirSyn','\x20is\x20not\x20de','4298GodhPT','deleted','../abstrac','configServ','find','join','5180375nVtcXW','storePath','value','owner','writeStore','utf-8','ENABLED','iterator','sort','defineProp','done','chats'];a39_0xec99=function(){return _0x2ccaa8;};return a39_0xec99();}const a39_0x52ad04=a39_0x211b;(function(_0x4884d9,_0x3e3e6a){const _0x5876c6=a39_0x211b,_0x520504=_0x4884d9();while(!![]){try{const _0x2694e1=-parseInt(_0x5876c6(0xed))/(-0x2272+0x71+0x2202)+parseInt(_0x5876c6(0xeb))/(-0x9ca+0x8f9+0xd3*0x1)*(-parseInt(_0x5876c6(0xf3))/(0x26*0x3c+0x1*0xbfd+-0x14e2))+parseInt(_0x5876c6(0x12f))/(-0xc09*-0x3+-0xf6f+0x52a*-0x4)*(parseInt(_0x5876c6(0xfc))/(-0x196e+-0xd6f*-0x1+-0xc04*-0x1))+-parseInt(_0x5876c6(0x121))/(-0x192a+-0xfb*0x2+0x1b26)*(parseInt(_0x5876c6(0xf6))/(0x1544+-0x74*0x7+-0x1211))+-parseInt(_0x5876c6(0xef))/(0xf2*0xb+0xeef*-0x1+0x491)+-parseInt(_0x5876c6(0x120))/(-0x1120+0x1c74+-0xb4b)+parseInt(_0x5876c6(0x114))/(0xc1+-0x1bbf+0x1b08);if(_0x2694e1===_0x3e3e6a)break;else _0x520504['push'](_0x520504['shift']());}catch(_0x3a139f){_0x520504['push'](_0x520504['shift']());}}}(a39_0xec99,0x15b0fc+0x55a31*-0x1+-0x2af8e));var __awaiter=this&&this['__awaiter']||function(_0x540d5d,_0x488a8a,_0x58b82f,_0x5248ef){function _0x4aefa6(_0x507712){return _0x507712 instanceof _0x58b82f?_0x507712:new _0x58b82f(function(_0x4ff8a3){_0x4ff8a3(_0x507712);});}return new(_0x58b82f||(_0x58b82f=Promise))(function(_0x2e0bc0,_0x5b115a){const _0xe86a0d=a39_0x211b;function _0x4b63c0(_0x508c54){const _0x2eba93=a39_0x211b;try{_0x2171ec(_0x5248ef[_0x2eba93(0xec)](_0x508c54));}catch(_0x42e438){_0x5b115a(_0x42e438);}}function _0x46119e(_0x1db578){const _0x274b44=a39_0x211b;try{_0x2171ec(_0x5248ef[_0x274b44(0xf0)](_0x1db578));}catch(_0xeef8cc){_0x5b115a(_0xeef8cc);}}function _0x2171ec(_0x1c8bfb){const _0x1615cb=a39_0x211b;_0x1c8bfb[_0x1615cb(0x106)]?_0x2e0bc0(_0x1c8bfb[_0x1615cb(0xfe)]):_0x4aefa6(_0x1c8bfb[_0x1615cb(0xfe)])[_0x1615cb(0x11a)](_0x4b63c0,_0x46119e);}_0x2171ec((_0x5248ef=_0x5248ef['apply'](_0x540d5d,_0x488a8a||[]))[_0xe86a0d(0xec)]());});},__asyncValues=this&&this['__asyncVal'+a39_0x52ad04(0x11b)]||function(_0x72349f){const _0x45f8a5=a39_0x52ad04;if(!Symbol['asyncItera'+_0x45f8a5(0x122)])throw new TypeError('Symbol.asy'+_0x45f8a5(0x112)+_0x45f8a5(0xf5)+'fined.');var _0x2866ed=_0x72349f[Symbol[_0x45f8a5(0x10e)+_0x45f8a5(0x122)]],_0x1de8b3;return _0x2866ed?_0x2866ed[_0x45f8a5(0x12d)](_0x72349f):(_0x72349f=typeof __values===_0x45f8a5(0x12b)?__values(_0x72349f):_0x72349f[Symbol[_0x45f8a5(0x103)]](),_0x1de8b3={},_0x133b73(_0x45f8a5(0xec)),_0x133b73(_0x45f8a5(0xf0)),_0x133b73(_0x45f8a5(0x10b)),_0x1de8b3[Symbol[_0x45f8a5(0x10e)+'tor']]=function(){return this;},_0x1de8b3);function _0x133b73(_0x10bb23){_0x1de8b3[_0x10bb23]=_0x72349f[_0x10bb23]&&function(_0x3dccff){return new Promise(function(_0x442c56,_0x5371e0){const _0x170906=a39_0x211b;_0x3dccff=_0x72349f[_0x10bb23](_0x3dccff),_0x2eee95(_0x442c56,_0x5371e0,_0x3dccff[_0x170906(0x106)],_0x3dccff['value']);});};}function _0x2eee95(_0x4f92ac,_0x418141,_0x4803ed,_0x58170a){Promise['resolve'](_0x58170a)['then'](function(_0x540a38){const _0x18bd5b=a39_0x211b,_0x31b1c1={};_0x31b1c1[_0x18bd5b(0xfe)]=_0x540a38,_0x31b1c1[_0x18bd5b(0x106)]=_0x4803ed,_0x4f92ac(_0x31b1c1);},_0x418141);}};const a39_0x4d97da={};function a39_0x211b(_0x4d57e6,_0x451429){const _0x41e806=a39_0xec99();return a39_0x211b=function(_0x2a5e0d,_0x1004a3){_0x2a5e0d=_0x2a5e0d-(-0x104b+-0x16cb+0x2800);let _0x5464e6=_0x41e806[_0x2a5e0d];return _0x5464e6;},a39_0x211b(_0x4d57e6,_0x451429);}a39_0x4d97da[a39_0x52ad04(0xfe)]=!![],Object[a39_0x52ad04(0x105)+'erty'](exports,a39_0x52ad04(0x11f),a39_0x4d97da),exports[a39_0x52ad04(0x128)+a39_0x52ad04(0xf2)]=exports[a39_0x52ad04(0x130)]=void(0x2381*0x1+0x1392+-0x17*0x265);const path_1=require('path'),abstract_repository_1=require(a39_0x52ad04(0xf8)+'t/abstract'+a39_0x52ad04(0x115)+'y'),fs_1=require('fs');class ChatQuery{}exports['ChatQuery']=ChatQuery;class ChatRepository extends abstract_repository_1[a39_0x52ad04(0x11e)]{constructor(_0x593c9c,_0x516504){const _0xedced6=a39_0x52ad04;super(_0x516504),this[_0xedced6(0x124)]=_0x593c9c,this[_0xedced6(0xf9)+_0xedced6(0x10c)]=_0x516504;}[a39_0x52ad04(0x110)](_0x2c1584,_0x248ee2=![]){return __awaiter(this,void(-0x3*0x565+0x152+0xedd),void(-0xf93*-0x1+-0x6b*-0x30+0xbe1*-0x3),function*(){const _0x37cbee=a39_0x211b;if(_0x2c1584[_0x37cbee(0x108)]===0x17d1+-0x5*0x327+-0x80e)return;try{if(this['dbSettings'][_0x37cbee(0x102)]&&_0x248ee2){const _0x93f83f=yield this[_0x37cbee(0x124)][_0x37cbee(0x117)]([..._0x2c1584]),_0x2a67f2={};return _0x2a67f2[_0x37cbee(0x12c)+'t']=_0x93f83f[_0x37cbee(0x108)],_0x2a67f2;}_0x2c1584[_0x37cbee(0x12e)](_0x5bceb3=>{const _0x457365=_0x37cbee;this[_0x457365(0x100)]({'path':(-0xb*-0x1b1+0x26db+-0x3976,path_1['join'])(this['storePath'],_0x457365(0x107),_0x5bceb3[_0x457365(0xff)]),'fileName':_0x5bceb3['id'],'data':_0x5bceb3});});const _0x819e46={};return _0x819e46[_0x37cbee(0x12c)+'t']=_0x2c1584[_0x37cbee(0x108)],_0x819e46;}catch(_0x56c0a6){return _0x56c0a6;}finally{_0x2c1584=undefined;}});}[a39_0x52ad04(0xfa)](_0x5cba3f){var _0x23d415,_0x18d8f7,_0x258879,_0x12b55f,_0x21905f;return __awaiter(this,void(0x1*-0x1afb+0x1f09+-0x15a*0x3),void(-0x1190+0x373*-0x2+0x1*0x1876),function*(){const _0x1eb281=a39_0x211b;try{if(this[_0x1eb281(0x123)][_0x1eb281(0x102)]){const _0x5e46fd={};_0x5e46fd['owner']=_0x5cba3f[_0x1eb281(0x116)][_0x1eb281(0xff)];const _0x426966={};return _0x426966[_0x1eb281(0x109)]=-(-0x188+0x3a9*-0x1+0x532),yield this[_0x1eb281(0x124)][_0x1eb281(0xfa)](_0x5e46fd)[_0x1eb281(0x104)](_0x426966)['limit']((_0x21905f=_0x5cba3f===null||_0x5cba3f===void(0x1d88+-0x1eba+-0x22*-0x9)?void(0x128f+0x86d+-0x1afc):_0x5cba3f[_0x1eb281(0x11c)])!==null&&_0x21905f!==void(0x2511*-0x1+0x1cb4+0x85d)?_0x21905f:0x1010+-0x1*0x7a8+-0x868)[_0x1eb281(0x10d)]();}const _0x34e39e=[],_0x172c4a=(-0x1205+-0x35*-0x27+0x1*0x9f2,fs_1[_0x1eb281(0xf4)+'c'])((0xc07*-0x1+0x2*0x942+-0x67d,path_1[_0x1eb281(0xfb)])(this['storePath'],_0x1eb281(0x107),_0x5cba3f[_0x1eb281(0x116)]['owner']));try{for(var _0x17124e=!![],_0x183855=__asyncValues(_0x172c4a),_0x306e83;_0x306e83=yield _0x183855[_0x1eb281(0xec)](),_0x23d415=_0x306e83[_0x1eb281(0x106)],!_0x23d415;){_0x12b55f=_0x306e83[_0x1eb281(0xfe)],_0x17124e=![];try{const _0x20f99a=_0x12b55f;if(_0x20f99a[_0x1eb281(0x126)]()){const _0x562b23={};_0x562b23['encoding']=_0x1eb281(0x101),_0x34e39e[_0x1eb281(0x118)](JSON[_0x1eb281(0x119)]((0x95b*0x3+0x7*-0x4fd+-0x36d*-0x2,fs_1[_0x1eb281(0x127)+'nc'])((0xefb+-0x21fe+-0x1*-0x1303,path_1[_0x1eb281(0xfb)])(this[_0x1eb281(0xfd)],_0x1eb281(0x107),_0x5cba3f['where'][_0x1eb281(0xff)],_0x20f99a[_0x1eb281(0xf1)]),_0x562b23)));}}finally{_0x17124e=!![];}}}catch(_0x4882c6){const _0x10be4a={};_0x10be4a[_0x1eb281(0xea)]=_0x4882c6,_0x18d8f7=_0x10be4a;}finally{try{if(!_0x17124e&&!_0x23d415&&(_0x258879=_0x183855[_0x1eb281(0x10b)]))yield _0x258879[_0x1eb281(0x12d)](_0x183855);}finally{if(_0x18d8f7)throw _0x18d8f7[_0x1eb281(0xea)];}}return _0x34e39e;}catch(_0x2466d4){return[];}});}[a39_0x52ad04(0x11d)](_0xe2beb0){return __awaiter(this,void(-0x39*-0x4c+0x10f2+-0x6c6*0x5),void(0x1583+-0x2b*0x10+-0x12d3*0x1),function*(){const _0x4ac024=a39_0x211b;try{if(this['dbSettings'][_0x4ac024(0x102)])return yield this[_0x4ac024(0x124)][_0x4ac024(0x10f)](Object[_0x4ac024(0xee)]({},_0xe2beb0[_0x4ac024(0x116)]));const _0x5ce5f8={};_0x5ce5f8['force']=!![],_0x5ce5f8[_0x4ac024(0x125)]=!![],(-0xc22+0x6*0x2af+-0x8*0x7f,fs_1['rmSync'])((-0x7b*0xc+-0x1575+0x1b39,path_1[_0x4ac024(0xfb)])(this[_0x4ac024(0xfd)],'chats',_0xe2beb0[_0x4ac024(0x116)][_0x4ac024(0xff)],_0xe2beb0[_0x4ac024(0x116)]['id']+'.josn'),_0x5ce5f8);const _0x13aa07={};_0x13aa07[_0x4ac024(0x113)]=_0xe2beb0['where']['id'];const _0x267182={};return _0x267182[_0x4ac024(0xf7)]=_0x13aa07,_0x267182;}catch(_0xba516f){return{'error':_0xba516f===null||_0xba516f===void(0xd*-0x1f7+0xd43+0xc48)?void(0x1*0x1ec7+0x99*0x30+-0xd*0x493):_0xba516f[_0x4ac024(0x111)]()};}});}['findOne'](_0x490160){return __awaiter(this,void(-0x1028+-0x1*-0x2330+-0x1308),void(-0x1f98+0x5df+0x1*0x19b9),function*(){const _0x4be487=a39_0x211b;try{if(this[_0x4be487(0x123)][_0x4be487(0x102)]){const _0x540050={};return _0x540050[_0x4be487(0xff)]=_0x490160[_0x4be487(0x116)][_0x4be487(0xff)],yield this['chatModel'][_0x4be487(0x12a)](_0x540050)['lean']();}}catch(_0x3b01ed){return null;}});}[a39_0x52ad04(0x129)](_0x5b84da,_0x373ca1){return __awaiter(this,void(0x2*0xd55+-0xf6*-0x1d+0x3688*-0x1),void(0x1006+-0x370+-0xc96),function*(){const _0x58b192=a39_0x211b;try{if(this[_0x58b192(0x123)][_0x58b192(0x102)]){const _0x13431e={};_0x13431e['$set']=_0x373ca1,yield this[_0x58b192(0x124)]['updateOne'](Object['assign']({},_0x5b84da[_0x58b192(0x116)]),_0x13431e);}else{}}catch(_0xeed64c){console['error'](_0xeed64c);}});}['updateMany'](_0x250c69,_0x35b281){return __awaiter(this,void(0x1*-0x545+0x17fe+-0x1*0x12b9),void(-0x22b0+-0xd64+0x3014),function*(){const _0x5b4f9d=a39_0x211b;try{if(this[_0x5b4f9d(0x123)]['ENABLED']){const _0x35e291=_0x250c69['map']((_0x851619,_0x55b86e)=>({'updateOne':{'filter':Object[_0x5b4f9d(0xee)]({},_0x851619['where']),'update':{'$set':_0x35b281[_0x55b86e]}}}));yield this[_0x5b4f9d(0x124)][_0x5b4f9d(0x10a)](_0x35e291);}else{}}catch(_0x569d4f){console[_0x5b4f9d(0xea)](_0x569d4f);}});}}exports[a39_0x52ad04(0x128)+a39_0x52ad04(0xf2)]=ChatRepository;